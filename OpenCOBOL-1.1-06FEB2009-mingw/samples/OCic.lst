OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
     1        IDENTIFICATION DIVISION.
     2        PROGRAM-ID. OCic.
     3       *****************************************************************
     4       ** This program provides a Textual User Interface (TUI) to the **
     5       ** process of compiling and (optionally) executing an OpenCOBOL**
     6       ** program.                                                    **
     7       **                                                             **
     8       ** This programs execution syntax is as follows:               **
     9       **                                                             **
    10       ** ocic <program-path-and-filename> [ <switch>... ]            **
    11       **                                                             **
    12       ** Once executed, a display screen will be presented showing   **
    13       ** the compilation options that will be used.  The user will   **
    14       ** have the opportunity to change options, specify new ones    **
    15       ** and specify any program execution arguments to be used if   **
    16       ** you select the "Execute" option.  When you press the Enter  **
    17       ** key the program will be compiled.                           **
    18       **                                                             **
    19       ** The SCREEN SECTION contains an image of the screen.         **
    20       **                                                             **
    21       ** The "010-Parse-Args" section in the PROCEDURE DIVISION has  **
    22       ** documentation on switches and their function.               **
    23       *****************************************************************
    24       **                                                             **
    25       ** AUTHOR:       GARY L. CUTLER                                **
    26       **               CutlerGL@gmail.com                            **
    27       **               Copyright (C) 2009-2010, Gary L. Cutler, GPL  **
    28       **                                                             **
    29       ** DATE-WRITTEN: June 14, 2009                                 **
    30       **                                                             **
    31       *****************************************************************
    32       ** Note: Depending on which extended DISPLAY handler you're    **
    33       **       using (PDCurses, Curses, ...), you may need to un-    **
    34       **       comment any source lines tagged with "SCROLL" in cols **
    35       **       1-6 in order to have error messages scroll properly   **
    36       **       in the OCic shell window.                             **
    37       *****************************************************************
    38       **  DATE  CHANGE DESCRIPTION                                   **
    39       ** ====== ==================================================== **
    40       ** GC0609 Don't display compiler messages file if compilation  **
    41       **        Is successful.  Also don't display messages if the   **
    42       **        output file is busy (just put a message on the       **
    43       **        screen, leave the OC screen up & let the user fix    **
    44       **        the problem & resubmit.                              **
    45       ** GC0709 When 'EXECUTE' is selected, a 'FILE BUSY' error will **
    46       **        still cause the (old) executable to be launched.     **
    47       **        Also, the 'EXTRA SWITCHES' field is being ignored.   **
    48       **        Changed the title bar to lowlighted reverse video &  **
    49       **        the message area to highlighted reverse-video.       **
    50       ** GC0809 Add a SPACE in from of command-line args when        **
    51       **        executing users program.  Add a SPACE after the      **
    52       **        -ftraceall switch when building cobc command.        **
    53       ** GC0909 Convert to work on Cygwin/Linux as well as MinGW     **
    54       ** GC0310 Virtualized the key codes for S-F1 thru S-F7 as they **
    55       **        differ depending upon whether PDCurses or NCurses is **
    56       **        being used.                                          **

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
    57       ** GC0410 Introduced the cross-reference and source listing    **
    58       **        features.  Also fixed a bug in @EXTRA switch proces- **
    59       **        sing where garbage will result if more than the      **
    60       **        @EXTRA switch is specified.                          **
    61       ** GC1010 Corrected several problems reported by Vince Coen:   **
    62       **        1) Listing/Xref wouldn't work if "-I" additional     **
    63       **           cobc switch specified.                            **
    64       **        2) Programs coded with lowercase reserved words did  **
    65       **           not get parsed properly when generating listing   **
    66       **           and/or xref reports.                              **
    67       **        3) Reliance on a TEMP environment variable caused    **
    68       **           non-recoverable errors when generating listing    **
    69       **           and/or xref reports in a session that lacks a     **
    70       **           TEMP variable.                                    **
    71       **        As a result of this change, OCic no longer runs a    **
    72       **        second 'cobc' when generating listing and/or xref    **
    73       **        reports.  A "-save-temps" (without "=dir") specified **
    74       **        in the @EXTRA options field will be ignored.  A      **
    75       **        "-save-temps=dir" specified in the @EXTRA options    **
    76       **        field will negate both the @XREF and @SOURCE opts,   **
    77       **        if specified.                                        **
    78       *****************************************************************
    79        ENVIRONMENT DIVISION.
    80        CONFIGURATION SECTION.
    81        REPOSITORY.
    82            FUNCTION ALL INTRINSIC.
    83        INPUT-OUTPUT SECTION.
    84        FILE-CONTROL.
    85            SELECT Bat-File             ASSIGN TO Bat-File-Name
    86                                        ORGANIZATION IS LINE SEQUENTIAL.
    87
    88 GC1010     SELECT Cobc-Output          ASSIGN TO 'OC-Messages.TXT'
    89                                        ORGANIZATION IS LINE SEQUENTIAL.
    90
    91            SELECT Source-Code          ASSIGN TO File-Name
    92                                        ORGANIZATION IS LINE SEQUENTIAL
    93                                        FILE STATUS IS FSM-Status.
    94        DATA DIVISION.
    95        FILE SECTION.
    96        FD  Bat-File.
    97        01  Bat-File-Rec                PIC X(2048).
    98
    99        FD  Cobc-Output.
   100        01  Cobc-Output-Rec             PIC X(256).
   101
   102        FD  Source-Code.
   103        01  Source-Code-Record          PIC X(80).
   104
   105        WORKING-STORAGE SECTION.
   106        COPY screenio.
       78 COB-COLOR-BLACK VALUE 0.
       78 COB-COLOR-BLUE VALUE 1.
       78 COB-COLOR-GREEN VALUE 2.
       78 COB-COLOR-CYAN VALUE 3.
       78 COB-COLOR-RED VALUE 4.
       78 COB-COLOR-MAGENTA VALUE 5.

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
       78 COB-COLOR-YELLOW VALUE 6.
       78 COB-COLOR-WHITE VALUE 7.
       78 COB-SCR-OK VALUE 0.
       78 COB-SCR-F1 VALUE 1001.
       78 COB-SCR-F2 VALUE 1002.
       78 COB-SCR-F3 VALUE 1003.
       78 COB-SCR-F4 VALUE 1004.
       78 COB-SCR-F5 VALUE 1005.
       78 COB-SCR-F6 VALUE 1006.
       78 COB-SCR-F7 VALUE 1007.
       78 COB-SCR-F8 VALUE 1008.
       78 COB-SCR-F9 VALUE 1009.
       78 COB-SCR-F10 VALUE 1010.
       78 COB-SCR-F11 VALUE 1011.
       78 COB-SCR-F12 VALUE 1012.
       78 COB-SCR-F13 VALUE 1013.
       78 COB-SCR-F14 VALUE 1014.
       78 COB-SCR-F15 VALUE 1015.
       78 COB-SCR-F16 VALUE 1016.
       78 COB-SCR-F17 VALUE 1017.
       78 COB-SCR-F18 VALUE 1018.
       78 COB-SCR-F19 VALUE 1019.
       78 COB-SCR-F20 VALUE 1020.
       78 COB-SCR-F21 VALUE 1021.
       78 COB-SCR-F22 VALUE 1022.
       78 COB-SCR-F23 VALUE 1023.
       78 COB-SCR-F24 VALUE 1024.
       78 COB-SCR-F25 VALUE 1025.
       78 COB-SCR-F26 VALUE 1026.
       78 COB-SCR-F27 VALUE 1027.
       78 COB-SCR-F28 VALUE 1028.
       78 COB-SCR-F29 VALUE 1029.
       78 COB-SCR-F30 VALUE 1030.
       78 COB-SCR-F31 VALUE 1031.
       78 COB-SCR-F32 VALUE 1032.
       78 COB-SCR-F33 VALUE 1033.
       78 COB-SCR-F34 VALUE 1034.
       78 COB-SCR-F35 VALUE 1035.
       78 COB-SCR-F36 VALUE 1036.
       78 COB-SCR-F37 VALUE 1037.
       78 COB-SCR-F38 VALUE 1038.
       78 COB-SCR-F39 VALUE 1039.
       78 COB-SCR-F40 VALUE 1040.
       78 COB-SCR-F41 VALUE 1041.
       78 COB-SCR-F42 VALUE 1042.
       78 COB-SCR-F43 VALUE 1043.
       78 COB-SCR-F44 VALUE 1044.
       78 COB-SCR-F45 VALUE 1045.
       78 COB-SCR-F46 VALUE 1046.
       78 COB-SCR-F47 VALUE 1047.
       78 COB-SCR-F48 VALUE 1048.
       78 COB-SCR-F49 VALUE 1049.
       78 COB-SCR-F50 VALUE 1050.
       78 COB-SCR-F51 VALUE 1051.
       78 COB-SCR-F52 VALUE 1052.
       78 COB-SCR-F53 VALUE 1053.

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
       78 COB-SCR-F54 VALUE 1054.
       78 COB-SCR-F55 VALUE 1055.
       78 COB-SCR-F56 VALUE 1056.
       78 COB-SCR-F57 VALUE 1057.
       78 COB-SCR-F58 VALUE 1058.
       78 COB-SCR-F59 VALUE 1059.
       78 COB-SCR-F60 VALUE 1060.
       78 COB-SCR-F61 VALUE 1061.
       78 COB-SCR-F62 VALUE 1062.
       78 COB-SCR-F63 VALUE 1063.
       78 COB-SCR-F64 VALUE 1064.
       78 COB-SCR-PAGE_UP VALUE 2001.
       78 COB-SCR-PAGE_DOWN VALUE 2002.
       78 COB-SCR-KEY-UP VALUE 2003.
       78 COB-SCR-KEY-DOWN VALUE 2004.
       78 COB-SCR-ESC VALUE 2005.
       78 COB-SCR-PRINT VALUE 2006.
       78 COB-SCR-NO-FIELD VALUE 8000.
       78 COB-SCR-FATAL VALUE 9000.
   107
   108        01  Bat-File-Name               PIC X(256).
   109
   110 GC0909 01  Cmd                         PIC X(512).
   111
   112        01  Cobc-Cmd                    PIC X(256).
   113
   114        01  Command-Line-Args           PIC X(256).
   115
   116        01  Config-File                 PIC X(12).
   117
   118 GC0310 01  Config-Keys.
   119 GC0310     05 CK-S-F1                  PIC 9(4).
   120 GC0310     05 CK-S-F2                  PIC 9(4).
   121 GC0310     05 CK-S-F3                  PIC 9(4).
   122 GC0310     05 CK-S-F4                  PIC 9(4).
   123 GC0310     05 CK-S-F5                  PIC 9(4).
   124 GC0310     05 CK-S-F6                  PIC 9(4).
   125 GC0310     05 CK-S-F7                  PIC 9(4).
   126
   127 GC0909 01  Dir-Char                    PIC X(1).
   128
   129        01  Dummy                       PIC X(1).
   130
   131        01  File-Name.
   132            05 FN-Char                  OCCURS 256 TIMES PIC X(1).
   133
   134        01  File-Status-Message.
   135            05 FILLER                   PIC X(13) VALUE 'Status Code: '.
   136            05 FSM-Status               PIC 9(2).
   137            05 FILLER                   PIC X(11) VALUE ', Meaning: '.
   138            05 FSM-Msg                  PIC X(25).
   139
   140        01  Flags.
   141            05 F-Compilation-Succeeded  PIC X(1).
   142               88 88-Compile-OK         VALUE 'Y'.
   143 GC0909        88 88-Compile-OK-Warn    VALUE 'W'.

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
   144               88 88-Compile-Failed     VALUE 'N'.
   145 GC0609     05 F-Complete               PIC X(1).
   146 GC0609        88 88-Complete           VALUE 'Y'.
   147 GC0609        88 88-Not-Complete       VALUE 'N'.
   148 GC0809     05 F-IDENT-DIVISION         PIC X(1).
   149 GC0809        88 88-1st-Prog-Complete  VALUE 'Y'.
   150 GC0809        88 88-More-To-1st-Prog   VALUE 'N'.
   151            05 F-LINKAGE-SECTION        PIC X(1).
   152               88 88-Compile-As-Subpgm  VALUE 'Y'.
   153               88 88-Compile-As-Mainpgm VALUE 'N'.
   154            05 F-No-Switch-Changes      PIC X(1).
   155               88 88-No-Switch-Changes  VALUE 'Y'.
   156               88 88-Switch-Changes     VALUE 'N'.
   157 GC0709     05 F-Output-File-Busy       PIC X(1).
   158 GC0709        88 88-Output-File-Busy   VALUE 'Y'.
   159 GC0709        88 88-Output-File-Avail  VALUE 'N'.
   160 GC0809     05 F-Source-Record-Type     PIC X(1).
   161 GC0809        88 88-Source-Rec-Linkage VALUE 'L'.
   162 GC0809        88 88-Source-Rec-Ident   VALUE 'I'.
   163 GC0809        88 88-Source-Rec-IgnoCOB-COLOR-RED VALUE ' '.
   164            05 F-Switch-Error           PIC X(1).
   165               88 88-Switch-Is-Bad      VALUE 'Y'.
   166               88 88-Switch-Is-Good     VALUE 'N'.
   167
   168 GC0909 01  Horizontal-Line             PIC X(80).
   169 GC0909
   170        01  I                           USAGE BINARY-LONG.
   171
   172        01  J                           USAGE BINARY-LONG.
   173
   174 GC0909 01  MS                          USAGE BINARY-LONG.
   175
   176 GC0909 01  ML                          USAGE BINARY-LONG.
   177
   178        01  OC-Compiled                 PIC XXXX/XX/XXBXX/XX.
   179
   180 GC0909 01  OS-Type                     USAGE BINARY-LONG.
   181 GC0909     88 OS-Unknown               VALUE 0.
   182 GC0909     88 OS-Windows               VALUE 1.
   183 GC0909     88 OS-Cygwin                VALUE 2.
   184 GC0909     88 OS-UNIX                  VALUE 3.
   185
   186 GC0909 01  OS-Type-Literal             PIC X(7).
   187
   188        01  Output-Message              PIC X(80).
   189
   190        01  Path-Delimiter              PIC X(1).
   191
   192        01  Prog-Folder                 PIC X(256).
   193
   194        01  Prog-Extension              PIC X(30).
   195
   196        01  Prog-File-Name              PIC X(40).
   197
   198        01  Prog-Name                   PIC X(31).
   199

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
   200        78  Selection-Char              VALUE '>'.
   201
   202        01  Switch-Display.
   203            05 SD-Switch-And-Value      PIC X(19).
   204            05 FILLER                   PIC X(1).
   205            05 SD-Description           PIC X(60).
   206
   207        01  Switch-Keyword              PIC X(12).
   208 GC0410     88 Switch-Is-CONFIG     VALUE '@CONFIG', '@C'.
   209 GC0410     88 Switch-Is-DEBUG      VALUE '@DEBUG', '@D'.
   210 GC0410     88 Switch-Is-DLL        VALUE '@DLL'.
   211 GC0410     88 Switch-Is-EXECUTE    VALUE '@EXECUTE', '@E'.
   212 GC0410     88 Switch-Is-EXTRA      VALUE '@EXTRA', '@EX'.
   213 GC0410     88 Switch-Is-NOTRUNC    VALUE '@NOTRUNC', '@N'.
   214 GC0410     88 Switch-Is-TRACE      VALUE '@TRACE', '@T'.
   215 GC0410     88 Switch-Is-SOURCE     VALUE '@SOURCE', '@S'.
   216 GC0410     88 Switch-Is-XREF       VALUE '@XREF', '@X'.
   217
   218        01  Switch-Keyword-And-Value    PIC X(256).
   219
   220        01  Switch-Value.
   221            05 SV-1                     PIC X(1).
   222            05 FILLER                   PIC X(255).
   223        01  Switch-Value-Alt            REDEFINES Switch-Value
   224                                        PIC X(256).
   225            88 Valid-Config-Filename
   226               VALUE 'BS2000', 'COBOL85', 'COBOL2002', 'DEFAULT',
   227                     'IBM',    'MF',      'MVS'.
   228
   229        01  Switches.
   230            05 S-ARGS                   PIC X(75) VALUE SPACES.
   231            05 S-CfgS.
   232               10 S-Cfg-BS2000          PIC X(1)  VALUE ' '.
   233               10 S-Cfg-COBOL85         PIC X(1)  VALUE ' '.
   234               10 S-Cfg-COBOL2002       PIC X(1)  VALUE ' '.
   235               10 S-Cfg-DEFAULT         PIC X(1)  VALUE Selection-Char.
   236               10 S-Cfg-IBM             PIC X(1)  VALUE ' '.
   237               10 S-Cfg-MF              PIC X(1)  VALUE ' '.
   238               10 S-Cfg-MVS             PIC X(1)  VALUE ' '.
   239            05 S-EXTRA                  PIC X(75) VALUE SPACES.
   240            05 S-Yes-No-Switches.
   241               10 S-DEBUG               PIC X(1)  VALUE 'N'.
   242               10 S-DLL                 PIC X(1)  VALUE 'N'.
   243 GC0410        10 S-XREF                PIC X(1)  VALUE 'N'.
   244 GC0410        10 S-SOURCE              PIC X(1)  VALUE 'N'.
   245               10 S-EXECUTE             PIC X(1)  VALUE 'N'.
   246               10 S-NOTRUNC             PIC X(1)  VALUE 'Y'.
   247               10 S-SUBROUTINE          PIC X(1)  VALUE 'A'.
   248               10 S-TRACE               PIC X(1)  VALUE 'N'.
   249               10 S-TRACEALL            PIC X(1)  VALUE 'N'.
   250
   251        01  Tally                       USAGE BINARY-LONG.
   252
   253          SCREEN SECTION.
   254       *>
   255       *> Here is the layout of the OCic screen.

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
   256       *>
   257       *> Note that this program can utilize the traditional PC line-drawing characters,
   258       *> if they are available.
   259       *>
   260       *> If this program is run on Windows, it must run with codepage 437 activated to
   261       *> display the line-drawing characters.  With a native Windows build or a
   262       *> Windows/MinGW build, one could use the command "chcp 437" to set that codepage
   263       *> for display within a Windows console window (that should be the default, though).
   264       *> With a Windows/Cygwin build, set the environment variable CYGWIN to a value of
   265       *> "codepage:oem" (this cannot be done from within the program though - you will
   266       *> have to use the "Computer/Advanced System Settings/Environment Variables" (Vista or
   267       *> Windows 7) function to define the variable.  XP Users: use "My Computer/Properties/
   268       *> Advanced/Environment Variables".
   269       *>
   270       *> To use OCic without the line-drawing characters, comment-out the first set of
   271       *> 78 "LD" items and uncomment the second.
   272       *>
   273       *> The following sample screen layout shows how the screen looks with line-drawing
   274       *> characters disabled.
   275       *>
   276       *>===================================================================================
   277       *> OCic (2010/04/02 11:36) - OpenCOBOL V1.1 Interactive Compilation                01
   278       *> +-----------------------------------------------------------------------------+ 02
   279       *> | Program:  OCic                                            F-Key: Select Opt | 03
   280       *> | Folder:   E:\OpenCOBOL\Samples                            Enter: Compile    | 04
   281       *> | Filename: OCic.cbl                                        Esc:   Quit       | 05
   282       *> +-----------------------------------------------------------------------------+ 06
   283       *>   On/Off Switches:                                          Configuration:      07
   284       *> +---------------------------------------------------------+-------------------+ 08
   285       *> | F1   Compile debug lines    F8   Produce source listing | S-F1   BS2000     | 09
   286       *> | F2   Always make DLLs       F9   Produce xref listing   | S-F2   COBOL85    | 10
   287       *> | F3   Pgm is a SUBROUTINE                                | S-F3   COBOL2002  | 11
   288       *> | F4   Execute if compile OK                              | S-F4 > Default    | 12
   289       *> | F5 > No COMP/BINARY trunc                               | S-F5   IBM        | 13
   290       *> | F6   Trace procedures                                   | S-F6   MicroFocus | 14
   291       *> | F7   Trace proc + stmnts                                | S-F7   MVS        | 15
   292       *> +---------------------------------------------------------+-------------------+ 16
   293       *>   Extra "cobc" Switches, if any ("-save-temps=xxx" disables listing/xref):      17
   294       *> +-----------------------------------------------------------------------------+ 18
   295       *> | -O2________________________________________________________________________ | 19
   296       *> +-----------------------------------------------------------------------------+ 20
   297       *>   Program Execution Arguments, if any:                                          21
   298       *> +-----------------------------------------------------------------------------+ 22
   299       *> | ___________________________________________________________________________ | 23
   300       *> +-----------------------------------------------------------------------------+ 24
   301       *> OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                               25
   302       *>===================================================================================
   303       *>12345678901234567890123456789012345678901234567890123456789012345678901234567890
   304       *>         1         2         3         4         5         6         7         8
   305       *>
   306       *> USE THESE CHARS FOR LINE-DRAWING IF YOU HAVE ACCESS TO PC-DOS CODEPAGE 437:
   307       *>
   308        78 LD-UL-Corner                 VALUE X"DA".
   309        78 LD-LL-Corner                 VALUE X"C0".
   310        78 LD-UR-Corner                 VALUE X"BF".
   311        78 LD-LR-Corner                 VALUE X"D9".

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
   312        78 LD-Upper-T                   VALUE X"C2".
   313        78 LD-Lower-T                   VALUE X"C1".
   314        78 LD-Horiz-Line                VALUE X"C4".
   315        78 LD-Vert-Line                 VALUE X"B3".
   316       *>
   317       *> USE THESE CHARS FOR LINE-DRAWING IF YOU DO NOT HAVE ACCESS TO PC-DOS CODEPAGE 437:
   318       *>
   319       *> 78 LD-UL-Corner                          VALUE '+'.
   320       *> 78 LD-LL-Corner                          VALUE '+'.
   321       *> 78 LD-UR-Corner                          VALUE '+'.
   322       *> 78 LD-LR-Corner                          VALUE '+'.
   323       *> 78 LD-Upper-T                            VALUE '+'.
   324       *> 78 LD-Lower-T                            VALUE '+'.
   325       *> 78 LD-Horiz-Line                         VALUE '-'.
   326       *> 78 LD-Vert-Line                          VALUE '|'.
   327       *>
   328        01 Blank-Screen LINE 1 COLUMN 1 BLANK SCREEN.
   329
   330        01 Switches-Screen BACKGROUND-COLOR COB-COLOR-BLACK
   331                           FOREGROUND-COLOR COB-COLOR-WHITE AUTO.
   332       *>
   333       *> GENERAL SCREEN FRAMEWORK
   334       *>
   335           03 BACKGROUND-COLOR COB-COLOR-BLACK
   336              FOREGROUND-COLOR COB-COLOR-BLUE  HIGHLIGHT.
   337              05 LINE 02 COL 02           VALUE LD-UL-Corner.
   338              05                PIC X(77) FROM  Horizontal-Line.
   339              05         COL 80           VALUE LD-UR-Corner.
   340
   341              05 LINE 03 COL 02           VALUE LD-Vert-Line.
   342              05         COL 80           VALUE LD-Vert-Line.
   343
   344              05 LINE 04 COL 02           VALUE LD-Vert-Line.
   345              05         COL 80           VALUE LD-Vert-Line.
   346
   347              05 LINE 05 COL 02           VALUE LD-Vert-Line.
   348              05         COL 80           VALUE LD-Vert-Line.
   349
   350              05 LINE 06 COL 02           VALUE LD-LL-Corner.
   351              05                PIC X(77) FROM  Horizontal-Line.
   352              05         COL 80           VALUE LD-LR-Corner.
   353
   354              05 LINE 08 COL 02           VALUE LD-UL-Corner.
   355              05                PIC X(57) FROM  Horizontal-Line.
   356              05         COL 60           VALUE LD-Upper-T.
   357              05                PIC X(19) FROM  Horizontal-Line.
   358              05         COL 80           VALUE LD-UR-Corner.
   359
   360              05 LINE 09 COL 02           VALUE LD-Vert-Line.
   361              05         COL 60           VALUE LD-Vert-Line.
   362              05         COL 80           VALUE LD-Vert-Line.
   363
   364              05 LINE 10 COL 02           VALUE LD-Vert-Line.
   365              05         COL 60           VALUE LD-Vert-Line.
   366              05         COL 80           VALUE LD-Vert-Line.
   367

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
   368              05 LINE 11 COL 02           VALUE LD-Vert-Line.
   369              05         COL 60           VALUE LD-Vert-Line.
   370              05         COL 80           VALUE LD-Vert-Line.
   371
   372              05 LINE 12 COL 02           VALUE LD-Vert-Line.
   373              05         COL 60           VALUE LD-Vert-Line.
   374              05         COL 80           VALUE LD-Vert-Line.
   375
   376              05 LINE 13 COL 02           VALUE LD-Vert-Line.
   377              05         COL 60           VALUE LD-Vert-Line.
   378              05         COL 80           VALUE LD-Vert-Line.
   379
   380              05 LINE 14 COL 02           VALUE LD-Vert-Line.
   381              05         COL 60           VALUE LD-Vert-Line.
   382              05         COL 80           VALUE LD-Vert-Line.
   383
   384              05 LINE 15 COL 02           VALUE LD-Vert-Line.
   385              05         COL 60           VALUE LD-Vert-Line.
   386              05         COL 80           VALUE LD-Vert-Line.
   387
   388              05 LINE 16 COL 02           VALUE LD-LL-Corner.
   389              05                PIC X(57) FROM  Horizontal-Line.
   390              05         COL 60           VALUE LD-Lower-T.
   391              05                PIC X(19) FROM  Horizontal-Line.
   392              05         COL 80           VALUE LD-LR-Corner.
   393
   394              05 LINE 18 COL 02           VALUE LD-UL-Corner.
   395              05                PIC X(77) FROM  Horizontal-Line.
   396              05         COL 80           VALUE LD-UR-Corner.
   397
   398              05 LINE 19 COL 02           VALUE LD-Vert-Line.
   399              05         COL 80           VALUE LD-Vert-Line.
   400
   401              05 LINE 20 COL 02           VALUE LD-LL-Corner.
   402              05                PIC X(77) FROM  Horizontal-Line.
   403              05         COL 80           VALUE LD-LR-Corner.
   404
   405              05 LINE 22 COL 02           VALUE LD-UL-Corner.
   406              05                PIC X(77) FROM  Horizontal-Line.
   407              05         COL 80           VALUE LD-UR-Corner.
   408
   409              05 LINE 23 COL 02           VALUE LD-Vert-Line.
   410              05         COL 80           VALUE LD-Vert-Line.
   411
   412              05 LINE 24 COL 02           VALUE LD-LL-Corner.
   413              05                PIC X(77) FROM  Horizontal-Line.
   414              05         COL 80           VALUE LD-LR-Corner.
   415       *>
   416       *> TOP AND BOTTOM LINES
   417       *>
   418           03 BACKGROUND-COLOR COB-COLOR-BLUE  BLINK
   419              FOREGROUND-COLOR COB-COLOR-WHITE HIGHLIGHT.
   420 GC0410       05 LINE 01 COL 01 VALUE ' OCic ('.
   421 GC0410       05                PIC X(16) FROM OC-Compiled.
   422 GC0410       05                VALUE ') OpenCOBOL V1.1 06FEB2009 ' &
   423 GC0410                               'Interactive Compilation        '.

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
   424 GC0410       05 LINE 25 COL 01 PIC X(81) FROM Output-Message.
   425       *>
   426       *> LABELS
   427       *>
   428           03 BACKGROUND-COLOR COB-COLOR-BLACK
   429              FOREGROUND-COLOR COB-COLOR-CYAN  HIGHLIGHT.
   430              05 LINE 07 COL 04 VALUE 'On/Off Switches:'.
   431              05         COL 62 VALUE 'Configuration:'.
   432 GC1010       05 LINE 17 COL 04 VALUE 'Extra "cobc" Switches, if any ("-s
   433 GC1010-                              'ave-temps=xxx" disables listing/xr
   434 GC1010-                              'ef):'.
   435 GC1010       05 LINE 21 COL 04 VALUE 'Program Execution Arguments, if an
   436 GC1010-                              'y:'.
   437       *>
   438       *> TOP SECTION BACKGROUND
   439       *>
   440           03 BACKGROUND-COLOR COB-COLOR-BLACK
   441              FOREGROUND-COLOR COB-COLOR-CYAN LOWLIGHT.
   442              05 LINE 03 COL 04 VALUE 'Program:  '.
   443              05 LINE 04 COL 04 VALUE 'Folder:   '.
   444              05 LINE 05 COL 04 VALUE 'Filename: '.
   445
   446              05 LINE 03 COL 62 VALUE 'F-Key: Select Opt'.
   447              05 LINE 04 COL 62 VALUE 'Enter: Compile   '.
   448              05 LINE 05 COL 62 VALUE 'Esc:   Quit      '.
   449       *>
   450       *> TOP SECTION PROGRAM INFO
   451       *>
   452           03 BACKGROUND-COLOR COB-COLOR-BLACK
   453              FOREGROUND-COLOR COB-COLOR-WHITE HIGHLIGHT.
   454              05 LINE 03 COL 14 PIC X(47) FROM Prog-Name.
   455              05 LINE 04 COL 14 PIC X(47) FROM Prog-Folder.
   456              05 LINE 05 COL 14 PIC X(47) FROM Prog-File-Name.
   457       *>
   458       *> MIDDLE LEFT SECTION F-KEYS
   459       *>
   460           03 BACKGROUND-COLOR COB-COLOR-BLACK
   461              FOREGROUND-COLOR COB-COLOR-WHITE HIGHLIGHT.
   462              05 LINE 09 COL 04 VALUE 'F1'.
   463              05 LINE 10 COL 04 VALUE 'F2'.
   464              05 LINE 11 COL 04 VALUE 'F3'.
   465              05 LINE 12 COL 04 VALUE 'F4'.
   466              05 LINE 13 COL 04 VALUE 'F5'.
   467              05 LINE 14 COL 04 VALUE 'F6'.
   468              05 LINE 15 COL 04 VALUE 'F7'.
   469              05 LINE 09 COL 32 VALUE 'F8'.
   470              05 LINE 10 COL 32 VALUE 'F9'.
   471       *>
   472       *> MIDDLE LEFT SECTION SWITCHES
   473       *>
   474           03 BACKGROUND-COLOR COB-COLOR-BLACK
   475              FOREGROUND-COLOR COB-COLOR-RED   HIGHLIGHT.
   476              05 LINE 09 COL 07 PIC X(1) FROM S-DEBUG.
   477              05 LINE 10 COL 07 PIC X(1) FROM S-DLL.
   478              05 LINE 11 COL 07 PIC X(1) FROM S-SUBROUTINE.
   479              05 LINE 12 COL 07 PIC X(1) FROM S-EXECUTE.

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
   480              05 LINE 13 COL 07 PIC X(1) FROM S-NOTRUNC.
   481              05 LINE 14 COL 07 PIC X(1) FROM S-TRACE.
   482              05 LINE 15 COL 07 PIC X(1) FROM S-TRACEALL.
   483              05 LINE 09 COL 35 PIC X(1) FROM S-SOURCE.
   484              05 LINE 10 COL 35 PIC X(1) FROM S-XREF.
   485       *>
   486       *> MIDDLE LEFT SECTION BACKGROUND
   487       *>
   488           03 BACKGROUND-COLOR COB-COLOR-BLACK
   489              FOREGROUND-COLOR COB-COLOR-CYAN  LOWLIGHT.
   490              05 LINE 09 COL 09 VALUE 'Compile debug lines   '.
   491              05 LINE 10 COL 09 VALUE 'Always make DLLs      '.
   492              05 LINE 11 COL 09 VALUE 'Pgm is a SUBROUTINE   '.
   493              05 LINE 12 COL 09 VALUE 'Execute if compile OK '.
   494              05 LINE 13 COL 09 VALUE 'No COMP/BINARY trunc  '.
   495              05 LINE 14 COL 09 VALUE 'Trace procedures      '.
   496              05 LINE 15 COL 09 VALUE 'Trace proc + stmnts   '.
   497              05 LINE 09 COL 37 VALUE 'Produce source listing'.
   498              05 LINE 10 COL 37 VALUE 'Produce xref listing  '.
   499       *>
   500       *> MIDDLE RIGHT SECTION F-KEYS
   501       *>
   502           03 BACKGROUND-COLOR COB-COLOR-BLACK
   503              FOREGROUND-COLOR COB-COLOR-WHITE HIGHLIGHT.
   504              05 LINE 09 COL 62 VALUE 'S-F1'.
   505              05 LINE 10 COL 62 VALUE 'S-F2'.
   506              05 LINE 11 COL 62 VALUE 'S-F3'.
   507              05 LINE 12 COL 62 VALUE 'S-F4'.
   508              05 LINE 13 COL 62 VALUE 'S-F5'.
   509              05 LINE 14 COL 62 VALUE 'S-F6'.
   510              05 LINE 15 COL 62 VALUE 'S-F7'.
   511       *>
   512       *> MIDDLE RIGHT SECTION SWITCHES
   513       *>
   514           03 BACKGROUND-COLOR COB-COLOR-BLACK
   515              FOREGROUND-COLOR COB-COLOR-RED HIGHLIGHT.
   516              05 LINE 09 COL 67 PIC X(1) FROM S-Cfg-BS2000.
   517              05 LINE 10 COL 67 PIC X(1) FROM S-Cfg-COBOL85.
   518              05 LINE 11 COL 67 PIC X(1) FROM S-Cfg-COBOL2002.
   519              05 LINE 12 COL 67 PIC X(1) FROM S-Cfg-DEFAULT.
   520              05 LINE 13 COL 67 PIC X(1) FROM S-Cfg-IBM.
   521              05 LINE 14 COL 67 PIC X(1) FROM S-Cfg-MF.
   522              05 LINE 15 COL 67 PIC X(1) FROM S-Cfg-MVS.
   523       *>
   524       *> MIDDLE RIGHT SECTION BACKGROUND
   525       *>
   526           03 BACKGROUND-COLOR COB-COLOR-BLACK
   527              FOREGROUND-COLOR COB-COLOR-CYAN LOWLIGHT.
   528              05 LINE 09 COL 69 VALUE 'BS2000    '.
   529              05 LINE 10 COL 69 VALUE 'COBOL85   '.
   530              05 LINE 11 COL 69 VALUE 'COBOL2002 '.
   531              05 LINE 12 COL 69 VALUE 'Default   '.
   532              05 LINE 13 COL 69 VALUE 'IBM       '.
   533              05 LINE 14 COL 69 VALUE 'MicroFocus'.
   534              05 LINE 15 COL 69 VALUE 'MVS       '.
   535       *>

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
   536       *> FREE-FORM OPTIONS FIELDS
   537       *>
   538           03 BACKGROUND-COLOR COB-COLOR-BLACK
   539              FOREGROUND-COLOR COB-COLOR-WHITE HIGHLIGHT.
   540              05 LINE 19 COL 04 PIC X(75) USING S-EXTRA.
   541              05 LINE 23 COL 04 PIC X(75) USING S-ARGS.

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
   542       /
   543        PROCEDURE DIVISION.
   544       *****************************************************************
   545       ** Legend to procedure names:                                  **
   546       **                                                             **
   547       ** 00x-xxx   All MAIN driver procedures                        **
   548       ** 0xx-xxx   All GLOBAL UTILITY procedures                     **
   549       ** 1xx-xxx   All INITIALIZATION procedures                     **
   550       ** 2xx-xxx   All CORE PROCESSING procedures                    **
   551       ** 9xx-xxx   All TERMINATION procedures                        **
   552       *****************************************************************
   553        DECLARATIVES.
   554        000-File-Error SECTION.
   555            USE AFTER STANDARD ERROR PROCEDURE ON Source-Code.
   556        000-Handle-Error.
   557            COPY FileStat-Msgs
   558                REPLACING STATUS BY FSM-Status
   559                          MSG    BY FSM-Msg.
        EVALUATE FSM-Status
        WHEN 00 MOVE 'SUCCESS                  ' TO FSM-Msg
        WHEN 02 MOVE 'SUCCESS DUPLICATE        ' TO FSM-Msg
        WHEN 04 MOVE 'SUCCESS INCOMPLETE       ' TO FSM-Msg
        WHEN 05 MOVE 'SUCCESS OPTIONAL         ' TO FSM-Msg
        WHEN 07 MOVE 'SUCCESS NO UNIT          ' TO FSM-Msg
        WHEN 10 MOVE 'END OF FILE              ' TO FSM-Msg
        WHEN 14 MOVE 'OUT OF KEY RANGE         ' TO FSM-Msg
        WHEN 21 MOVE 'KEY INVALID              ' TO FSM-Msg
        WHEN 22 MOVE 'KEY EXISTS               ' TO FSM-Msg
        WHEN 23 MOVE 'KEY NOT EXISTS           ' TO FSM-Msg
        WHEN 30 MOVE 'PERMANENT ERROR          ' TO FSM-Msg
        WHEN 31 MOVE 'INCONSISTENT FILENAME    ' TO FSM-Msg
        WHEN 34 MOVE 'BOUNDARY VIOLATION       ' TO FSM-Msg
        WHEN 35 MOVE 'FILE NOT FOUND           ' TO FSM-Msg
        WHEN 37 MOVE 'PERMISSION DENIED        ' TO FSM-Msg
        WHEN 38 MOVE 'CLOSED WITH LOCK         ' TO FSM-Msg
        WHEN 39 MOVE 'CONFLICT ATTRIBUTE       ' TO FSM-Msg
        WHEN 41 MOVE 'ALREADY OPEN             ' TO FSM-Msg
        WHEN 42 MOVE 'NOT OPEN                 ' TO FSM-Msg
        WHEN 43 MOVE 'READ NOT DONE            ' TO FSM-Msg
        WHEN 44 MOVE 'RECORD OVERFLOW          ' TO FSM-Msg
        WHEN 46 MOVE 'READ ERROR               ' TO FSM-Msg
        WHEN 47 MOVE 'INPUT DENIED             ' TO FSM-Msg
        WHEN 48 MOVE 'OUTPUT DENIED            ' TO FSM-Msg
        WHEN 49 MOVE 'I/O DENIED               ' TO FSM-Msg
        WHEN 51 MOVE 'RECORD LOCKED            ' TO FSM-Msg
        WHEN 52 MOVE 'END-OF-PAGE              ' TO FSM-Msg
        WHEN 57 MOVE 'I/O LINAGE               ' TO FSM-Msg
        WHEN 61 MOVE 'FILE SHARING FAILURE     ' TO FSM-Msg
        WHEN 91 MOVE 'FILE NOT AVAILABLE       ' TO FSM-Msg
        END-EVALUATE.
   560            MOVE SPACES TO Output-Message
   561            IF FSM-Status = 35
   562                DISPLAY
   563                    'File not found: "'
   564                    TRIM(File-Name,TRAILING)
   565                    '"'

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
   566                END-DISPLAY
   567            ELSE
   568                DISPLAY
   569                    'Error accessing file: "'
   570                    TRIM(File-Name,TRAILING)
   571                    '"'
   572                END-DISPLAY
   573            END-IF
   574            GOBACK
   575            .
   576        END DECLARATIVES.

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
   577       /
   578        000-Main SECTION.
   579
   580            PERFORM 100-Initialization
   581 GC0609     SET 88-Not-Complete TO TRUE
   582 GC0609     PERFORM UNTIL 88-Complete
   583 GC0609         PERFORM 200-Let-User-Set-Switches
   584 GC0609         PERFORM 210-Run-Compiler
   585 GC0410         IF (88-Compile-OK OR 88-Compile-OK-Warn)
   586 GC0410         AND (S-XREF NOT = SPACE OR S-SOURCE NOT = SPACE)
   587 GC0410             PERFORM 220-Make-Listing
   588 GC0410         END-IF
   589 GC0709         IF  (S-EXECUTE NOT = SPACES)
   590 GC0709         AND (88-Output-File-Avail)
   591 GC0609             PERFORM 230-Run-Program
   592 GC0609         END-IF
   593 GC0609     END-PERFORM
   594            .
   595
   596        009-Done.
   597            PERFORM 900-Terminate
   598            .
   599       * -- Control will NOT return

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
   600       /
   601        010-Parse-Args SECTION.
   602       *****************************************************************
   603       ** Process a sequence of KEYWORD=VALUE items.  These are items **
   604       ** specified on the command-line to provide the initial        **
   605       ** options shown selected on the screen.  When integrating     **
   606       ** OCic into an edirot or framework, include these switches on **
   607       ** the ocic.exe command the editor/framework executes.  Any    **
   608       ** underlined choice is the default value for that switch.     **
   609       **                                                             **
   610       ** @CONFIG=BS2000|COBOL85|COBOL2002|DEFAULT|IBM|MF|MVS         **
   611       **                                  =======                    **
   612       ** This switch specifies the default cobc compiler configura-  **
   613       ** tion file to be used                                        **
   614       **                                                             **
   615       ** @DEBUG=YES|NO                                               **
   616       **            ==                                               **
   617       ** This switch specifies whether (YES) or not (NO) debugging   **
   618       ** lines (those with a "D" in column 7) will be compiled.      **
   619       **                                                             **
   620       ** @DLL=YES|NO                                                 **
   621       **          ==                                                 **
   622       ** Use this switch to force ALL compiled programs to be built  **
   623       ** as DLLs ("@DLL=YES").  When main programs are built as DLLs **
   624       ** they must be executed using the cobcrun utility.  When      **
   625       ** "@DLL=NO" is in effect, main programs are generated as      **
   626       ** actual "exe" files and only subprograms will be generated   **
   627       ** as DLLs.                                                    **
   628       **                                                             **
   629       ** @EXECUTE=YES|NO                                             **
   630       **              ==                                             **
   631       ** This switch specifies whether ("@EXECUTE=YES") or not       **
   632       ** ("@EXECUTE=NO") the program will be executed after it is    **
   633       ** successfully compiled.                                      **
   634       **                                                             **
   635       ** @EXTRA=extra cobc argument(s)                               **
   636       **                                                             **
   637       ** This switch allows you to specify additional cobc arguments **
   638       ** that aren't managed by the other OC switches.  If used,     **
   639       ** this must be the last switch specified on the command line, **
   640       ** as everything that follows the "=" will be placed on the    **
   641       ** cobc command generated by OC.                               **
   642       **                                                             **
   643       ** @NOTRUNC=YES|NO                                             **
   644       **          ===                                                **
   645       ** This switch specifies whether (YES) or not (NO) the sup-    **
   646       ** pression of binary field truncation will occur.  If a PIC   **
   647       ** 99 COMP field (one byte of storage), for example, is given  **
   648       ** the value 123, it may have its value truncated to 23 when   **
   649       ** DISPLAYed.  Regardless of the NOTRUNC setting, internally   **
   650       ** the full precision of the field (allowing a maximum value   **
   651       ** of 255) will be preserved.  Even though truncation - if it  **
   652       ** does occur - would appear to have a minimal disruption on   **
   653       ** program operation, it has a significant effect on program   **
   654       ** run-time speed.                                             **
   655       **                                                             **

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
   656       ** @TRACE=YES|NO|ALL                                           **
   657       **            ==                                               **
   658       ** This switch controls whether or not code will be added to   **
   659       ** the object program to produce execution-time logic traces.  **
   660       ** A specification of "@TRACE=NO" means no such code will be   **
   661       ** produced.  By specifying "@TRACE=YES", code will be genera- **
   662       ** ted to display procedure names as they are entered.  A      **
   663       ** "@TRACE=ALL" specification will generate not only procedure **
   664       ** traces (as "@TRACE=YES" would) but also statement-level     **
   665       ** traces too!  All trace output is written to STDERR, so      **
   666       ** adding a "2>file" to the execution of the program will pipe **
   667       ** the trace output to a file.  You may find it valuable to    **
   668       ** add your own DISPLAY statements to the debugging output via **
   669       ** "DISPLAY xx UPON SYSERR"  The SYSERR device corresponds to  **
   670       ** the Windows or UNIX STDERR device and will therefore honor  **
   671       ** any "2>file" placed at the end of your program's execution. **
   672       ** Add a "D" in column 7 and you can control the generation or **
   673       ** ignoring of these DISPLAY statements via the "@DEBUG"       **
   674       ** switch.                                                     **
   675       **                                                             **
   676 GC0410** @SOURCE=YES|NO                                              **
   677 GC0410**           ==                                                **
   678 GC0410** Use this switch to produce a source listing of the program, **
   679 GC0410** PROVIDED it compiles without errors.                        **
   680       **                                                             **
   681 GC0410** @XREF=YES|NO                                                **
   682 GC0410**           ==                                                **
   683 GC0410** Use this switch to produce a cross-reference listing of the **
   684 GC0410** program, PROVIDED it compiles without errors.               **
   685       *****************************************************************
   686
   687        011-Init.
   688            MOVE 1 TO I
   689            .
   690
   691        012-Extract-Kwd-And-Value.
   692            PERFORM UNTIL I NOT < LENGTH(Command-Line-Args)
   693                MOVE I TO J
   694                UNSTRING Command-Line-Args
   695                    DELIMITED BY ALL SPACES
   696                    INTO Switch-Keyword-And-Value
   697                    WITH POINTER I
   698                END-UNSTRING
   699                IF Switch-Keyword-And-Value NOT = SPACES
   700                    UNSTRING Switch-Keyword-And-Value
   701                        DELIMITED BY '='
   702                        INTO Switch-Keyword, Switch-Value
   703                    END-UNSTRING
   704                    PERFORM 030-Process-Keyword
   705                END-IF
   706            END-PERFORM
   707            .
   708
   709        019-Done.
   710            EXIT.
   711

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
   712       *****************************************************************
   713       ** Since this program uses the SCREEN SECTION, it cannot do    **
   714       ** conventional console DISPLAY operations.  This routine      **
   715       ** (which, I admit, is like using an H-bomb to hunt rabbits)   **
   716       ** will submit an "ECHO" command to the system to simulate a   **
   717       ** DISPLAY.                                                    **
   718       *****************************************************************
   719        021-Build-And-Issue-Command.
   720            DISPLAY
   721                Output-Message
   722            END-DISPLAY
   723            .
   724
   725        029-Done.
   726            EXIT.

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
   727       /
   728        030-Process-Keyword SECTION.
   729       *****************************************************************
   730       ** Process a single KEYWORD=VALUE item.                        **
   731       *****************************************************************
   732
   733        031-Init.
   734            MOVE UPPER-CASE(Switch-Keyword) TO Switch-Keyword
   735            SET 88-Switch-Is-Good TO TRUE
   736            .
   737
   738        032-Process.
   739            EVALUATE TRUE
   740                WHEN Switch-Is-EXTRA
   741 GC0410             MOVE J TO I
   742                    UNSTRING Command-Line-Args DELIMITED BY '='
   743                        INTO Dummy, S-EXTRA
   744 GC0410                 WITH POINTER I
   745 GC0410             END-UNSTRING
   746                    MOVE LENGTH(Command-Line-Args) TO I
   747                WHEN Switch-Is-CONFIG
   748                    MOVE 'CONFIG' TO Switch-Keyword
   749                    MOVE UPPER-CASE(Switch-Value)
   750                      TO Switch-Value
   751                    EVALUATE Switch-Value
   752                        WHEN 'BS2000'
   753                            MOVE SPACES TO S-CfgS
   754                            MOVE Selection-Char    TO S-Cfg-BS2000
   755                        WHEN 'COBOL85'
   756                            MOVE SPACES TO S-CfgS
   757                            MOVE Selection-Char    TO S-Cfg-COBOL85
   758                        WHEN 'COBOL2002'
   759                            MOVE SPACES TO S-CfgS
   760                            MOVE Selection-Char    TO S-Cfg-COBOL2002
   761                        WHEN 'DEFAULT'
   762                            MOVE SPACES TO S-CfgS
   763                            MOVE Selection-Char    TO S-Cfg-DEFAULT
   764                        WHEN 'IBM'
   765                            MOVE SPACES TO S-CfgS
   766                            MOVE Selection-Char    TO S-Cfg-IBM
   767                        WHEN 'MF'
   768                            MOVE SPACES TO S-CfgS
   769                            MOVE Selection-Char    TO S-Cfg-MF
   770                        WHEN 'MVS'
   771                            MOVE SPACES TO S-CfgS
   772                            MOVE Selection-Char    TO S-Cfg-MVS
   773                        WHEN OTHER
   774                            MOVE 'An invalid /CONFIG switch value ' &
   775                                 'was specified on the command line ' &
   776                                 '- ignored'
   777                              TO Output-Message
   778                    END-EVALUATE
   779                WHEN Switch-Is-DEBUG
   780                    MOVE 'DEBUG' TO Switch-Keyword
   781                    MOVE UPPER-CASE(Switch-Value)
   782                      TO Switch-Value

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
   783                    PERFORM 040-Process-Yes-No-Value
   784                    IF 88-Switch-Is-Good
   785                        MOVE SV-1 TO S-DEBUG
   786                    END-IF
   787 GC0410         WHEN Switch-Is-DLL
   788 GC0410             MOVE 'DLL' TO Switch-Keyword
   789 GC0410             MOVE UPPER-CASE(Switch-Value)
   790 GC0410               TO Switch-Value
   791 GC0410             PERFORM 040-Process-Yes-No-Value
   792 GC0410             IF 88-Switch-Is-Good
   793 GC0410                 MOVE SV-1 TO S-DLL
   794 GC0410             END-IF
   795                WHEN Switch-Is-EXECUTE
   796                    MOVE 'EXECUTE' TO Switch-Keyword
   797                    MOVE UPPER-CASE(Switch-Value)
   798                      TO Switch-Value
   799                    PERFORM 040-Process-Yes-No-Value
   800                    IF 88-Switch-Is-Good
   801                        MOVE SV-1 TO S-EXECUTE
   802                    END-IF
   803                WHEN Switch-Is-NOTRUNC
   804                    MOVE 'NOTRUNC' TO Switch-Keyword
   805                    MOVE UPPER-CASE(Switch-Value)
   806                      TO Switch-Value
   807                    PERFORM 040-Process-Yes-No-Value
   808                    IF 88-Switch-Is-Good
   809                        MOVE SV-1 TO S-NOTRUNC
   810                    END-IF
   811 GC0410         WHEN Switch-Is-SOURCE
   812 GC0410             MOVE 'SOURCE' TO Switch-Keyword
   813 GC0410             MOVE UPPER-CASE(Switch-Value)
   814 GC0410               TO Switch-Value
   815 GC0410             PERFORM 050-Process-Yes-No-All
   816 GC0410             IF 88-Switch-Is-Good
   817 GC0410                 MOVE SV-1 TO S-SOURCE
   818 GC0410             END-IF
   819                WHEN Switch-Is-TRACE
   820                    MOVE 'TRACE' TO Switch-Keyword
   821                    MOVE UPPER-CASE(Switch-Value)
   822                      TO Switch-Value
   823                    PERFORM 050-Process-Yes-No-All
   824                    IF 88-Switch-Is-Good
   825                        MOVE SV-1 TO S-TRACE
   826                    END-IF
   827 GC0410         WHEN Switch-Is-XREF
   828 GC0410             MOVE 'XREF' TO Switch-Keyword
   829 GC0410             MOVE UPPER-CASE(Switch-Value)
   830 GC0410               TO Switch-Value
   831 GC0410             PERFORM 050-Process-Yes-No-All
   832 GC0410             IF 88-Switch-Is-Good
   833 GC0410                 MOVE SV-1 TO S-XREF
   834 GC0410             END-IF
   835                WHEN OTHER
   836                    MOVE SPACES TO Output-Message
   837                    STRING '"'
   838                           TRIM(Switch-Keyword)

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
   839                           '" is not a valid switch ' &
   840                                          '- ignored'
   841                           DELIMITED SIZE
   842                           INTO Output-Message
   843                    END-STRING
   844                    SET 88-Switch-Is-Bad TO TRUE
   845            END-EVALUATE
   846            .
   847
   848        039-Done.
   849            EXIT.

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
   850       /
   851        040-Process-Yes-No-Value SECTION.
   852       *****************************************************************
   853       ** Process a switch value of YES or NO                         **
   854       *****************************************************************
   855
   856        042-Process.
   857            EVALUATE SV-1
   858                WHEN 'Y'
   859                    MOVE 'YES' TO Switch-Value
   860                WHEN 'N'
   861                    MOVE 'NO'  To Switch-Value
   862                WHEN OTHER
   863                    MOVE SPACES TO Output-Message
   864                    STRING '*ERROR: "' TRIM(Switch-Value)
   865                            '" is not a valid value for the "'
   866                            TRIM(Switch-Keyword) '" switch'
   867                            DELIMITED SPACES
   868                            INTO Output-Message
   869                    END-STRING
   870                    SET 88-Switch-Is-Bad TO TRUE
   871            END-EVALUATE
   872            .
   873
   874        049-Done.
   875            EXIT.

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
   876       /
   877        050-Process-Yes-No-All SECTION.
   878       *****************************************************************
   879       ** Process a switch value of YES, NO or ALL                    **
   880       *****************************************************************
   881
   882        052-Process.
   883            IF SV-1 = 'A'
   884                MOVE 'ALL' TO Switch-Value
   885            ELSE
   886                PERFORM 040-Process-Yes-No-Value
   887            END-IF
   888            .
   889
   890        059-Done.
   891            EXIT.

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
   892       /
   893        060-Process-Yes-No-Auto SECTION.
   894       *****************************************************************
   895       ** Process a switch value of YES, NO or AUTO                   **
   896       *****************************************************************
   897
   898        061-Init.
   899            IF SV-1 = 'A'
   900                PERFORM 070-Find-LINKAGE-SECTION
   901                IF 88-Compile-As-Subpgm
   902                    MOVE 'Y' TO Switch-Value
   903                ELSE
   904                    MOVE 'N' TO Switch-Value
   905                END-IF
   906            ELSE
   907                PERFORM 040-Process-Yes-No-Value
   908            END-IF
   909            .

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
   910       /
   911        070-Find-LINKAGE-SECTION SECTION.
   912       *****************************************************************
   913       ** Determine if the program being compiled is a MAIN program   **
   914       *****************************************************************
   915
   916        071-Init.
   917            OPEN INPUT Source-Code
   918            SET 88-Compile-As-Mainpgm TO TRUE
   919            SET 88-More-To-1st-Prog   TO TRUE
   920            PERFORM UNTIL 88-1st-Prog-Complete
   921                READ Source-Code AT END
   922                    CLOSE Source-Code
   923                    EXIT SECTION
   924                END-READ
   925                CALL 'CHECKSOURCE' USING Source-Code-Record
   926                                        F-Source-Record-Type
   927                END-CALL
   928                IF 88-Source-Rec-Ident
   929                    SET 88-1st-Prog-Complete TO TRUE
   930                END-IF
   931            END-PERFORM
   932            .
   933
   934        072-Process-Source.
   935            SET 88-Source-Rec-IgnoCOB-COLOR-RED TO TRUE
   936            PERFORM UNTIL 88-Source-Rec-Linkage
   937                       OR 88-Source-Rec-Ident
   938                READ Source-Code AT END
   939                    CLOSE Source-Code
   940                    EXIT SECTION
   941                END-READ
   942                CALL 'CHECKSOURCE' USING Source-Code-Record
   943                                        F-Source-Record-Type
   944                END-CALL
   945            END-PERFORM
   946            CLOSE Source-Code
   947            IF 88-Source-Rec-Linkage
   948                SET 88-Compile-As-Subpgm TO TRUE
   949            END-IF
   950            .
   951
   952        079-Done.
   953            EXIT.

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
   954       /
   955        100-Initialization SECTION.
   956       *****************************************************************
   957       ** Perform all program-wide initialization operations          **
   958       *****************************************************************
   959
   960
   961 GC0909 101-Determine-OS-Type.
   962 GC0909     CALL 'GETOSTYPE'
   963 GC0909     END-CALL
   964 GC0909     MOVE RETURN-CODE TO OS-Type
   965 GC0909     EVALUATE TRUE
   966 GC0909         WHEN OS-Unknown
   967 GC0909             MOVE '\'         TO Dir-Char
   968 GC0909             MOVE 'Unknown'   TO OS-Type-Literal
   969 GC0310             MOVE COB-SCR-F11 TO CK-S-F1
   970 GC0310             MOVE COB-SCR-F12 TO CK-S-F2
   971 GC0310             MOVE COB-SCR-F13 TO CK-S-F3
   972 GC0310             MOVE COB-SCR-F14 TO CK-S-F4
   973 GC0310             MOVE COB-SCR-F15 TO CK-S-F5
   974 GC0310             MOVE COB-SCR-F16 TO CK-S-F6
   975 GC0310             MOVE COB-SCR-F17 TO CK-S-F7
   976 GC0909         WHEN OS-Windows
   977 GC0909             MOVE '\'         TO Dir-Char
   978 GC0909             MOVE 'Windows'   TO OS-Type-Literal
   979 GC0310             MOVE COB-SCR-F13 TO CK-S-F1
   980 GC0310             MOVE COB-SCR-F14 TO CK-S-F2
   981 GC0310             MOVE COB-SCR-F15 TO CK-S-F3
   982 GC0310             MOVE COB-SCR-F16 TO CK-S-F4
   983 GC0310             MOVE COB-SCR-F17 TO CK-S-F5
   984 GC0310             MOVE COB-SCR-F18 TO CK-S-F6
   985 GC0310             MOVE COB-SCR-F19 TO CK-S-F7
   986 GC0909         WHEN OS-Cygwin
   987 GC0909             MOVE '/'         TO Dir-Char
   988 GC0410             MOVE 'Cygwin'    TO OS-Type-Literal
   989 GC0310             MOVE COB-SCR-F11 TO CK-S-F1
   990 GC0310             MOVE COB-SCR-F12 TO CK-S-F2
   991 GC0310             MOVE COB-SCR-F13 TO CK-S-F3
   992 GC0310             MOVE COB-SCR-F14 TO CK-S-F4
   993 GC0310             MOVE COB-SCR-F15 TO CK-S-F5
   994 GC0310             MOVE COB-SCR-F16 TO CK-S-F6
   995 GC0310             MOVE COB-SCR-F17 TO CK-S-F7
   996 GC0909         WHEN OS-UNIX
   997 GC0909             MOVE '/'         TO Dir-Char
   998 GC0410             MOVE 'UNIX   '   TO OS-Type-Literal
   999 GC0310             MOVE COB-SCR-F11 TO CK-S-F1
  1000 GC0310             MOVE COB-SCR-F12 TO CK-S-F2
  1001 GC0310             MOVE COB-SCR-F13 TO CK-S-F3
  1002 GC0310             MOVE COB-SCR-F14 TO CK-S-F4
  1003 GC0310             MOVE COB-SCR-F15 TO CK-S-F5
  1004 GC0310             MOVE COB-SCR-F16 TO CK-S-F6
  1005 GC0310             MOVE COB-SCR-F17 TO CK-S-F7
  1006 GC0909     END-EVALUATE
  1007 GC0909     .
  1008
  1009        102-Set-Environment-Vars.

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  1010            SET ENVIRONMENT 'COB_SCREEN_EXCEPTIONS' TO 'Y'
  1011            SET ENVIRONMENT 'COB_SCREEN_ESC'        TO 'Y'
  1012            .
  1013
  1014        104-Generate-Banner-Line-Info.
  1015            MOVE WHEN-COMPILED (1:12) TO OC-Compiled
  1016            INSPECT OC-Compiled
  1017                REPLACING ALL '/' BY ':'
  1018                AFTER INITIAL SPACE
  1019            .
  1020
  1021        105-Establish-Switch-Settings.
  1022            ACCEPT Command-Line-Args
  1023                FROM COMMAND-LINE
  1024            END-ACCEPT
  1025            MOVE TRIM(Command-Line-Args, Leading)
  1026              TO Command-Line-Args
  1027            MOVE 0 TO Tally
  1028 GC0410     INSPECT Command-Line-Args TALLYING Tally FOR ALL '@'
  1029            IF Tally = 0
  1030                MOVE Command-Line-Args TO File-Name
  1031                MOVE SPACES            TO Command-Line-Args
  1032            ELSE
  1033 GC0410         UNSTRING Command-Line-Args DELIMITED BY '@'
  1034                    INTO File-Name, Dummy
  1035                END-UNSTRING
  1036                INSPECT Command-Line-Args
  1037 GC0410             REPLACING FIRST '@' BY LOW-VALUES
  1038                UNSTRING Command-Line-Args
  1039                    DELIMITED BY LOW-VALUES
  1040                    INTO Dummy, Cmd
  1041                END-UNSTRING
  1042                MOVE SPACES TO Command-Line-Args
  1043 GC0410         STRING '@' Cmd DELIMITED SIZE
  1044                    INTO Command-Line-Args
  1045                END-STRING
  1046            END-IF
  1047            IF File-Name = SPACES
  1048                DISPLAY
  1049                    'No program filename was specified'
  1050                END-DISPLAY
  1051                PERFORM 900-Terminate
  1052            END-IF
  1053            PERFORM 010-Parse-Args
  1054            IF S-SUBROUTINE = 'A'
  1055                MOVE 'S' TO Switch-Keyword
  1056                MOVE 'A' TO Switch-Value
  1057                PERFORM 070-Find-LINKAGE-SECTION
  1058                IF 88-Compile-As-Subpgm
  1059                    MOVE 'Y' TO S-SUBROUTINE
  1060                ELSE
  1061                    MOVE 'N' TO S-SUBROUTINE
  1062                END-IF
  1063            END-IF
  1064            INSPECT S-Yes-No-Switches REPLACING ALL 'Y' BY Selection-Char
  1065            INSPECT S-Yes-No-Switches REPLACING ALL 'N' BY ' '

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  1066            .
  1067
  1068        106-Determine-Folder-Path.
  1069            Move 256 TO I
  1070 GC0909     IF OS-Cygwin AND File-Name (2:1) = ':'
  1071 GC0909         MOVE '\' TO Dir-Char
  1072 GC0909     END-IF
  1073            PERFORM UNTIL I = 0 OR FN-Char (I) = Dir-Char
  1074                SUBTRACT 1 FROM I
  1075            END-PERFORM
  1076            IF I = 0
  1077                MOVE SPACES    TO Prog-Folder
  1078                MOVE File-Name TO Prog-File-Name
  1079            ELSE
  1080                MOVE '*' TO FN-Char (I)
  1081                UNSTRING File-Name DELIMITED BY '*'
  1082                    INTO Prog-Folder
  1083                         Prog-File-Name
  1084                END-UNSTRING
  1085                MOVE Dir-Char TO FN-Char (I)
  1086            END-IF
  1087            UNSTRING Prog-File-Name DELIMITED BY '.'
  1088                INTO Prog-Name, Prog-Extension
  1089            END-UNSTRING
  1090 DEBUG D    DISPLAY
  1091 DEBUG D        'Prog-Name=' Prog-Name
  1092 DEBUG D        UPON SYSERR
  1093 DEBUG D    END-DISPLAY
  1094            IF Prog-Folder = SPACES
  1095                ACCEPT Prog-Folder
  1096                    FROM ENVIRONMENT 'CD'
  1097                END-ACCEPT
  1098 GC0909     ELSE
  1099 GC0909         CALL "CBL_CHANGE_DIR"
  1100 GC0909             USING TRIM(Prog-Folder,TRAILING)
  1101 GC0909         END-CALL
  1102            END-IF
  1103 GC0909     IF OS-Cygwin AND File-Name (2:1) = ':'
  1104 GC0909         MOVE '/' TO Dir-Char
  1105 GC0909     END-IF
  1106            .
  1107
  1108 GC0909 107-Other.
  1109 GC0909     MOVE ALL LD-Horiz-Line TO Horizontal-Line.
  1110 GC0410     MOVE CONCATENATE(' OCic for ',
  1111 GC0410                      TRIM(OS-Type-Literal,Trailing),
  1112 GC0410                      ' Copyright (C) 2009-2010, Gary L. Cutler,',
  1113 GC0410                      ' GPL')
  1114 GC0410       TO Output-Message.
  1115 GC0909     .
  1116 GC0909
  1117        109-Done.
  1118            EXIT.

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  1119       /
  1120        200-Let-User-Set-Switches SECTION.
  1121       *****************************************************************
  1122       ** Show the user the current switch settings and allow them to **
  1123       ** be changed.                                                 **
  1124       *****************************************************************
  1125
  1126        201-Init.
  1127            SET 88-Switch-Changes TO TRUE
  1128            .
  1129
  1130        202-Show-And-Change-Switches.
  1131            PERFORM UNTIL 88-No-Switch-Changes
  1132                ACCEPT
  1133                    Switches-Screen
  1134                END-ACCEPT
  1135                IF COB-CRT-STATUS > 0
  1136                    EVALUATE COB-CRT-STATUS
  1137                        WHEN COB-SCR-F1
  1138                            IF S-DEBUG = SPACE
  1139                                MOVE Selection-Char TO S-DEBUG
  1140                            ELSE
  1141                                MOVE ' ' TO S-DEBUG
  1142                            END-IF
  1143                        WHEN COB-SCR-F2
  1144                            IF S-DLL = SPACE
  1145                                MOVE Selection-Char TO S-DLL
  1146                            ELSE
  1147                                MOVE ' ' TO S-DLL
  1148                            END-IF
  1149                        WHEN COB-SCR-F3
  1150                            IF S-SUBROUTINE = SPACE
  1151                                MOVE Selection-Char TO S-SUBROUTINE
  1152                                MOVE ' ' TO S-EXECUTE
  1153                            ELSE
  1154                                MOVE ' ' TO S-SUBROUTINE
  1155                            END-IF
  1156                        WHEN COB-SCR-F4
  1157                            IF  S-EXECUTE = SPACE
  1158                            AND S-SUBROUTINE = SPACE
  1159                                MOVE Selection-Char TO S-EXECUTE
  1160                            ELSE
  1161                                MOVE ' ' TO S-EXECUTE
  1162                            END-IF
  1163                        WHEN COB-SCR-F5
  1164                            IF  S-NOTRUNC = SPACE
  1165                                MOVE Selection-Char TO S-NOTRUNC
  1166                            ELSE
  1167                                MOVE ' ' TO S-NOTRUNC
  1168                            END-IF
  1169                        WHEN COB-SCR-F6
  1170                            IF  S-TRACE = SPACE
  1171                                MOVE Selection-Char TO S-TRACE
  1172                                MOVE ' ' TO S-TRACEALL
  1173                            ELSE
  1174                                MOVE ' ' TO S-TRACE

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  1175                            END-IF
  1176                        WHEN COB-SCR-F7
  1177                            IF  S-TRACEALL = SPACE
  1178                                MOVE Selection-Char TO S-TRACEALL
  1179                                MOVE ' ' TO S-TRACE
  1180                            ELSE
  1181                                MOVE ' ' TO S-TRACEALL
  1182                            END-IF
  1183 GC0410                 WHEN COB-SCR-F8
  1184 GC0410                     IF S-SOURCE = SPACE
  1185 GC0410                         MOVE Selection-Char TO S-SOURCE
  1186 GC0410                     ELSE
  1187 GC0410                         MOVE ' ' TO S-SOURCE
  1188 GC0410                     END-IF
  1189 GC0410                 WHEN COB-SCR-F9
  1190 GC0410                     IF S-XREF = SPACE
  1191 GC0410                         MOVE Selection-Char TO S-XREF
  1192 GC0410                     ELSE
  1193 GC0410                         MOVE ' ' TO S-XREF
  1194 GC0410                     END-IF
  1195                        WHEN COB-SCR-ESC
  1196                            PERFORM 900-Terminate
  1197 GC0310                 WHEN CK-S-F1
  1198                            MOVE SPACES         TO S-CfgS
  1199                            MOVE Selection-Char TO S-Cfg-BS2000
  1200 GC0310                 WHEN CK-S-F2
  1201                            MOVE SPACES         TO S-CfgS
  1202                            MOVE Selection-Char TO S-Cfg-COBOL85
  1203 GC0310                 WHEN CK-S-F3
  1204                            MOVE SPACES         TO S-CfgS
  1205                            MOVE Selection-Char TO S-Cfg-COBOL2002
  1206 GC0310                 WHEN CK-S-F4
  1207                            MOVE SPACES         TO S-CfgS
  1208                            MOVE Selection-Char TO S-Cfg-DEFAULT
  1209 GC0310                 WHEN CK-S-F5
  1210                            MOVE SPACES         TO S-CfgS
  1211                            MOVE Selection-Char TO S-Cfg-IBM
  1212 GC0310                 WHEN CK-S-F6
  1213                            MOVE SPACES         TO S-CfgS
  1214                            MOVE Selection-Char TO S-Cfg-MF
  1215 GC0310                 WHEN CK-S-F7
  1216                            MOVE SPACES         TO S-CfgS
  1217                            MOVE Selection-Char TO S-Cfg-MVS
  1218                        WHEN OTHER
  1219                            MOVE 'An unsupported key was pressed'
  1220                              TO Output-Message
  1221                    END-EVALUATE
  1222                ELSE
  1223                    SET 88-No-Switch-Changes TO TRUE
  1224                END-IF
  1225            END-PERFORM
  1226            .
  1227
  1228        209-Done.
  1229            EXIT.

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  1230       /
  1231        210-Run-Compiler SECTION.
  1232       *****************************************************************
  1233       ** Run the compiler using the switch settings we've prepared.  **
  1234       *****************************************************************
  1235
  1236        211-Init.
  1237            MOVE SPACES TO Cmd
  1238                           Cobc-Cmd
  1239                           Output-Message
  1240            DISPLAY
  1241                Switches-Screen
  1242            END-DISPLAY
  1243            MOVE 1 TO I
  1244            EVALUATE TRUE
  1245                WHEN S-Cfg-BS2000 NOT = SPACES
  1246                    MOVE 'bs2000' TO Config-File
  1247                WHEN S-Cfg-COBOL85  NOT = SPACES
  1248                    MOVE 'cobol85' TO Config-File
  1249                WHEN  S-Cfg-COBOL2002  NOT = SPACES
  1250                    MOVE 'cobol2002' TO Config-File
  1251                WHEN  S-Cfg-IBM  NOT = SPACES
  1252                    MOVE 'ibm' TO Config-File
  1253                WHEN  S-Cfg-MF  NOT = SPACES
  1254                    MOVE 'mf' TO Config-File
  1255                WHEN  S-Cfg-MVS  NOT = SPACES
  1256                    MOVE 'mvs' TO Config-File
  1257                WHEN OTHER
  1258                    MOVE 'default' TO Config-File
  1259            END-EVALUATE
  1260            .
  1261
  1262        212-Build-Compile-Command.
  1263 GC0909    MOVE SPACES TO Cobc-Cmd
  1264 GC0909     STRING 'cobc -std='
  1265 GC0909         TRIM(Config-File,TRAILING)
  1266 GC0909         ' '
  1267 GC0909         INTO Cobc-Cmd
  1268 GC0909         WITH POINTER I
  1269 GC0909     END-STRING
  1270            IF S-SUBROUTINE NOT = ' '
  1271                STRING '-m '
  1272                    DELIMITED SIZE INTO Cobc-Cmd
  1273                    WITH POINTER I
  1274                END-STRING
  1275            ELSE
  1276                STRING '-x '
  1277                    DELIMITED SIZE INTO Cobc-Cmd
  1278                    WITH POINTER I
  1279                END-STRING
  1280            END-IF
  1281            IF S-DEBUG NOT = ' '
  1282                STRING '-fdebugging-line '
  1283                    DELIMITED SIZE INTO Cobc-Cmd
  1284                    WITH POINTER I
  1285                END-STRING

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  1286            END-IF
  1287            IF S-NOTRUNC NOT = ' '
  1288                STRING '-fnotrunc '
  1289                    DELIMITED SIZE INTO Cobc-Cmd
  1290                    WITH POINTER I
  1291                END-STRING
  1292            END-IF
  1293            IF S-TRACEALL NOT = ' '
  1294 GC0809         STRING '-ftraceall '
  1295                    DELIMITED SIZE INTO Cobc-Cmd
  1296                    WITH POINTER I
  1297                END-STRING
  1298            END-IF
  1299            IF S-TRACE NOT = ' '
  1300                STRING '-ftrace '
  1301                    DELIMITED SIZE INTO Cobc-Cmd
  1302                    WITH POINTER I
  1303                END-STRING
  1304            END-IF
  1305
  1306 GC1010     IF S-SOURCE NOT = ' '
  1307 GC1010     OR S-XREF   NOT = ' '
  1308 GC1010         STRING '-save-temps '
  1309 GC1010             DELIMITED SIZE INTO Cobc-Cmd
  1310 GC1010             WITH POINTER I
  1311 GC1010         END-STRING
  1312 GC1010     END-IF
  1313
  1314 GC0709     IF S-EXTRA > SPACES
  1315 GC0709         STRING ' '
  1316 GC0709                TRIM(S-Extra,TRAILING)
  1317 GC0709                ' '
  1318 GC0709                DELIMITED SIZE INTO Cobc-Cmd
  1319 GC0709                WITH POINTER I
  1320 GC0709         END-STRING
  1321 GC0709     END-IF
  1322 GC0909     STRING TRIM(Prog-File-Name,TRAILING)
  1323 GC0909         DELIMITED SIZE INTO Cobc-Cmd
  1324 GC0909         WITH POINTER I
  1325 GC0909     END-STRING
  1326
  1327 DEBUG D    DISPLAY
  1328 DEBUG D        "CMD=" Cobc-Cmd
  1329 DEBUG D        UPON SYSERR
  1330 DEBUG D    END-DISPLAY
  1331            .
  1332
  1333        213-Run-Compiler.
  1334 GC0410     MOVE ' Compiling...' TO Output-Message
  1335 GC0410     DISPLAY
  1336 GC0410         Switches-Screen
  1337 GC0410     END-DISPLAY
  1338 GC0609     SET 88-Output-File-Avail TO TRUE
  1339            MOVE SPACES TO Cmd
  1340            STRING TRIM(Cobc-Cmd,TRAILING)
  1341 GC1010            ' 2> OC-Messages.TXT'

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  1342                   DELIMITED SIZE
  1343                   INTO Cmd
  1344            END-STRING
  1345            CALL 'SYSTEM'
  1346                USING TRIM(Cmd,TRAILING)
  1347            END-CALL
  1348 GC0909     IF RETURN-CODE = 0
  1349 GC0909         SET 88-Compile-OK TO TRUE
  1350 GC0909     ELSE
  1351 GC0909         SET 88-Compile-Failed TO TRUE
  1352 GC0909     END-IF
  1353 GC0909     IF 88-Compile-OK
  1354 GC0909         OPEN INPUT Cobc-Output
  1355 GC0909         READ Cobc-Output
  1356 GC0909             AT END
  1357 GC0909                 CONTINUE
  1358 GC0909             NOT AT END
  1359 GC0909                 SET 88-Compile-OK-Warn TO TRUE
  1360 GC0909         END-READ
  1361 GC0909         CLOSE Cobc-Output
  1362 GC0909     END-IF
  1363 GC0909     MOVE SPACES TO Output-Message
  1364            IF 88-Compile-OK
  1365 GC0909         MOVE ' Compilation Was Successful' TO Output-Message
  1366 GC0909         DISPLAY
  1367 GC0909             Switches-Screen
  1368 GC0909         END-DISPLAY
  1369 GC0909         CALL 'C$SLEEP'
  1370 GC0909             USING 2
  1371 GC0909         END-CALL
  1372 GC0909         MOVE SPACES TO Output-Message
  1373 GC0609         SET 88-Complete TO TRUE
  1374            ELSE
  1375 GC1010         SET 88-Compile-Failed TO TRUE
  1376 GC1010         SET 88-Complete TO TRUE
  1377 GC0909         DISPLAY
  1378 GC0909             Blank-Screen
  1379 GC0909         END-DISPLAY
  1380 GC0909         IF 88-Compile-OK-Warn
  1381 GC0909             DISPLAY ' Compilation was successful, but ' &
  1382 GC0909                     'warnings were generated:'
  1383 SCROLL*                AT LINE 24 COLUMN 1
  1384 SCROLL*                WITH SCROLL UP 1 LINE
  1385 GC0909             END-DISPLAY
  1386 GC0909         ELSE
  1387 GC0909             DISPLAY 'Compilation Failed:'
  1388 SCROLL*                AT LINE 24 COLUMN 1
  1389 SCROLL*                WITH SCROLL UP 1 LINE
  1390 GC0909             END-DISPLAY
  1391 GC0909         END-IF
  1392 GC0609         SET 88-Compile-Failed TO TRUE
  1393 GC0609         SET 88-Complete TO TRUE
  1394 GC0909         DISPLAY ' '
  1395 SCROLL*            AT LINE 24 COLUMN 1
  1396 SCROLL*            WITH SCROLL UP 1 LINE
  1397 GC0909         END-DISPLAY

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  1398 GC0909         OPEN INPUT Cobc-Output
  1399 GC0909         PERFORM FOREVER
  1400 GC0909             READ Cobc-Output AT END
  1401 GC0909                 EXIT PERFORM
  1402 GC0909             END-READ
  1403 GC0909             DISPLAY TRIM(Cobc-Output-Rec,TRAILING)
  1404 SCROLL*                AT LINE 24 COLUMN 1
  1405 SCROLL*                WITH SCROLL UP 1 LINE
  1406 GC0909             END-DISPLAY
  1407 GC0909         END-PERFORM
  1408 GC0909         CLOSE Cobc-Output
  1409 GC0909         DISPLAY ' '
  1410 SCROLL*            AT LINE 24 COLUMN 1
  1411 SCROLL*            WITH SCROLL UP 2 LINES
  1412 GC0909         END-DISPLAY
  1413 DEBUG D        NEXT SENTENCE
  1414 GC0909         DISPLAY 'Press ENTER to close:'
  1415 SCROLL*            AT LINE 24 COLUMN 1
  1416 SCROLL*            WITH SCROLL UP 1 LINE
  1417 GC0909         END-DISPLAY
  1418 GC0909         ACCEPT Dummy
  1419 GC0909             FROM CONSOLE
  1420 GC0909         END-ACCEPT
  1421 GC0909         DISPLAY
  1422 GC0909             Blank-Screen
  1423 GC0909         END-DISPLAY
  1424            END-IF
  1425 GC1010     CALL 'CBL_DELETE_FILE'
  1426 GC1010         USING 'OC-Messages.TXT'
  1427 GC1010     END-CALL
  1428 DEBUG D    DISPLAY
  1429 DEBUG D        'Deletion of OC-Messages.TXT: ' RETURN-CODE
  1430 DEBUG D        UPON SYSERR
  1431 DEBUG D    END-DISPLAY
  1432            .
  1433
  1434        219-Done.
  1435            IF 88-Compile-Failed
  1436                PERFORM 900-Terminate
  1437            END-IF
  1438            .

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  1439       /
  1440 GC0410 220-Make-Listing SECTION.
  1441 GC0410*****************************************************************
  1442 GC0410** Generate a source and/or xref listing using XREF            **
  1443 GC0410*****************************************************************
  1444 GC0410
  1445 GC0410 221-Init.
  1446 GC0410     MOVE ' Generating cross-reference listing...'
  1447 GC0410       TO Output-Message
  1448 GC0410     DISPLAY
  1449 GC0410         Switches-Screen
  1450 GC0410     END-DISPLAY
  1451 GC0410     CALL "CBL_DELETE_FILE"
  1452 GC0410         USING CONCATENATE(TRIM(Prog-Name,Trailing),".lst")
  1453 GC0410     END-CALL
  1454 GC0410     MOVE 0 TO RETURN-CODE
  1455 GC0410     .
  1456 GC0410
  1457 GC0410 213-Run-OCXref.
  1458 GC0410     MOVE SPACES TO Output-Message
  1459 GC0410     CALL 'LISTING'
  1460 GC0410         USING S-SOURCE
  1461 GC0410               S-XREF
  1462 GC0410               File-Name
  1463 GC0410         ON EXCEPTION
  1464 GC0410             MOVE ' LISTING module is not available'
  1465 GC0410               TO Output-Message
  1466 GC0410             MOVE 1 TO RETURN-CODE
  1467 GC0410     END-CALL
  1468 GC0410     IF RETURN-CODE = 0
  1469 GC0410         MOVE ' Listing generated'
  1470 GC0410           TO Output-Message
  1471 GC0410         IF OS-Windows OR OS-Cygwin
  1472 GC0410             MOVE SPACES TO Cmd
  1473 GC0410             STRING
  1474 GC0410                 'cmd /c '
  1475 GC0410                 TRIM(Prog-Name,TRAILING)
  1476 GC0410                 '.lst'
  1477 GC0410                 DELIMITED SIZE INTO Cmd
  1478 GC0410             END-STRING
  1479 GC0410             CALL 'SYSTEM'
  1480 GC0410                 USING TRIM(Cmd,TRAILING)
  1481 GC0410             END-CALL
  1482 GC0410         END-IF
  1483 GC1010         IF OS-Windows
  1484 GC1010             MOVE CONCATENATE("del ",TRIM(Prog-Name,Trailing))
  1485 GC1010               TO Cmd
  1486 GC1010         ELSE
  1487 GC1010             MOVE CONCATENATE("rm ",TRIM(Prog-Name,Trailing))
  1488 GC1010               TO Cmd
  1489 GC1010         END-IF
  1490 GC1010         CALL 'SYSTEM'
  1491 GC1010             USING CONCATENATE(TRIM(Cmd,Trailing),'.i')
  1492 GC1010         END-CALL
  1493 GC1010         CALL 'SYSTEM'
  1494 GC1010             USING CONCATENATE(TRIM(Cmd,Trailing),'.o')

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  1495 GC1010         END-CALL
  1496 GC1010         CALL 'SYSTEM'
  1497 GC1010             USING CONCATENATE(TRIM(Cmd,Trailing),'.c')
  1498 GC1010         END-CALL
  1499 GC1010         CALL 'SYSTEM'
  1500 GC1010             USING CONCATENATE(TRIM(Cmd,Trailing),'.c.h')
  1501 GC1010         END-CALL
  1502 GC1010         CALL 'SYSTEM'
  1503 GC1010             USING CONCATENATE(TRIM(Cmd,Trailing),'.c.l*.h')
  1504 GC1010         END-CALL
  1505 GC0410     ELSE
  1506 GC0410         IF Output-Message = SPACES
  1507 GC0410             MOVE ' Listing generation failed'
  1508 GC0410               TO Output-Message
  1509 GC0410         END-IF
  1510 GC0410     END-IF
  1511 GC0410     DISPLAY
  1512 GC0410         Switches-Screen
  1513 GC0410     END-DISPLAY
  1514 GC0410     CALL 'C$SLEEP'
  1515 GC0410         USING 2
  1516 GC0410     END-CALL
  1517 GC0410     .

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  1518       /
  1519        230-Run-Program SECTION.
  1520       *****************************************************************
  1521       ** Run the compiled program                                    **
  1522       *****************************************************************
  1523
  1524        232-Build-Command.
  1525 GC0909     MOVE SPACES TO Cmd
  1526 GC0909     MOVE 1 TO I
  1527            IF S-SUBROUTINE NOT = ' '
  1528            OR S-DLL NOT = ' '
  1529                STRING 'cobcrun ' DELIMITED SIZE
  1530                       INTO Cmd
  1531                       WITH POINTER I
  1532                END-STRING
  1533            END-IF
  1534            IF Prog-Folder NOT = SPACES
  1535 GC0909         IF OS-Cygwin AND Prog-Folder (2:1) = ':'
  1536 GC0909             STRING '/cygdrive/'
  1537 GC0909                 INTO Cmd
  1538 GC0909                 WITH POINTER I
  1539 GC0909             END-STRING
  1540 GC0909             STRING LOWER-CASE(Prog-Folder (1:1))
  1541 GC0909                 INTO Cmd
  1542 GC0909                 WITH POINTER I
  1543 GC0909             END-STRING
  1544 GC0909             PERFORM VARYING J FROM 3 BY 1
  1545 GC0909                       UNTIL J > LENGTH(TRIM(Prog-Folder))
  1546 GC0909                 IF Prog-Folder (J:1) = '\'
  1547 GC0909                     STRING '/'
  1548 GC0909                         INTO Cmd
  1549 GC0909                         WITH POINTER I
  1550 GC0909                     END-STRING
  1551 GC0909                 ELSE
  1552 GC0909                     STRING Prog-Folder (J:1)
  1553 GC0909                         INTO Cmd
  1554 GC0909                         WITH POINTER I
  1555 GC0909                     END-STRING
  1556 GC0909                 END-IF
  1557 GC0909             END-PERFORM
  1558 GC0909         ELSE
  1559 GC0410             STRING '"' TRIM(Prog-Folder,TRAILING)
  1560 GC0909                 INTO Cmd
  1561 GC0909                 WITH POINTER I
  1562 GC0909             END-STRING
  1563 GC0909         END-IF
  1564 GC0909         STRING Dir-Char
  1565 GC0909             INTO Cmd
  1566 GC0909             WITH POINTER I
  1567 GC0909         END-STRING
  1568 GC0909     ELSE
  1569 GC0909         IF OS-Cygwin OR OS-UNIX
  1570 GC0909             STRING './'
  1571 GC0909                 INTO Cmd
  1572 GC0909                 WITH POINTER I
  1573 GC0909             END-STRING

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  1574 GC0909         END-IF
  1575            END-IF
  1576 GC0909     STRING TRIM(Prog-Name,TRAILING)
  1577 GC0909         INTO Cmd
  1578 GC0909         WITH POINTER I
  1579 GC0909     END-STRING
  1580 GC0909     IF S-SUBROUTINE = ' '
  1581 GC0909     AND S-DLL NOT = ' '
  1582 GC0909         STRING '.exe' DELIMITED SIZE
  1583                       INTO Cmd
  1584                       WITH POINTER I
  1585                END-STRING
  1586            END-IF
  1587            IF S-ARGS NOT = SPACES
  1588 GC0809         STRING ' ' TRIM(S-ARGS,TRAILING)
  1589                    INTO Cmd
  1590                    WITH POINTER I
  1591                END-STRING
  1592            END-IF
  1593            IF OS-Unknown OR OS-Windows
  1594 GC0410         STRING '"&&pause'
  1595                    INTO Cmd
  1596                    WITH POINTER I
  1597                END-STRING
  1598            ELSE
  1599                STRING ';echo "Press ENTER to close...";read'
  1600                    INTO Cmd
  1601                    WITH POINTER I
  1602                END-STRING
  1603            END-IF
  1604            .
  1605
  1606        233-Run-Program.
  1607 GC0909     DISPLAY
  1608 GC0909         Blank-Screen
  1609 GC0909     END-DISPLAY
  1610
  1611            CALL 'SYSTEM'
  1612                USING TRIM(Cmd,TRAILING)
  1613            END-CALL
  1614            PERFORM 900-Terminate
  1615            .
  1616
  1617        239-Done.
  1618            EXIT.

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  1619       /
  1620        900-Terminate SECTION.
  1621       *****************************************************************
  1622       ** Display a message and halt the program                      **
  1623       *****************************************************************
  1624
  1625        901-Display-Message.
  1626 GC0909     IF Output-Message > SPACES
  1627 GC0909         DISPLAY
  1628 GC0909             Switches-Screen
  1629 GC0909         END-DISPLAY
  1630 GC0909         CALL 'C$SLEEP'
  1631 GC0909             USING 2
  1632 GC0909         END-CALL
  1633 GC0909     END-IF
  1634            DISPLAY
  1635                Blank-Screen
  1636            END-DISPLAY
  1637            .
  1638
  1639        909-Done.
  1640            GOBACK
  1641            .
  1642
  1643        END PROGRAM OCic.
  1644
  1645        IDENTIFICATION DIVISION.
  1646        PROGRAM-ID.  GETOSTYPE.
  1647       *****************************************************************
  1648       ** This subprogram determine the OS type the program is run-   **
  1649       ** ning under, passing that result back in RETURN-CODE as fol- **
  1650       ** lows:                                                       **
  1651       **                                                             **
  1652       ** 0:   Cannot be determined                                   **
  1653       ** 1:   Native Windows or Windows/MinGW                        **
  1654       ** 2:   Cygwin                                                 **
  1655       ** 3:   UNIX/Linux/MacOS                                       **
  1656       *****************************************************************
  1657       **  DATE  CHANGE DESCRIPTION                                   **
  1658       ** ====== ==================================================== **
  1659       ** GC0909 Initial coding.                                      **
  1660       *****************************************************************
  1661        ENVIRONMENT DIVISION.
  1662        CONFIGURATION SECTION.
  1663        REPOSITORY.
  1664            FUNCTION ALL INTRINSIC.
  1665        DATA DIVISION.
  1666        WORKING-STORAGE SECTION.
  1667        01  Env-Path                    PIC X(1024).
  1668        01  Tally                       USAGE BINARY-LONG.
  1669        PROCEDURE DIVISION.
  1670        000-Main SECTION.
  1671        010-Get-TEMP-Var.
  1672            MOVE SPACES TO Env-Path
  1673            ACCEPT Env-Path
  1674                FROM ENVIRONMENT "PATH"

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  1675                ON EXCEPTION
  1676                    MOVE 0 TO RETURN-CODE
  1677                    GOBACK
  1678            END-ACCEPT
  1679            IF Env-Path = SPACES
  1680                MOVE 0 TO RETURN-CODE
  1681            ELSE
  1682                MOVE 0 TO Tally
  1683                INSPECT Env-Path
  1684                    TALLYING Tally FOR ALL ";"
  1685                IF Tally = 0 *> Must be some form of UNIX
  1686                    MOVE 0 TO Tally
  1687                    INSPECT Env-Path
  1688                        TALLYING TALLY FOR ALL "/cygdrive/"
  1689                    IF Tally = 0 *> UNIX/MacOS
  1690                        MOVE 3 TO RETURN-CODE
  1691                    ELSE *> Cygwin
  1692                        MOVE 2 TO RETURN-CODE
  1693                    END-IF
  1694                ELSE *> Assume Windows[/MinGW]
  1695                    MOVE 1 TO RETURN-CODE
  1696                END-IF
  1697            END-IF
  1698            GOBACK
  1699            .
  1700        END PROGRAM GETOSTYPE.
  1701
  1702        IDENTIFICATION DIVISION.
  1703        PROGRAM-ID.  CHECKSOURCE.
  1704       *****************************************************************
  1705       ** This subprogram will scan a line of source code it is given **
  1706       ** looking for "LINKAGE SECTION" or "IDENTIFICATION DIVISION". **
  1707       **                                                             **
  1708       **  ****NOTE****   ****NOTE****    ****NOTE****   ****NOTE***  **
  1709       **                                                             **
  1710       ** These two strings must be found IN THEIR ENTIRETY within    **
  1711       ** the 1st 80 columns of program source records, and cannot    **
  1712       ** follow either a "*>" sequence OR a "*" in col 7.            **
  1713       *****************************************************************
  1714       **  DATE  CHANGE DESCRIPTION                                   **
  1715       ** ====== ==================================================== **
  1716       ** GC0809 Initial coding.                                      **
  1717       *****************************************************************
  1718        ENVIRONMENT DIVISION.
  1719        CONFIGURATION SECTION.
  1720        REPOSITORY.
  1721            FUNCTION ALL INTRINSIC.
  1722        DATA DIVISION.
  1723        WORKING-STORAGE SECTION.
  1724        01  Compressed-Src.
  1725            05 CS-Char                  OCCURS 80 TIMES PIC X(1).
  1726
  1727        01  Flags.
  1728            05 F-Found-SPACE            PIC X(1).
  1729               88 88-Skipping-SPACE     VALUE 'Y'.
  1730               88 88-Not-Skipping-SPACE VALUE 'N'.

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  1731
  1732        01  I                           USAGE BINARY-CHAR.
  1733
  1734        01  J                           USAGE BINARY-CHAR.
  1735        LINKAGE SECTION.
  1736        01  Argument-1.
  1737            02 A1-Char                  OCCURS 80 TIMES PIC X(1).
  1738
  1739        01  Argument-2                  PIC X(1).
  1740            88 88-A2-LINKAGE-SECTION         VALUE 'L'.
  1741            88 88-A2-IDENTIFICATION-DIVISION VALUE 'I'.
  1742            88 88-A2-Nothing-Special         VALUE ' '.
  1743        PROCEDURE DIVISION USING Argument-1, Argument-2.
  1744        000-Main SECTION.
  1745
  1746        010-Initialize.
  1747            SET 88-A2-Nothing-Special TO TRUE
  1748            IF A1-Char (7) = '*'
  1749                GOBACK
  1750            END-IF
  1751            .
  1752
  1753        020-Compress-Multiple-SPACES.
  1754            SET 88-Not-Skipping-SPACE TO TRUE
  1755            MOVE 0 TO J
  1756            MOVE SPACES TO Compressed-Src
  1757            PERFORM VARYING I FROM 1 BY 1
  1758                      UNTIL I > 80
  1759                IF A1-Char (I) = SPACE
  1760                    IF 88-Not-Skipping-SPACE
  1761                        ADD 1 TO J
  1762                        MOVE UPPER-CASE(A1-Char (I)) TO CS-Char (J)
  1763                        SET 88-Skipping-SPACE TO TRUE
  1764                    END-IF
  1765                ELSE
  1766                    SET 88-Not-Skipping-SPACE TO TRUE
  1767                    ADD 1 TO J
  1768                    MOVE A1-Char (I) TO CS-Char (J)
  1769                END-IF
  1770            END-PERFORM
  1771            .
  1772
  1773        030-Scan-Compressed-Src.
  1774            PERFORM VARYING I FROM 1 BY 1
  1775                      UNTIL I > 66
  1776                EVALUATE TRUE
  1777                    WHEN CS-Char (I) = '*'
  1778                        IF Compressed-Src (I : 2) = '*>'
  1779                            GOBACK
  1780                        END-IF
  1781                    WHEN (CS-Char (I) = 'L') AND (I < 66)
  1782                        IF Compressed-Src (I : 15) = 'LINKAGE SECTION'
  1783                            SET 88-A2-LINKAGE-SECTION TO TRUE
  1784                            GOBACK
  1785                        END-IF
  1786                    WHEN (CS-Char (I) = 'I') AND (I < 58)

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  1787                        IF Compressed-Src (I : 23) = 'IDENTIFICATION ' &
  1788                                                        'DIVISION'
  1789                            SET 88-A2-IDENTIFICATION-DIVISION TO TRUE
  1790                            GOBACK
  1791                        END-IF
  1792                END-EVALUATE
  1793            END-PERFORM
  1794            .
  1795
  1796        099-Never-Found-Either-One.
  1797            GOBACK
  1798            .
  1799        END PROGRAM CHECKSOURCE.
  1800
  1801        IDENTIFICATION DIVISION.
  1802        PROGRAM-ID.  LISTING.
  1803       *****************************************************************
  1804       ** This subprogram generates a cross-reference listing of an   **
  1805       ** OpenCOBOL program.                                          **
  1806       **                                                             **
  1807       ** Linkage:      CALL "LISTING" USING <source>                 **
  1808       **                                    <xref>                   **
  1809       **                                    <filename>               **
  1810       **                                                             **
  1811       **               Where:                                        **
  1812       **                  <source>   is a PIC X(1) flag indicating   **
  1813       **                             whether or not a source listing **
  1814       **                             should be produced (space=NO,   **
  1815       **                             non-space=yes)                  **
  1816       **                  <xref>     is a PIC X(1) flag indicating   **
  1817       **                             whether or not an xref listing  **
  1818       **                             should be produced (space=NO,   **
  1819       **                             non-space=yes)                  **
  1820       **                  <filename> is the [path]filename of the    **
  1821       **                             program being listed and/or     **
  1822       **                             xreffed in a PIC X(256) form.   **
  1823       *****************************************************************
  1824       **                                                             **
  1825       ** AUTHOR:       GARY L. CUTLER                                **
  1826       **               CutlerGL@gmail.com                            **
  1827       **               Copyright (C) 2010, Gary L. Cutler, GPL       **
  1828       **                                                             **
  1829       ** DATE-WRITTEN: April 1, 2010                                 **
  1830       **                                                             **
  1831       *****************************************************************
  1832       **  DATE  CHANGE DESCRIPTION                                   **
  1833       ** ====== ==================================================== **
  1834       ** GC0410 Initial coding                                       **
  1835       ** GC0710 Handle duplicate data names (i.e. "CORRESPONDING" or **
  1836       **        qualified items) better; ignore "END PROGRAM" recs   **
  1837       **        so program name doesn't appear in listing.           **
  1838       *****************************************************************
  1839        ENVIRONMENT DIVISION.
  1840        CONFIGURATION SECTION.
  1841        REPOSITORY.
  1842            FUNCTION ALL INTRINSIC.

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  1843        INPUT-OUTPUT SECTION.
  1844        FILE-CONTROL.
  1845            SELECT Expand-Code          ASSIGN TO Expanded-Src-Filename
  1846                                        ORGANIZATION IS LINE SEQUENTIAL.
  1847            SELECT Report-File          ASSIGN TO Report-Filename
  1848                                        ORGANIZATION IS LINE SEQUENTIAL.
  1849            SELECT Sort-File            ASSIGN TO DISK.
  1850            SELECT Source-Code          ASSIGN TO Src-Filename
  1851                                        ORGANIZATION IS LINE SEQUENTIAL.
  1852        DATA DIVISION.
  1853        FILE SECTION.
  1854        FD  Expand-Code.
  1855        01  Expand-Code-Rec.
  1856            05 ECR-1                    PIC X.
  1857            05 ECR-2-256                PIC X(256).
  1858        01  Expand-Code-Rec-Alt.
  1859            05 ECR-1-128                PIC X(128).
  1860            05 ECR-129-256              PIC X(128).
  1861
  1862        FD  Report-File.
  1863        01  Report-Rec                  PIC X(135).
  1864
  1865        SD  Sort-File.
  1866        01  Sort-Rec.
  1867            05 SR-Prog-ID               PIC X(15).
  1868            05 SR-Token-UC              PIC X(32).
  1869            05 SR-Token                 PIC X(32).
  1870            05 SR-Section               PIC X(15).
  1871            05 SR-Line-No-Def           PIC 9(6).
  1872            05 SR-Reference.
  1873               10 SR-Line-No-Ref        PIC 9(6).
  1874               10 SR-Ref-Flag           PIC X(1).
  1875
  1876        FD  Source-Code.
  1877        01  Source-Code-Rec.
  1878 GC0410     05 SCR-1-128.
  1879 GC0410        10 FILLER                PIC X(6).
  1880 GC0410        10 SCR-7                 PIC X(1).
  1881 GC0410        10 FILLER                PIC X(121).
  1882            05 SCR-129-256              PIC X(128).
  1883
  1884        WORKING-STORAGE SECTION.
  1885        78  Line-Nos-Per-Rec            VALUE 8.
  1886
  1887        01  Cmd                         PIC X(256).
  1888
  1889        01  Delim                       PIC X(2).
  1890
  1891        01  Detail-Line-S.
  1892            05 DLS-Line-No              PIC ZZZZZ9.
  1893            05 FILLER                   PIC X(1).
  1894            05 DLS-Statement            PIC X(128).
  1895
  1896        01  Detail-Line-X.
  1897            05 DLX-Prog-ID              PIC X(15).
  1898            05 FILLER                   PIC X(1).

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  1899            05 DLX-Token                PIC X(32).
  1900            05 FILLER                   PIC X(1).
  1901            05 DLX-Line-No-Def          PIC ZZZZZ9.
  1902            05 FILLER                   PIC X(1).
  1903            05 DLX-Section              PIC X(15).
  1904            05 FILLER                   PIC X(1).
  1905            05 DLX-Reference            OCCURS Line-Nos-Per-Rec TIMES.
  1906               10 DLX-Line-No-Ref       PIC ZZZZZ9.
  1907               10 DLX-Ref-Flag          PIC X(1).
  1908               10 FILLER                PIC X(1).
  1909
  1910        01  Dummy                       PIC X(1).
  1911
  1912        01  Expanded-Src-Filename       PIC X(256).
  1913
  1914        01  Filename                    PIC X(256).
  1915
  1916        01  Flags.
  1917 GC0710     05 F-Duplicate              PIC X(1).
  1918            05 F-First-Record           PIC X(1).
  1919            05 F-In-Which-Pgm           PIC X(1).
  1920               88 In-Main-Module        VALUE 'M'.
  1921               88 In-Copybook           VALUE 'C'.
  1922            05 F-Last-Token-Ended-Sent  PIC X(1).
  1923            05 F-Processing-PICTURE     PIC X(1).
  1924            05 F-Token-Ended-Sentence   PIC X(1).
  1925 GC0710     05 F-Verb-Has-Been-Found    PIC X(1).
  1926
  1927        01  Group-Indicators.
  1928            05 GI-Prog-ID               PIC X(15).
  1929            05 GI-Token                 PIC X(32).
  1930
  1931        01  Heading-1S.
  1932            05 FILLER                   PIC X(125) VALUE
  1933               "OpenCOBOL 1.1 06FEB2009 Source Listing - " &
  1934               "OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL".
  1935            05 H1S-Date                 PIC 9999/99/99.
  1936
  1937        01  Heading-1X.
  1938            05 FILLER                   PIC X(125) VALUE
  1939               "OpenCOBOL 1.1 06FEB2009 Cross-Reference Listing - " &
  1940               "OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL".
  1941            05 H1X-Date                 PIC 9999/99/99.
  1942
  1943        01  Heading-2                   PIC X(135).
  1944
  1945        01  Heading-4S                  PIC X(16) VALUE
  1946            "Line   Statement".
  1947
  1948        01  Heading-4X                  PIC X(96) VALUE
  1949            "PROGRAM-ID      Identifier/Register/Function     Defn   Wher
  1950       -    "e Defined   References (* = Updated)".
  1951
  1952        01  Heading-5S                  PIC X(135) VALUE
  1953            "====== =====================================================
  1954       -    "============================================================

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  1955       -    "===============".
  1956
  1957        01  Heading-5X                  PIC X(135) VALUE
  1958            "=============== ================================ ====== ====
  1959       -    "=========== ================================================
  1960       -    "===============".
  1961
  1962        01  Held-Reference              PIC X(100).
  1963
  1964        01  I                           USAGE BINARY-LONG.
  1965
  1966        01  J                           USAGE BINARY-LONG.
  1967
  1968        01  Lines-Left                  USAGE BINARY-LONG.
  1969
  1970        01  Lines-Per-Page              USAGE BINARY-LONG.
  1971
  1972        01  Lines-Per-Page-ENV          PIC X(256).
  1973
  1974 GC1010 01  Main-Module-Name            PIC X(256).
  1975
  1976        01  Num-UserNames               USAGE BINARY-LONG.
  1977
  1978        01  PIC-X10                     PIC X(10).
  1979
  1980        01  PIC-X32                     PIC X(32).
  1981
  1982        01  PIC-X256                    PIC X(256).
  1983
  1984        01  Program-Path                PIC X(256).
  1985
  1986        01  Report-Filename             PIC X(256).
  1987
  1988        01  Reserved-Words.
  1989            05 FILLER PIC X(33) VALUE "IABS".
  1990            05 FILLER PIC X(33) VALUE "VACCEPT".
  1991            05 FILLER PIC X(33) VALUE " ACCESS".
  1992            05 FILLER PIC X(33) VALUE "IACOS".
  1993            05 FILLER PIC X(33) VALUE " ACTIVE-CLASS".
  1994            05 FILLER PIC X(33) VALUE "VADD".
  1995            05 FILLER PIC X(33) VALUE " ADDRESS".
  1996            05 FILLER PIC X(33) VALUE " ADVANCING".
  1997            05 FILLER PIC X(33) VALUE "KAFTER".
  1998            05 FILLER PIC X(33) VALUE " ALIGNED".
  1999            05 FILLER PIC X(33) VALUE " ALL".
  2000            05 FILLER PIC X(33) VALUE "VALLOCATE".
  2001            05 FILLER PIC X(33) VALUE " ALPHABET".
  2002            05 FILLER PIC X(33) VALUE " ALPHABETIC".
  2003            05 FILLER PIC X(33) VALUE " ALPHABETIC-LOWER".
  2004            05 FILLER PIC X(33) VALUE " ALPHABETIC-UPPER".
  2005            05 FILLER PIC X(33) VALUE " ALPHANUMERIC".
  2006            05 FILLER PIC X(33) VALUE " ALPHANUMERIC-EDITED".
  2007            05 FILLER PIC X(33) VALUE " ALSO".
  2008            05 FILLER PIC X(33) VALUE "VALTER".
  2009            05 FILLER PIC X(33) VALUE " ALTERNATE".
  2010            05 FILLER PIC X(33) VALUE " AND".

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  2011            05 FILLER PIC X(33) VALUE "IANNUITY".
  2012            05 FILLER PIC X(33) VALUE " ANY".
  2013            05 FILLER PIC X(33) VALUE " ANYCASE".
  2014            05 FILLER PIC X(33) VALUE " ARE".
  2015            05 FILLER PIC X(33) VALUE " AREA".
  2016            05 FILLER PIC X(33) VALUE " AREAS".
  2017            05 FILLER PIC X(33) VALUE " ARGUMENT-NUMBER".
  2018            05 FILLER PIC X(33) VALUE " ARGUMENT-VALUE".
  2019            05 FILLER PIC X(33) VALUE " AS".
  2020            05 FILLER PIC X(33) VALUE " ASCENDING".
  2021            05 FILLER PIC X(33) VALUE "IASIN".
  2022            05 FILLER PIC X(33) VALUE " ASSIGN".
  2023            05 FILLER PIC X(33) VALUE " AT".
  2024            05 FILLER PIC X(33) VALUE "IATAN".
  2025            05 FILLER PIC X(33) VALUE " AUTHOR".
  2026            05 FILLER PIC X(33) VALUE " AUTO".
  2027            05 FILLER PIC X(33) VALUE " AUTO-SKIP".
  2028            05 FILLER PIC X(33) VALUE " AUTOMATIC".
  2029            05 FILLER PIC X(33) VALUE " AUTOTERMINATE".
  2030            05 FILLER PIC X(33) VALUE " BACKGROUND-COLOR".
  2031            05 FILLER PIC X(33) VALUE " BASED".
  2032            05 FILLER PIC X(33) VALUE " BEEP".
  2033            05 FILLER PIC X(33) VALUE " BEFORE".
  2034            05 FILLER PIC X(33) VALUE " BELL".
  2035            05 FILLER PIC X(33) VALUE " BINARY".
  2036            05 FILLER PIC X(33) VALUE " BINARY-C-LONG".
  2037            05 FILLER PIC X(33) VALUE " BINARY-CHAR".
  2038            05 FILLER PIC X(33) VALUE " BINARY-DOUBLE".
  2039            05 FILLER PIC X(33) VALUE " BINARY-LONG".
  2040            05 FILLER PIC X(33) VALUE " BINARY-SHORT".
  2041            05 FILLER PIC X(33) VALUE " BIT".
  2042            05 FILLER PIC X(33) VALUE " BLANK".
  2043            05 FILLER PIC X(33) VALUE " BLINK".
  2044            05 FILLER PIC X(33) VALUE " BLOCK".
  2045            05 FILLER PIC X(33) VALUE " BOOLEAN".
  2046            05 FILLER PIC X(33) VALUE " BOTTOM".
  2047            05 FILLER PIC X(33) VALUE "YBY".
  2048            05 FILLER PIC X(33) VALUE "IBYTE-LENGTH".
  2049            05 FILLER PIC X(33) VALUE "MC01".
  2050            05 FILLER PIC X(33) VALUE "MC02".
  2051            05 FILLER PIC X(33) VALUE "MC03".
  2052            05 FILLER PIC X(33) VALUE "MC04".
  2053            05 FILLER PIC X(33) VALUE "MC05".
  2054            05 FILLER PIC X(33) VALUE "MC06".
  2055            05 FILLER PIC X(33) VALUE "MC07".
  2056            05 FILLER PIC X(33) VALUE "MC08".
  2057            05 FILLER PIC X(33) VALUE "MC09".
  2058            05 FILLER PIC X(33) VALUE "MC10".
  2059            05 FILLER PIC X(33) VALUE "MC11".
  2060            05 FILLER PIC X(33) VALUE "MC12".
  2061            05 FILLER PIC X(33) VALUE "VCALL".
  2062            05 FILLER PIC X(33) VALUE "VCANCEL".
  2063            05 FILLER PIC X(33) VALUE " CF".
  2064            05 FILLER PIC X(33) VALUE " CH".
  2065            05 FILLER PIC X(33) VALUE " CHAINING".
  2066            05 FILLER PIC X(33) VALUE "ICHAR".

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  2067            05 FILLER PIC X(33) VALUE " CHARACTER".
  2068            05 FILLER PIC X(33) VALUE " CHARACTERS".
  2069            05 FILLER PIC X(33) VALUE " CLASS".
  2070            05 FILLER PIC X(33) VALUE " CLASS-ID".
  2071            05 FILLER PIC X(33) VALUE "VCLOSE".
  2072            05 FILLER PIC X(33) VALUE "ICOB-CRT-STATUS".
  2073            05 FILLER PIC X(33) VALUE " CODE".
  2074            05 FILLER PIC X(33) VALUE " CODE-SET".
  2075            05 FILLER PIC X(33) VALUE " COL".
  2076            05 FILLER PIC X(33) VALUE " COLLATING".
  2077            05 FILLER PIC X(33) VALUE " COLS".
  2078            05 FILLER PIC X(33) VALUE " COLUMN".
  2079            05 FILLER PIC X(33) VALUE " COLUMNS".
  2080            05 FILLER PIC X(33) VALUE "ICOMBINED-DATETIME".
  2081            05 FILLER PIC X(33) VALUE " COMMA".
  2082            05 FILLER PIC X(33) VALUE " COMMAND-LINE".
  2083            05 FILLER PIC X(33) VALUE "VCOMMIT".
  2084            05 FILLER PIC X(33) VALUE " COMMON".
  2085            05 FILLER PIC X(33) VALUE " COMP".
  2086            05 FILLER PIC X(33) VALUE " COMP-1".
  2087            05 FILLER PIC X(33) VALUE " COMP-2".
  2088            05 FILLER PIC X(33) VALUE " COMP-3".
  2089            05 FILLER PIC X(33) VALUE " COMP-4".
  2090            05 FILLER PIC X(33) VALUE " COMP-5".
  2091            05 FILLER PIC X(33) VALUE " COMP-X".
  2092            05 FILLER PIC X(33) VALUE " COMPUTATIONAL".
  2093            05 FILLER PIC X(33) VALUE " COMPUTATIONAL-1".
  2094            05 FILLER PIC X(33) VALUE " COMPUTATIONAL-2".
  2095            05 FILLER PIC X(33) VALUE " COMPUTATIONAL-3".
  2096            05 FILLER PIC X(33) VALUE " COMPUTATIONAL-4".
  2097            05 FILLER PIC X(33) VALUE " COMPUTATIONAL-5".
  2098            05 FILLER PIC X(33) VALUE " COMPUTATIONAL-X".
  2099            05 FILLER PIC X(33) VALUE "VCOMPUTE".
  2100            05 FILLER PIC X(33) VALUE "ICONCATENATE".
  2101            05 FILLER PIC X(33) VALUE " CONDITION".
  2102            05 FILLER PIC X(33) VALUE "KCONFIGURATION".
  2103            05 FILLER PIC X(33) VALUE "MCONSOLE".
  2104            05 FILLER PIC X(33) VALUE " CONSTANT".
  2105            05 FILLER PIC X(33) VALUE " CONTAINS".
  2106            05 FILLER PIC X(33) VALUE " CONTENT".
  2107            05 FILLER PIC X(33) VALUE "VCONTINUE".
  2108            05 FILLER PIC X(33) VALUE " CONTROL".
  2109            05 FILLER PIC X(33) VALUE " CONTROLS".
  2110            05 FILLER PIC X(33) VALUE "KCONVERTING".
  2111            05 FILLER PIC X(33) VALUE " COPY".
  2112            05 FILLER PIC X(33) VALUE " CORR".
  2113            05 FILLER PIC X(33) VALUE " CORRESPONDING".
  2114            05 FILLER PIC X(33) VALUE "ICOS".
  2115            05 FILLER PIC X(33) VALUE "KCOUNT".
  2116            05 FILLER PIC X(33) VALUE " CRT".
  2117            05 FILLER PIC X(33) VALUE " CURRENCY".
  2118            05 FILLER PIC X(33) VALUE "ICURRENT-DATE".
  2119            05 FILLER PIC X(33) VALUE " CURSOR".
  2120            05 FILLER PIC X(33) VALUE " CYCLE".
  2121            05 FILLER PIC X(33) VALUE "KDATA".
  2122            05 FILLER PIC X(33) VALUE " DATA-POINTER".

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  2123            05 FILLER PIC X(33) VALUE " DATE".
  2124            05 FILLER PIC X(33) VALUE " DATE-COMPILED".
  2125            05 FILLER PIC X(33) VALUE " DATE-MODIFIED".
  2126            05 FILLER PIC X(33) VALUE "IDATE-OF-INTEGER".
  2127            05 FILLER PIC X(33) VALUE "IDATE-TO-YYYYMMDD".
  2128            05 FILLER PIC X(33) VALUE " DATE-WRITTEN".
  2129            05 FILLER PIC X(33) VALUE " DAY".
  2130            05 FILLER PIC X(33) VALUE "IDAY-OF-INTEGER".
  2131            05 FILLER PIC X(33) VALUE " DAY-OF-WEEK".
  2132            05 FILLER PIC X(33) VALUE "IDAY-TO-YYYYDDD".
  2133            05 FILLER PIC X(33) VALUE " DE".
  2134            05 FILLER PIC X(33) VALUE " DEBUGGING".
  2135            05 FILLER PIC X(33) VALUE " DECIMAL-POINT".
  2136            05 FILLER PIC X(33) VALUE " DECLARATIVES".
  2137            05 FILLER PIC X(33) VALUE " DEFAULT".
  2138            05 FILLER PIC X(33) VALUE "VDELETE".
  2139            05 FILLER PIC X(33) VALUE " DELIMITED".
  2140            05 FILLER PIC X(33) VALUE "KDELIMITER".
  2141            05 FILLER PIC X(33) VALUE " DEPENDING".
  2142            05 FILLER PIC X(33) VALUE " DESCENDING".
  2143            05 FILLER PIC X(33) VALUE " DESTINATION".
  2144            05 FILLER PIC X(33) VALUE " DETAIL".
  2145            05 FILLER PIC X(33) VALUE " DISABLE".
  2146            05 FILLER PIC X(33) VALUE " DISK".
  2147            05 FILLER PIC X(33) VALUE "VDISPLAY".
  2148            05 FILLER PIC X(33) VALUE "VDIVIDE".
  2149            05 FILLER PIC X(33) VALUE "KDIVISION".
  2150            05 FILLER PIC X(33) VALUE "KDOWN".
  2151            05 FILLER PIC X(33) VALUE " DUPLICATES".
  2152            05 FILLER PIC X(33) VALUE " DYNAMIC".
  2153            05 FILLER PIC X(33) VALUE "IE".
  2154            05 FILLER PIC X(33) VALUE " EBCDIC".
  2155            05 FILLER PIC X(33) VALUE " EC".
  2156            05 FILLER PIC X(33) VALUE "VELSE".
  2157 GC0710     05 FILLER PIC X(33) VALUE "KEND".
  2158            05 FILLER PIC X(33) VALUE " END-ACCEPT".
  2159            05 FILLER PIC X(33) VALUE " END-ADD".
  2160            05 FILLER PIC X(33) VALUE " END-CALL".
  2161            05 FILLER PIC X(33) VALUE " END-COMPUTE".
  2162            05 FILLER PIC X(33) VALUE " END-DELETE".
  2163            05 FILLER PIC X(33) VALUE " END-DISPLAY".
  2164            05 FILLER PIC X(33) VALUE " END-DIVIDE".
  2165            05 FILLER PIC X(33) VALUE " END-EVALUATE".
  2166            05 FILLER PIC X(33) VALUE " END-IF".
  2167            05 FILLER PIC X(33) VALUE " END-MULTIPLY".
  2168            05 FILLER PIC X(33) VALUE " END-OF-PAGE".
  2169            05 FILLER PIC X(33) VALUE " END-PERFORM".
  2170            05 FILLER PIC X(33) VALUE " END-READ".
  2171            05 FILLER PIC X(33) VALUE " END-RETURN".
  2172            05 FILLER PIC X(33) VALUE " END-REWRITE".
  2173            05 FILLER PIC X(33) VALUE " END-SEARCH".
  2174            05 FILLER PIC X(33) VALUE " END-START".
  2175            05 FILLER PIC X(33) VALUE " END-STRING".
  2176            05 FILLER PIC X(33) VALUE " END-SUBTRACT".
  2177            05 FILLER PIC X(33) VALUE " END-UNSTRING".
  2178            05 FILLER PIC X(33) VALUE " END-WRITE".

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  2179            05 FILLER PIC X(33) VALUE "VENTRY".
  2180            05 FILLER PIC X(33) VALUE "KENVIRONMENT".
  2181            05 FILLER PIC X(33) VALUE " ENVIRONMENT-NAME".
  2182            05 FILLER PIC X(33) VALUE " ENVIRONMENT-VALUE".
  2183            05 FILLER PIC X(33) VALUE " EO".
  2184            05 FILLER PIC X(33) VALUE " EOL".
  2185            05 FILLER PIC X(33) VALUE " EOP".
  2186            05 FILLER PIC X(33) VALUE " EOS".
  2187            05 FILLER PIC X(33) VALUE " EQUAL".
  2188            05 FILLER PIC X(33) VALUE "KEQUALS".
  2189            05 FILLER PIC X(33) VALUE " ERASE".
  2190            05 FILLER PIC X(33) VALUE " ERROR".
  2191            05 FILLER PIC X(33) VALUE " ESCAPE".
  2192            05 FILLER PIC X(33) VALUE "VEVALUATE".
  2193            05 FILLER PIC X(33) VALUE " EXCEPTION".
  2194            05 FILLER PIC X(33) VALUE "IEXCEPTION-FILE".
  2195            05 FILLER PIC X(33) VALUE "IEXCEPTION-LOCATION".
  2196            05 FILLER PIC X(33) VALUE " EXCEPTION-OBJECT".
  2197            05 FILLER PIC X(33) VALUE "IEXCEPTION-STATEMENT".
  2198            05 FILLER PIC X(33) VALUE "IEXCEPTION-STATUS".
  2199            05 FILLER PIC X(33) VALUE " EXCLUSIVE".
  2200            05 FILLER PIC X(33) VALUE "VEXIT".
  2201            05 FILLER PIC X(33) VALUE "IEXP".
  2202            05 FILLER PIC X(33) VALUE "IEXP10".
  2203            05 FILLER PIC X(33) VALUE " EXTEND".
  2204            05 FILLER PIC X(33) VALUE " EXTERNAL".
  2205            05 FILLER PIC X(33) VALUE "IFACTORIAL".
  2206            05 FILLER PIC X(33) VALUE " FACTORY".
  2207            05 FILLER PIC X(33) VALUE " FALSE".
  2208            05 FILLER PIC X(33) VALUE "KFD".
  2209            05 FILLER PIC X(33) VALUE "KFILE".
  2210            05 FILLER PIC X(33) VALUE " FILE-CONTROL".
  2211            05 FILLER PIC X(33) VALUE " FILE-ID".
  2212            05 FILLER PIC X(33) VALUE " FILLER".
  2213            05 FILLER PIC X(33) VALUE " FINAL".
  2214            05 FILLER PIC X(33) VALUE " FIRST".
  2215            05 FILLER PIC X(33) VALUE " FLOAT-BINARY-16".
  2216            05 FILLER PIC X(33) VALUE " FLOAT-BINARY-34".
  2217            05 FILLER PIC X(33) VALUE " FLOAT-BINARY-7".
  2218            05 FILLER PIC X(33) VALUE " FLOAT-DECIMAL-16".
  2219            05 FILLER PIC X(33) VALUE " FLOAT-DECIMAL-34".
  2220            05 FILLER PIC X(33) VALUE " FLOAT-EXTENDED".
  2221            05 FILLER PIC X(33) VALUE " FLOAT-LONG".
  2222            05 FILLER PIC X(33) VALUE " FLOAT-SHORT".
  2223            05 FILLER PIC X(33) VALUE " FOOTING".
  2224            05 FILLER PIC X(33) VALUE " FOR".
  2225            05 FILLER PIC X(33) VALUE " FOREGROUND-COLOR".
  2226            05 FILLER PIC X(33) VALUE " FOREVER".
  2227            05 FILLER PIC X(33) VALUE " FORMAT".
  2228            05 FILLER PIC X(33) VALUE "MFORMFEED".
  2229            05 FILLER PIC X(33) VALUE "IFRACTION-PART".
  2230            05 FILLER PIC X(33) VALUE "VFREE".
  2231            05 FILLER PIC X(33) VALUE " FROM".
  2232            05 FILLER PIC X(33) VALUE " FULL".
  2233            05 FILLER PIC X(33) VALUE " FUNCTION".
  2234            05 FILLER PIC X(33) VALUE " FUNCTION-ID".

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  2235            05 FILLER PIC X(33) VALUE " FUNCTION-POINTER".
  2236            05 FILLER PIC X(33) VALUE "VGENERATE".
  2237            05 FILLER PIC X(33) VALUE " GET".
  2238            05 FILLER PIC X(33) VALUE "KGIVING".
  2239            05 FILLER PIC X(33) VALUE " GLOBAL".
  2240            05 FILLER PIC X(33) VALUE "VGO".
  2241            05 FILLER PIC X(33) VALUE "VGOBACK".
  2242            05 FILLER PIC X(33) VALUE " GREATER".
  2243            05 FILLER PIC X(33) VALUE " GROUP".
  2244            05 FILLER PIC X(33) VALUE " GROUP-USAGE".
  2245            05 FILLER PIC X(33) VALUE " HEADING".
  2246            05 FILLER PIC X(33) VALUE " HIGH-VALUE".
  2247            05 FILLER PIC X(33) VALUE " HIGH-VALUES".
  2248            05 FILLER PIC X(33) VALUE " HIGHLIGHT".
  2249            05 FILLER PIC X(33) VALUE " I-O".
  2250            05 FILLER PIC X(33) VALUE " I-O-CONTROL".
  2251            05 FILLER PIC X(33) VALUE "KID".
  2252            05 FILLER PIC X(33) VALUE "KIDENTIFICATION".
  2253            05 FILLER PIC X(33) VALUE "VIF".
  2254            05 FILLER PIC X(33) VALUE " IGNORE".
  2255            05 FILLER PIC X(33) VALUE " IGNORING".
  2256            05 FILLER PIC X(33) VALUE " IN".
  2257            05 FILLER PIC X(33) VALUE " INDEX".
  2258            05 FILLER PIC X(33) VALUE "KINDEXED".
  2259            05 FILLER PIC X(33) VALUE " INDICATE".
  2260            05 FILLER PIC X(33) VALUE " INFINITY".
  2261            05 FILLER PIC X(33) VALUE " INHERITS".
  2262            05 FILLER PIC X(33) VALUE " INITIAL".
  2263            05 FILLER PIC X(33) VALUE " INITIALISED".
  2264            05 FILLER PIC X(33) VALUE "VINITIALIZE".
  2265            05 FILLER PIC X(33) VALUE " INITIALIZED".
  2266            05 FILLER PIC X(33) VALUE "VINITIATE".
  2267            05 FILLER PIC X(33) VALUE " INPUT".
  2268            05 FILLER PIC X(33) VALUE "KINPUT-OUTPUT".
  2269            05 FILLER PIC X(33) VALUE "VINSPECT".
  2270            05 FILLER PIC X(33) VALUE " INSTALLATION".
  2271            05 FILLER PIC X(33) VALUE "IINTEGER".
  2272            05 FILLER PIC X(33) VALUE "IINTEGER-OF-DATE".
  2273            05 FILLER PIC X(33) VALUE "IINTEGER-OF-DAY".
  2274            05 FILLER PIC X(33) VALUE "IINTEGER-PART".
  2275            05 FILLER PIC X(33) VALUE " INTERFACE".
  2276            05 FILLER PIC X(33) VALUE " INTERFACE-ID".
  2277            05 FILLER PIC X(33) VALUE "KINTO".
  2278            05 FILLER PIC X(33) VALUE " INTRINSIC".
  2279            05 FILLER PIC X(33) VALUE " INVALID".
  2280            05 FILLER PIC X(33) VALUE " INVOKE".
  2281            05 FILLER PIC X(33) VALUE " IS".
  2282            05 FILLER PIC X(33) VALUE " JUST".
  2283            05 FILLER PIC X(33) VALUE " JUSTIFIED".
  2284            05 FILLER PIC X(33) VALUE " KEY".
  2285            05 FILLER PIC X(33) VALUE " LABEL".
  2286            05 FILLER PIC X(33) VALUE " LAST".
  2287            05 FILLER PIC X(33) VALUE " LEADING".
  2288            05 FILLER PIC X(33) VALUE " LEFT".
  2289            05 FILLER PIC X(33) VALUE " LEFT-JUSTIFY".
  2290            05 FILLER PIC X(33) VALUE "ILENGTH".

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  2291            05 FILLER PIC X(33) VALUE " LESS".
  2292            05 FILLER PIC X(33) VALUE " LIMIT".
  2293            05 FILLER PIC X(33) VALUE " LIMITS".
  2294            05 FILLER PIC X(33) VALUE " LINAGE".
  2295            05 FILLER PIC X(33) VALUE "ILINAGE-COUNTER".
  2296            05 FILLER PIC X(33) VALUE " LINE".
  2297            05 FILLER PIC X(33) VALUE " LINE-COUNTER".
  2298            05 FILLER PIC X(33) VALUE " LINES".
  2299            05 FILLER PIC X(33) VALUE "KLINKAGE".
  2300            05 FILLER PIC X(33) VALUE "KLOCAL-STORAGE".
  2301            05 FILLER PIC X(33) VALUE " LOCALE".
  2302            05 FILLER PIC X(33) VALUE "ILOCALE-DATE".
  2303            05 FILLER PIC X(33) VALUE "ILOCALE-TIME".
  2304            05 FILLER PIC X(33) VALUE "ILOCALE-TIME-FROM-SECONDS".
  2305            05 FILLER PIC X(33) VALUE " LOCK".
  2306            05 FILLER PIC X(33) VALUE "ILOG".
  2307            05 FILLER PIC X(33) VALUE "ILOG10".
  2308            05 FILLER PIC X(33) VALUE " LOW-VALUE".
  2309            05 FILLER PIC X(33) VALUE " LOW-VALUES".
  2310            05 FILLER PIC X(33) VALUE " LOWER".
  2311            05 FILLER PIC X(33) VALUE "ILOWER-CASE".
  2312            05 FILLER PIC X(33) VALUE " LOWLIGHT".
  2313            05 FILLER PIC X(33) VALUE " MANUAL".
  2314            05 FILLER PIC X(33) VALUE "IMAX".
  2315            05 FILLER PIC X(33) VALUE "IMEAN".
  2316            05 FILLER PIC X(33) VALUE "IMEDIAN".
  2317            05 FILLER PIC X(33) VALUE " MEMORY".
  2318            05 FILLER PIC X(33) VALUE "VMERGE".
  2319            05 FILLER PIC X(33) VALUE " METHOD".
  2320            05 FILLER PIC X(33) VALUE " METHOD-ID".
  2321            05 FILLER PIC X(33) VALUE "IMIDRANGE".
  2322            05 FILLER PIC X(33) VALUE "IMIN".
  2323            05 FILLER PIC X(33) VALUE " MINUS".
  2324            05 FILLER PIC X(33) VALUE "IMOD".
  2325            05 FILLER PIC X(33) VALUE " MODE".
  2326            05 FILLER PIC X(33) VALUE "VMOVE".
  2327            05 FILLER PIC X(33) VALUE " MULTIPLE".
  2328            05 FILLER PIC X(33) VALUE "VMULTIPLY".
  2329            05 FILLER PIC X(33) VALUE " NATIONAL".
  2330            05 FILLER PIC X(33) VALUE " NATIONAL-EDITED".
  2331            05 FILLER PIC X(33) VALUE " NATIVE".
  2332            05 FILLER PIC X(33) VALUE " NEGATIVE".
  2333            05 FILLER PIC X(33) VALUE " NESTED".
  2334            05 FILLER PIC X(33) VALUE "VNEXT".
  2335            05 FILLER PIC X(33) VALUE " NO".
  2336            05 FILLER PIC X(33) VALUE " NOT".
  2337            05 FILLER PIC X(33) VALUE " NULL".
  2338            05 FILLER PIC X(33) VALUE " NULLS".
  2339            05 FILLER PIC X(33) VALUE " NUMBER".
  2340            05 FILLER PIC X(33) VALUE "INUMBER-OF-CALL-PARAMETERS".
  2341            05 FILLER PIC X(33) VALUE " NUMBERS".
  2342            05 FILLER PIC X(33) VALUE " NUMERIC".
  2343            05 FILLER PIC X(33) VALUE " NUMERIC-EDITED".
  2344            05 FILLER PIC X(33) VALUE "INUMVAL".
  2345            05 FILLER PIC X(33) VALUE "INUMVAL-C".
  2346            05 FILLER PIC X(33) VALUE " OBJECT".

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  2347            05 FILLER PIC X(33) VALUE " OBJECT-COMPUTER".
  2348            05 FILLER PIC X(33) VALUE " OBJECT-REFERENCE".
  2349            05 FILLER PIC X(33) VALUE " OCCURS".
  2350            05 FILLER PIC X(33) VALUE " OF".
  2351            05 FILLER PIC X(33) VALUE " OFF".
  2352            05 FILLER PIC X(33) VALUE " OMITTED".
  2353            05 FILLER PIC X(33) VALUE " ON".
  2354            05 FILLER PIC X(33) VALUE " ONLY".
  2355            05 FILLER PIC X(33) VALUE "VOPEN".
  2356            05 FILLER PIC X(33) VALUE " OPTIONAL".
  2357            05 FILLER PIC X(33) VALUE " OPTIONS".
  2358            05 FILLER PIC X(33) VALUE " OR".
  2359            05 FILLER PIC X(33) VALUE "IORD".
  2360            05 FILLER PIC X(33) VALUE "IORD-MAX".
  2361            05 FILLER PIC X(33) VALUE "IORD-MIN".
  2362            05 FILLER PIC X(33) VALUE " ORDER".
  2363            05 FILLER PIC X(33) VALUE " ORGANIZATION".
  2364            05 FILLER PIC X(33) VALUE " OTHER".
  2365            05 FILLER PIC X(33) VALUE " OUTPUT".
  2366            05 FILLER PIC X(33) VALUE " OVERFLOW".
  2367            05 FILLER PIC X(33) VALUE " OVERLINE".
  2368            05 FILLER PIC X(33) VALUE " OVERRIDE".
  2369            05 FILLER PIC X(33) VALUE " PACKED-DECIMAL".
  2370            05 FILLER PIC X(33) VALUE " PADDING".
  2371            05 FILLER PIC X(33) VALUE " PAGE".
  2372            05 FILLER PIC X(33) VALUE " PAGE-COUNTER".
  2373            05 FILLER PIC X(33) VALUE " PARAGRAPH".
  2374            05 FILLER PIC X(33) VALUE "VPERFORM".
  2375            05 FILLER PIC X(33) VALUE " PF".
  2376            05 FILLER PIC X(33) VALUE " PH".
  2377            05 FILLER PIC X(33) VALUE "IPI".
  2378            05 FILLER PIC X(33) VALUE "KPIC".
  2379            05 FILLER PIC X(33) VALUE "KPICTURE".
  2380            05 FILLER PIC X(33) VALUE " PLUS".
  2381            05 FILLER PIC X(33) VALUE "KPOINTER".
  2382            05 FILLER PIC X(33) VALUE " POSITION".
  2383            05 FILLER PIC X(33) VALUE " POSITIVE".
  2384            05 FILLER PIC X(33) VALUE " PRESENT".
  2385            05 FILLER PIC X(33) VALUE "IPRESENT-VALUE".
  2386            05 FILLER PIC X(33) VALUE " PREVIOUS".
  2387            05 FILLER PIC X(33) VALUE "MPRINTER".
  2388            05 FILLER PIC X(33) VALUE " PRINTING".
  2389            05 FILLER PIC X(33) VALUE "KPROCEDURE".
  2390            05 FILLER PIC X(33) VALUE " PROCEDURE-POINTER".
  2391            05 FILLER PIC X(33) VALUE " PROCEDURES".
  2392            05 FILLER PIC X(33) VALUE " PROCEED".
  2393            05 FILLER PIC X(33) VALUE " PROGRAM".
  2394            05 FILLER PIC X(33) VALUE "KPROGRAM-ID".
  2395            05 FILLER PIC X(33) VALUE " PROGRAM-POINTER".
  2396            05 FILLER PIC X(33) VALUE " PROMPT".
  2397            05 FILLER PIC X(33) VALUE " PROPERTY".
  2398            05 FILLER PIC X(33) VALUE " PROTOTYPE".
  2399            05 FILLER PIC X(33) VALUE " QUOTE".
  2400            05 FILLER PIC X(33) VALUE " QUOTES".
  2401            05 FILLER PIC X(33) VALUE " RAISE".
  2402            05 FILLER PIC X(33) VALUE " RAISING".

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  2403            05 FILLER PIC X(33) VALUE "IRANDOM".
  2404            05 FILLER PIC X(33) VALUE "IRANGE".
  2405            05 FILLER PIC X(33) VALUE " RD".
  2406            05 FILLER PIC X(33) VALUE "VREAD".
  2407            05 FILLER PIC X(33) VALUE "VREADY".
  2408            05 FILLER PIC X(33) VALUE " RECORD".
  2409            05 FILLER PIC X(33) VALUE " RECORDING".
  2410            05 FILLER PIC X(33) VALUE " RECORDS".
  2411            05 FILLER PIC X(33) VALUE " RECURSIVE".
  2412            05 FILLER PIC X(33) VALUE "KREDEFINES".
  2413            05 FILLER PIC X(33) VALUE " REEL".
  2414            05 FILLER PIC X(33) VALUE " REFERENCE".
  2415            05 FILLER PIC X(33) VALUE " RELATIVE".
  2416            05 FILLER PIC X(33) VALUE "VRELEASE".
  2417            05 FILLER PIC X(33) VALUE "IREM".
  2418            05 FILLER PIC X(33) VALUE " REMAINDER".
  2419            05 FILLER PIC X(33) VALUE " REMARKS".
  2420            05 FILLER PIC X(33) VALUE " REMOVAL".
  2421            05 FILLER PIC X(33) VALUE "KRENAMES".
  2422            05 FILLER PIC X(33) VALUE "KREPLACING".
  2423            05 FILLER PIC X(33) VALUE "KREPORT".
  2424            05 FILLER PIC X(33) VALUE " REPORTING".
  2425            05 FILLER PIC X(33) VALUE " REPORTS".
  2426            05 FILLER PIC X(33) VALUE " REPOSITORY".
  2427            05 FILLER PIC X(33) VALUE " REPRESENTS-NOT-A-NUMBER".
  2428            05 FILLER PIC X(33) VALUE " REQUIRED".
  2429            05 FILLER PIC X(33) VALUE " RESERVE".
  2430            05 FILLER PIC X(33) VALUE " RESUME".
  2431            05 FILLER PIC X(33) VALUE " RETRY".
  2432            05 FILLER PIC X(33) VALUE "VRETURN".
  2433            05 FILLER PIC X(33) VALUE "IRETURN-CODE".
  2434            05 FILLER PIC X(33) VALUE "KRETURNING".
  2435            05 FILLER PIC X(33) VALUE "IREVERSE".
  2436            05 FILLER PIC X(33) VALUE " REVERSE-VIDEO".
  2437            05 FILLER PIC X(33) VALUE " REWIND".
  2438            05 FILLER PIC X(33) VALUE "VREWRITE".
  2439            05 FILLER PIC X(33) VALUE " RF".
  2440            05 FILLER PIC X(33) VALUE " RH".
  2441            05 FILLER PIC X(33) VALUE " RIGHT".
  2442            05 FILLER PIC X(33) VALUE " RIGHT-JUSTIFY".
  2443            05 FILLER PIC X(33) VALUE "VROLLBACK".
  2444            05 FILLER PIC X(33) VALUE " ROUNDED".
  2445            05 FILLER PIC X(33) VALUE " RUN".
  2446            05 FILLER PIC X(33) VALUE " SAME".
  2447            05 FILLER PIC X(33) VALUE "KSCREEN".
  2448            05 FILLER PIC X(33) VALUE " SCROLL".
  2449            05 FILLER PIC X(33) VALUE "KSD".
  2450            05 FILLER PIC X(33) VALUE "VSEARCH".
  2451            05 FILLER PIC X(33) VALUE "ISECONDS-FROM-FORMATTED-TIME".
  2452            05 FILLER PIC X(33) VALUE "ISECONDS-PAST-MIDNIGHT".
  2453            05 FILLER PIC X(33) VALUE "KSECTION".
  2454            05 FILLER PIC X(33) VALUE " SECURE".
  2455            05 FILLER PIC X(33) VALUE " SECURITY".
  2456            05 FILLER PIC X(33) VALUE " SEGMENT-LIMIT".
  2457            05 FILLER PIC X(33) VALUE " SELECT".
  2458            05 FILLER PIC X(33) VALUE " SELF".

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  2459            05 FILLER PIC X(33) VALUE " SENTENCE".
  2460            05 FILLER PIC X(33) VALUE " SEPARATE".
  2461            05 FILLER PIC X(33) VALUE " SEQUENCE".
  2462            05 FILLER PIC X(33) VALUE " SEQUENTIAL".
  2463            05 FILLER PIC X(33) VALUE "VSET".
  2464            05 FILLER PIC X(33) VALUE " SHARING".
  2465            05 FILLER PIC X(33) VALUE "ISIGN".
  2466            05 FILLER PIC X(33) VALUE " SIGNED".
  2467            05 FILLER PIC X(33) VALUE " SIGNED-INT".
  2468            05 FILLER PIC X(33) VALUE " SIGNED-LONG".
  2469            05 FILLER PIC X(33) VALUE " SIGNED-SHORT".
  2470            05 FILLER PIC X(33) VALUE "ISIN".
  2471            05 FILLER PIC X(33) VALUE " SIZE".
  2472            05 FILLER PIC X(33) VALUE "VSORT".
  2473            05 FILLER PIC X(33) VALUE " SORT-MERGE".
  2474            05 FILLER PIC X(33) VALUE "ISORT-RETURN".
  2475            05 FILLER PIC X(33) VALUE " SOURCE".
  2476            05 FILLER PIC X(33) VALUE " SOURCE-COMPUTER".
  2477            05 FILLER PIC X(33) VALUE " SOURCES".
  2478            05 FILLER PIC X(33) VALUE " SPACE".
  2479            05 FILLER PIC X(33) VALUE " SPACE-FILL".
  2480            05 FILLER PIC X(33) VALUE " SPACES".
  2481            05 FILLER PIC X(33) VALUE " SPECIAL-NAMES".
  2482            05 FILLER PIC X(33) VALUE "ISQRT".
  2483            05 FILLER PIC X(33) VALUE " STANDARD".
  2484            05 FILLER PIC X(33) VALUE " STANDARD-1".
  2485            05 FILLER PIC X(33) VALUE " STANDARD-2".
  2486            05 FILLER PIC X(33) VALUE "ISTANDARD-DEVIATION".
  2487            05 FILLER PIC X(33) VALUE "VSTART".
  2488            05 FILLER PIC X(33) VALUE " STATUS".
  2489            05 FILLER PIC X(33) VALUE "VSTOP".
  2490            05 FILLER PIC X(33) VALUE "ISTORED-CHAR-LENGTH".
  2491            05 FILLER PIC X(33) VALUE "VSTRING".
  2492            05 FILLER PIC X(33) VALUE "ISUBSTITUTE".
  2493            05 FILLER PIC X(33) VALUE "ISUBSTITUTE-CASE".
  2494            05 FILLER PIC X(33) VALUE "VSUBTRACT".
  2495            05 FILLER PIC X(33) VALUE "ISUM".
  2496            05 FILLER PIC X(33) VALUE " SUPER".
  2497            05 FILLER PIC X(33) VALUE "VSUPPRESS".
  2498            05 FILLER PIC X(33) VALUE "MSWITCH-1".
  2499            05 FILLER PIC X(33) VALUE "MSWITCH-2".
  2500            05 FILLER PIC X(33) VALUE "MSWITCH-3".
  2501            05 FILLER PIC X(33) VALUE "MSWITCH-4".
  2502            05 FILLER PIC X(33) VALUE "MSWITCH-5".
  2503            05 FILLER PIC X(33) VALUE "MSWITCH-6".
  2504            05 FILLER PIC X(33) VALUE "MSWITCH-7".
  2505            05 FILLER PIC X(33) VALUE "MSWITCH-8".
  2506            05 FILLER PIC X(33) VALUE " SYMBOLIC".
  2507            05 FILLER PIC X(33) VALUE " SYNC".
  2508            05 FILLER PIC X(33) VALUE " SYNCHRONIZED".
  2509            05 FILLER PIC X(33) VALUE "MSYSERR".
  2510            05 FILLER PIC X(33) VALUE "MSYSIN".
  2511            05 FILLER PIC X(33) VALUE "MSYSIPT".
  2512            05 FILLER PIC X(33) VALUE "MSYSLIST".
  2513            05 FILLER PIC X(33) VALUE "MSYSLST".
  2514            05 FILLER PIC X(33) VALUE "MSYSOUT".

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  2515            05 FILLER PIC X(33) VALUE " SYSTEM-DEFAULT".
  2516            05 FILLER PIC X(33) VALUE " TABLE".
  2517            05 FILLER PIC X(33) VALUE "KTALLYING".
  2518            05 FILLER PIC X(33) VALUE "ITAN".
  2519            05 FILLER PIC X(33) VALUE " TAPE".
  2520            05 FILLER PIC X(33) VALUE "VTERMINATE".
  2521            05 FILLER PIC X(33) VALUE " TEST".
  2522            05 FILLER PIC X(33) VALUE "ITEST-DATE-YYYYMMDD".
  2523            05 FILLER PIC X(33) VALUE "ITEST-DAY-YYYYDDD".
  2524            05 FILLER PIC X(33) VALUE " THAN".
  2525            05 FILLER PIC X(33) VALUE " THEN".
  2526            05 FILLER PIC X(33) VALUE " THROUGH".
  2527            05 FILLER PIC X(33) VALUE " THRU".
  2528            05 FILLER PIC X(33) VALUE " TIME".
  2529            05 FILLER PIC X(33) VALUE " TIMES".
  2530            05 FILLER PIC X(33) VALUE "KTO".
  2531            05 FILLER PIC X(33) VALUE " TOP".
  2532            05 FILLER PIC X(33) VALUE " TRAILING".
  2533            05 FILLER PIC X(33) VALUE " TRAILING-SIGN".
  2534            05 FILLER PIC X(33) VALUE "VTRANSFORM".
  2535            05 FILLER PIC X(33) VALUE "ITRIM".
  2536            05 FILLER PIC X(33) VALUE " TRUE".
  2537            05 FILLER PIC X(33) VALUE " TYPE".
  2538            05 FILLER PIC X(33) VALUE " TYPEDEF".
  2539            05 FILLER PIC X(33) VALUE " UNDERLINE".
  2540            05 FILLER PIC X(33) VALUE " UNIT".
  2541            05 FILLER PIC X(33) VALUE " UNIVERSAL".
  2542            05 FILLER PIC X(33) VALUE "VUNLOCK".
  2543            05 FILLER PIC X(33) VALUE " UNSIGNED".
  2544            05 FILLER PIC X(33) VALUE " UNSIGNED-INT".
  2545            05 FILLER PIC X(33) VALUE " UNSIGNED-LONG".
  2546            05 FILLER PIC X(33) VALUE " UNSIGNED-SHORT".
  2547            05 FILLER PIC X(33) VALUE "VUNSTRING".
  2548            05 FILLER PIC X(33) VALUE " UNTIL".
  2549            05 FILLER PIC X(33) VALUE "KUP".
  2550            05 FILLER PIC X(33) VALUE " UPDATE".
  2551            05 FILLER PIC X(33) VALUE " UPON".
  2552            05 FILLER PIC X(33) VALUE " UPPER".
  2553            05 FILLER PIC X(33) VALUE "IUPPER-CASE".
  2554            05 FILLER PIC X(33) VALUE " USAGE".
  2555            05 FILLER PIC X(33) VALUE "VUSE".
  2556            05 FILLER PIC X(33) VALUE " USER-DEFAULT".
  2557            05 FILLER PIC X(33) VALUE "KUSING".
  2558            05 FILLER PIC X(33) VALUE " VAL-STATUS".
  2559            05 FILLER PIC X(33) VALUE " VALID".
  2560            05 FILLER PIC X(33) VALUE " VALIDATE".
  2561            05 FILLER PIC X(33) VALUE " VALIDATE-STATUS".
  2562            05 FILLER PIC X(33) VALUE " VALUE".
  2563            05 FILLER PIC X(33) VALUE " VALUES".
  2564            05 FILLER PIC X(33) VALUE "IVARIANCE".
  2565            05 FILLER PIC X(33) VALUE "KVARYING".
  2566            05 FILLER PIC X(33) VALUE " WAIT".
  2567            05 FILLER PIC X(33) VALUE "VWHEN".
  2568            05 FILLER PIC X(33) VALUE "IWHEN-COMPILED".
  2569            05 FILLER PIC X(33) VALUE " WITH".
  2570            05 FILLER PIC X(33) VALUE " WORDS".

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  2571            05 FILLER PIC X(33) VALUE "KWORKING-STORAGE".
  2572            05 FILLER PIC X(33) VALUE "VWRITE".
  2573            05 FILLER PIC X(33) VALUE "IYEAR-TO-YYYY".
  2574            05 FILLER PIC X(33) VALUE " YYYYDDD".
  2575            05 FILLER PIC X(33) VALUE " YYYYMMDD".
  2576            05 FILLER PIC X(33) VALUE " ZERO".
  2577            05 FILLER PIC X(33) VALUE " ZERO-FILL".
  2578            05 FILLER PIC X(33) VALUE " ZEROES".
  2579            05 FILLER PIC X(33) VALUE " ZEROS".
  2580        01  Reserved-Word-Table         REDEFINES Reserved-Words.
  2581            05 Reserved-Word            OCCURS 591 TIMES
  2582                                        ASCENDING KEY RW-Word
  2583                                        INDEXED RW-Idx.
  2584               10 RW-Type               PIC X(1).
  2585               10 RW-Word               PIC X(32).
  2586
  2587        01  Saved-Section               PIC X(15).
  2588
  2589        01  Search-Token                PIC X(32).
  2590
  2591        01  Source-Line-No              PIC 9(6).
  2592
  2593        01  Src-Ptr                     USAGE BINARY-LONG.
  2594
  2595        01  Syntax-Parsing-Items.
  2596            05 SPI-Current-Char         PIC X(1).
  2597               88 Current-Char-Is-Punct VALUE "=", "(", ")", "*", "/",
  2598                                              "&", ";", ",", "<", ">",
  2599                                              ":".
  2600               88 Current-Char-Is-Quote VALUE '"', "'".
  2601               88 Current-Char-Is-X     VALUE "x", "X".
  2602               88 Current-Char-Is-Z     VALUE "z", "Z".
  2603            05 SPI-Current-Division     PIC X(1).
  2604 GC1010        88 In-IDENTIFICATION-DIVISION VALUE "i", "I", "?".
  2605 GC1010        88 In-ENVIRONMENT-DIVISION    VALUE "e", "E".
  2606 GC1010        88 In-DATA-DIVISION           VALUE "d", "D".
  2607 GC1010        88 In-PROCEDURE-DIVISION      VALUE "p", "P".
  2608            05 SPI-Current-Line-No      PIC 9(6).
  2609            05 SPI-Current-Program-ID.
  2610               10 FILLER                PIC X(12).
  2611               10 SPI-CP-13-15          PIC X(3).
  2612            05 SPI-Current-Section.
  2613               10 SPI-CS-1              PIC X(1).
  2614               10 SPI-CS-2-14.
  2615                  15 FILLER             PIC X(10).
  2616                  15 SPI-CS-11-14       PIC X(3).
  2617               10 SPI-CS-15             PIC X(1).
  2618            05 SPI-Current-Token        PIC X(32).
  2619            05 SPI-Current-Token-UC     PIC X(32).
  2620            05 SPI-Current-Verb         PIC X(12).
  2621            05 SPI-Next-Char            PIC X(1).
  2622               88 Next-Char-Is-Quote    VALUE '"', "'".
  2623            05 SPI-Prior-Token          PIC X(32).
  2624            05 SPI-Token-Type           PIC X(1).
  2625               88 Token-Is-EOF             VALUE HIGH-VALUES.
  2626               88 Token-Is-Identifier      VALUE "I".

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  2627               88 Token-Is-Key-Word        VALUE "K", "V".
  2628               88 Token-Is-Literal-Alpha   VALUE "L".
  2629               88 Token-Is-Literal-Number  VALUE "N".
  2630               88 Token-Is-Verb            VALUE "V".
  2631 GC0710        88 Token-Is-Reserved-Word   VALUE " ".
  2632
  2633        01  Tally                       USAGE BINARY-LONG.
  2634
  2635        01  Todays-Date                 PIC 9(8).
  2636
  2637        LINKAGE SECTION.
  2638        01  Produce-Source-Listing      PIC X(1).
  2639        01  Produce-Xref-Listing        PIC X(1).
  2640        01  Src-Filename                PIC X(256).

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  2641       /
  2642        PROCEDURE DIVISION USING Produce-Source-Listing
  2643                                 Produce-Xref-Listing
  2644                                 Src-Filename.
  2645        000-Main SECTION.
  2646        001-Init.
  2647            PERFORM 100-Initialization
  2648            OPEN OUTPUT Report-File
  2649            IF Produce-Source-Listing NOT = SPACE
  2650                PERFORM 500-Produce-Source-Listing
  2651            END-IF
  2652            IF Produce-Xref-Listing NOT = SPACE
  2653                SORT Sort-File
  2654                    ASCENDING KEY    SR-Prog-ID
  2655                                     SR-Token-UC
  2656                                     SR-Line-No-Ref
  2657                    INPUT PROCEDURE  300-Tokenize-Source
  2658                    OUTPUT PROCEDURE 400-Produce-Xref-Listing
  2659            END-IF
  2660            CLOSE Report-File
  2661            GOBACK
  2662            .

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  2663       /
  2664        100-Initialization SECTION.
  2665       *****************************************************************
  2666       ** Perform all program-wide initialization operations          **
  2667       *****************************************************************
  2668        101-Establish-Working-Env.
  2669            MOVE TRIM(Src-Filename,Leading) TO Src-Filename
  2670 DEBUG D    DISPLAY
  2671 DEBUG D        'Src-Filename    ='
  2672 DEBUG D        TRIM(Src-Filename,Trailing)
  2673 DEBUG D        UPON SYSERR
  2674 DEBUG D    END-DISPLAY
  2675 GC1010     PERFORM VARYING I FROM LENGTH(Src-Filename)
  2676 GC1010                  BY -1
  2677 GC1010                  UNTIL Src-Filename(I:1) = '/' OR '\'
  2678 GC1010                     OR I = 0
  2679 GC1010     END-PERFORM
  2680 GC1010     IF I = 0
  2681 GC1010         MOVE UPPER-CASE(Src-Filename) TO Main-Module-Name
  2682 GC1010     ELSE
  2683 GC1010         ADD 1 TO I
  2684 GC1010         MOVE UPPER-CASE(Src-Filename(I:)) TO Main-Module-Name
  2685 GC1010     END-IF
  2686 DEBUG D    DISPLAY
  2687 DEBUG D        'Main-Module-Name='
  2688 DEBUG D        TRIM(Main-Module-Name,Trailing)
  2689 DEBUG D        UPON SYSERR
  2690 DEBUG D    END-DISPLAY
  2691            ACCEPT Lines-Per-Page-ENV
  2692                FROM ENVIRONMENT "OCXREF_LINES"
  2693            END-ACCEPT
  2694            INSPECT Src-Filename REPLACING ALL "\" BY "/"
  2695            MOVE Src-Filename TO Program-Path
  2696            MOVE Program-Path TO Heading-2
  2697            CALL "C$JUSTIFY"
  2698                USING Heading-2, "Right"
  2699            END-CALL
  2700            MOVE LENGTH(TRIM(Src-Filename,Trailing)) TO I
  2701            MOVE 0 TO J
  2702            PERFORM UNTIL Src-Filename(I:1) = '/'
  2703                       OR I = 0
  2704                SUBTRACT 1 FROM I
  2705                ADD      1 TO   J
  2706            END-PERFORM
  2707            UNSTRING Src-Filename((I + 1):J) DELIMITED BY "."
  2708                INTO Filename, Dummy
  2709            END-UNSTRING
  2710 GC1010     STRING
  2711 GC1010            TRIM(Filename,Trailing)
  2712 GC1010            ".i"
  2713 GC1010            DELIMITED SIZE
  2714 GC1010            INTO Expanded-Src-Filename
  2715 GC1010     END-STRING
  2716 GC1010     CALL 'CBL_CHECK_FILE_EXIST'
  2717 GC1010         USING Expanded-Src-Filename
  2718 GC1010               PIC-X256

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  2719 GC1010     END-CALL
  2720 GC1010     IF RETURN-CODE NOT = 0
  2721 DEBUG D        DISPLAY
  2722 DEBUG D            'File Not Found: '
  2723 DEBUG D            TRIM(Expanded-Src-Filename,Trailing)
  2724 DEBUG D            UPON SYSERR
  2725 DEBUG D        END-DISPLAY
  2726 DEBUG D        DISPLAY
  2727 DEBUG D            'Above PROBABLY caused by "-I -save-xrefs=xxx"'
  2728 DEBUG D            UPON SYSERR
  2729 DEBUG D        END-DISPLAY
  2730 GC1010         GOBACK
  2731 GC1010     END-IF
  2732            STRING Program-Path(1:I)
  2733                   TRIM(Filename,Trailing)
  2734                   ".lst"
  2735                   DELIMITED SIZE
  2736                   INTO Report-Filename
  2737            END-STRING
  2738            IF Lines-Per-Page-ENV NOT = SPACES
  2739                MOVE NUMVAL(Lines-Per-Page-ENV) TO Lines-Per-Page
  2740            ELSE
  2741                MOVE 60 TO Lines-Per-Page
  2742            END-IF
  2743            ACCEPT Todays-Date
  2744                FROM DATE YYYYMMDD
  2745            END-ACCEPT
  2746            MOVE Todays-Date TO H1X-Date
  2747                                H1S-Date
  2748            MOVE "????????????..." TO SPI-Current-Program-ID
  2749            MOVE SPACES            TO SPI-Current-Verb
  2750                                      Held-Reference
  2751            MOVE "Y" TO F-First-Record
  2752            .
  2753
  2754        209-Exit.
  2755            EXIT
  2756            .

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  2757       /
  2758        300-Tokenize-Source SECTION.
  2759        301-Driver.
  2760            OPEN INPUT Expand-Code
  2761            MOVE SPACES TO Expand-Code-Rec
  2762            MOVE 256 TO Src-Ptr
  2763            MOVE 0 TO Num-UserNames
  2764                      SPI-Current-Line-No
  2765            MOVE "?" TO SPI-Current-Division
  2766 GC0710     MOVE "N" TO F-Verb-Has-Been-Found.
  2767            PERFORM FOREVER
  2768                PERFORM 310-Get-Token
  2769                IF Token-Is-EOF
  2770                    EXIT PERFORM
  2771                END-IF
  2772                MOVE UPPER-CASE(SPI-Current-Token)
  2773                  TO SPI-Current-Token-UC
  2774 GC1010         IF Token-Is-Key-Word
  2775 GC1010         OR Token-Is-Reserved-Word
  2776 GC1010             MOVE SPI-Current-Token-UC TO SPI-Current-Token
  2777 GC1010         END-IF
  2778                IF Token-Is-Verb
  2779                    MOVE SPI-Current-Token-UC TO SPI-Current-Verb
  2780                                                 SPI-Prior-Token
  2781                    IF Held-Reference NOT = SPACES
  2782                        MOVE Held-Reference TO Sort-Rec
  2783                        MOVE SPACES         TO Held-Reference
  2784                        RELEASE Sort-Rec
  2785                    END-IF
  2786                END-IF
  2787                EVALUATE TRUE
  2788                WHEN In-IDENTIFICATION-DIVISION
  2789                    PERFORM 320-IDENTIFICATION-DIVISION
  2790                WHEN In-ENVIRONMENT-DIVISION
  2791                    PERFORM 330-ENVIRONMENT-DIVISION
  2792                WHEN In-DATA-DIVISION
  2793                    PERFORM 340-DATA-DIVISION
  2794                WHEN In-PROCEDURE-DIVISION
  2795                    PERFORM 350-PROCEDURE-DIVISION
  2796                END-EVALUATE
  2797                IF Token-Is-Key-Word
  2798                    MOVE SPI-Current-Token-UC TO SPI-Prior-Token
  2799                END-IF
  2800                IF F-Token-Ended-Sentence = "Y"
  2801                AND SPI-Current-Division NOT = "I"
  2802                    MOVE SPACES TO SPI-Prior-Token
  2803                                   SPI-Current-Verb
  2804                END-IF
  2805
  2806            END-PERFORM
  2807            CLOSE Expand-Code
  2808            EXIT SECTION
  2809            .
  2810       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  2811        310-Get-Token.
  2812       *>-- Position to 1st non-blank character

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  2813            MOVE F-Token-Ended-Sentence TO F-Last-Token-Ended-Sent
  2814            MOVE "N" TO F-Token-Ended-Sentence
  2815            PERFORM UNTIL Expand-Code-Rec(Src-Ptr : 1) NOT = SPACE
  2816                IF Src-Ptr > 255
  2817                    READ Expand-Code AT END
  2818                        IF Held-Reference NOT = SPACES
  2819                            MOVE Held-Reference TO Sort-Rec
  2820                            MOVE SPACES         TO Held-Reference
  2821                            RELEASE Sort-Rec
  2822                        END-IF
  2823                        SET Token-Is-EOF TO TRUE
  2824                        MOVE 0 TO SPI-Current-Line-No
  2825                        EXIT PARAGRAPH
  2826                    END-READ
  2827                    IF ECR-1 = "#"
  2828                        PERFORM 311-Control-Record
  2829                    ELSE
  2830                        PERFORM 312-Expand-Code-Record
  2831                    END-IF
  2832                ELSE
  2833                    ADD 1 TO Src-Ptr
  2834                END-IF
  2835            END-PERFORM
  2836       *>-- Extract token string
  2837            MOVE Expand-Code-Rec(Src-Ptr : 1)    TO SPI-Current-Char
  2838            MOVE Expand-Code-Rec(Src-Ptr + 1: 1) TO SPI-Next-Char
  2839            IF SPI-Current-Char = "."
  2840                ADD 1 TO Src-Ptr
  2841                MOVE SPI-Current-Char TO SPI-Current-Token
  2842                MOVE SPACE TO SPI-Token-Type
  2843                MOVE "Y" TO F-Token-Ended-Sentence
  2844                EXIT PARAGRAPH
  2845            END-IF
  2846            IF Current-Char-Is-Punct
  2847            AND SPI-Current-Char = "="
  2848            AND SPI-Current-Division = "P"
  2849                ADD 1 TO Src-Ptr
  2850                MOVE "EQUALS" TO SPI-Current-Token
  2851                MOVE "K"      TO SPI-Token-Type
  2852                EXIT PARAGRAPH
  2853            END-IF
  2854            IF Current-Char-Is-Punct *> So subscripts don't get flagged w/ "*"
  2855            AND SPI-Current-Char = "("
  2856            AND SPI-Current-Division = "P"
  2857                MOVE SPACES TO SPI-Prior-Token
  2858            END-IF
  2859            IF Current-Char-Is-Punct
  2860                ADD 1 TO Src-Ptr
  2861                MOVE SPI-Current-Char TO SPI-Current-Token
  2862                MOVE SPACE TO SPI-Token-Type
  2863                EXIT PARAGRAPH
  2864            END-IF
  2865            IF Current-Char-Is-Quote
  2866                ADD 1 TO Src-Ptr
  2867                UNSTRING Expand-Code-Rec
  2868                    DELIMITED BY SPI-Current-Char

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  2869                    INTO SPI-Current-Token
  2870                    WITH POINTER Src-Ptr
  2871                END-UNSTRING
  2872                IF Expand-Code-Rec(Src-Ptr : 1) = "."
  2873                    MOVE "Y" TO F-Token-Ended-Sentence
  2874                    ADD 1 TO Src-Ptr
  2875                END-IF
  2876                SET Token-Is-Literal-Alpha TO TRUE
  2877                EXIT PARAGRAPH
  2878            END-IF
  2879            IF Current-Char-Is-X AND Next-Char-Is-Quote
  2880                ADD 2 TO Src-Ptr
  2881                UNSTRING Expand-Code-Rec
  2882                    DELIMITED BY SPI-Next-Char
  2883                    INTO SPI-Current-Token
  2884                    WITH POINTER Src-Ptr
  2885                END-UNSTRING
  2886                IF Expand-Code-Rec(Src-Ptr : 1) = "."
  2887                    MOVE "Y" TO F-Token-Ended-Sentence
  2888                    ADD 1 TO Src-Ptr
  2889                END-IF
  2890                SET Token-Is-Literal-Number TO TRUE
  2891                EXIT PARAGRAPH
  2892            END-IF
  2893            IF Current-Char-Is-Z AND Next-Char-Is-Quote
  2894                ADD 2 TO Src-Ptr
  2895                UNSTRING Expand-Code-Rec
  2896                    DELIMITED BY SPI-Next-Char
  2897                    INTO SPI-Current-Token
  2898                    WITH POINTER Src-Ptr
  2899                END-UNSTRING
  2900                IF Expand-Code-Rec(Src-Ptr : 1) = "."
  2901                    MOVE "Y" TO F-Token-Ended-Sentence
  2902                    ADD 1 TO Src-Ptr
  2903                END-IF
  2904                SET Token-Is-Literal-Alpha TO TRUE
  2905                EXIT PARAGRAPH
  2906            END-IF
  2907            IF F-Processing-PICTURE = "Y"
  2908                UNSTRING Expand-Code-Rec
  2909                    DELIMITED BY ". " OR " "
  2910                    INTO SPI-Current-Token
  2911                    DELIMITER IN Delim
  2912                    WITH POINTER Src-Ptr
  2913                END-UNSTRING
  2914                IF Delim = ". "
  2915                    MOVE "Y" TO F-Token-Ended-Sentence
  2916                    ADD 1 TO Src-Ptr
  2917                END-IF
  2918                IF UPPER-CASE(SPI-Current-Token) = "IS"
  2919                    MOVE SPACE TO SPI-Token-Type
  2920                    EXIT PARAGRAPH
  2921                ELSE
  2922                    MOVE "N" TO F-Processing-PICTURE
  2923                    MOVE SPACE TO SPI-Token-Type
  2924                    EXIT PARAGRAPH

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  2925                END-IF
  2926            END-IF
  2927            UNSTRING Expand-Code-Rec
  2928                DELIMITED BY ". " OR " " OR "=" OR "(" OR ")" OR "*"
  2929                                  OR "/" OR "&" OR ";" OR "," OR "<"
  2930                                  OR ">" OR ":"
  2931                INTO SPI-Current-Token
  2932                DELIMITER IN Delim
  2933                WITH POINTER Src-Ptr
  2934            END-UNSTRING
  2935            IF Delim = ". "
  2936                MOVE "Y" TO F-Token-Ended-Sentence
  2937            END-IF
  2938            IF Delim NOT = ". " AND " "
  2939                SUBTRACT 1 FROM Src-Ptr
  2940            END-IF
  2941       *>-- Classify Token
  2942            MOVE UPPER-CASE(SPI-Current-Token) TO Search-Token
  2943            IF Search-Token = "EQUAL" OR "EQUALS"
  2944                MOVE "EQUALS" TO SPI-Current-Token
  2945                MOVE "K"      TO SPI-Token-Type
  2946                EXIT PARAGRAPH
  2947            END-IF
  2948            SEARCH ALL Reserved-Word
  2949                WHEN RW-Word (RW-Idx) = Search-Token
  2950                    MOVE RW-Type (RW-Idx) TO SPI-Token-Type
  2951 GC0710             IF Token-Is-Verb
  2952 GC0710                 MOVE "Y" TO F-Verb-Has-Been-Found
  2953 GC0710             END-IF
  2954                    EXIT PARAGRAPH
  2955            END-SEARCH
  2956       *>-- Not a reserved word, must be a user name
  2957            SET Token-Is-Identifier TO TRUE *> NEEDS EXPANSION!!!!
  2958            PERFORM 313-Check-For-Numeric-Token
  2959            IF Token-Is-Literal-Number
  2960                IF  (F-Last-Token-Ended-Sent = "Y")
  2961                AND (SPI-Current-Division = "D")
  2962                    MOVE "LEVEL #" TO SPI-Current-Token
  2963                    MOVE "K"       TO SPI-Token-Type
  2964                    EXIT PARAGRAPH
  2965                ELSE
  2966                    EXIT PARAGRAPH
  2967                END-IF
  2968            END-IF
  2969            EXIT PARAGRAPH
  2970            .
  2971       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  2972        311-Control-Record.
  2973            UNSTRING ECR-2-256
  2974                DELIMITED BY '"'
  2975                INTO PIC-X10, PIC-X256, Dummy
  2976            END-UNSTRING
  2977            INSPECT PIC-X10 REPLACING ALL '"' BY SPACE
  2978            COMPUTE I = NUMVAL(PIC-X10) - 1
  2979 GC1010     IF UPPER-CASE(TRIM(PIC-X256,Trailing)) =
  2980 GC1010        TRIM(Main-Module-Name)

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  2981                MOVE I TO SPI-Current-Line-No
  2982                SET In-Main-Module TO TRUE
  2983                IF Saved-Section NOT = SPACES
  2984                    MOVE Saved-Section TO SPI-Current-Section
  2985                END-IF
  2986            ELSE
  2987                SET In-Copybook TO TRUE
  2988                IF Saved-Section = SPACES
  2989                    MOVE SPI-Current-Section TO Saved-Section
  2990                END-IF
  2991                MOVE LENGTH(TRIM(PIC-X256,Trailing)) TO I
  2992                MOVE 0 TO J
  2993                PERFORM UNTIL PIC-X256(I:1) = '/'
  2994                           OR I = 0
  2995                    SUBTRACT 1 FROM I
  2996                    ADD      1 TO   J
  2997                END-PERFORM
  2998                UNSTRING PIC-X256((I + 1):J) DELIMITED BY "."
  2999                    INTO Filename, Dummy
  3000                END-UNSTRING
  3001                MOVE "["      TO SPI-CS-1
  3002                MOVE Filename TO SPI-CS-2-14
  3003                IF SPI-CS-11-14 NOT = SPACES
  3004                    MOVE "..." TO SPI-CS-11-14
  3005                END-IF
  3006                MOVE "]"      TO SPI-CS-15
  3007            END-IF
  3008            MOVE SPACES TO Expand-Code-Rec *> Force another READ
  3009            MOVE 256    TO Src-Ptr
  3010            .
  3011       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3012        312-Expand-Code-Record.
  3013            MOVE 1 TO Src-Ptr
  3014            IF In-Main-Module
  3015                ADD 1 To SPI-Current-Line-No
  3016            END-IF
  3017            .
  3018       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3019        313-Check-For-Numeric-Token.
  3020            MOVE SPI-Current-Token TO PIC-X32
  3021            INSPECT PIC-X32
  3022                REPLACING TRAILING SPACES BY "0"
  3023            IF PIC-X32 IS NUMERIC                     *> Simple Unsigned Integer
  3024                SET Token-Is-Literal-Number TO TRUE
  3025                EXIT PARAGRAPH
  3026            END-IF
  3027            IF PIC-X32(1:1) = "+" OR "-"
  3028                MOVE "0" TO PIC-X32(1:1)
  3029            END-IF
  3030            MOVE 0 TO Tally
  3031            INSPECT PIC-X32
  3032                TALLYING Tally FOR ALL "."
  3033            IF Tally = 1
  3034                INSPECT PIC-X32 REPLACING ALL "." BY "0"
  3035            END-IF
  3036            IF PIC-X32 IS NUMERIC

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  3037                SET Token-Is-Literal-Number TO TRUE
  3038                EXIT PARAGRAPH
  3039            END-IF
  3040            .
  3041       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3042        320-IDENTIFICATION-DIVISION.
  3043 GC0710     MOVE "N" TO F-Verb-Has-Been-Found
  3044            IF Token-Is-Key-Word AND SPI-Current-Token = "DIVISION"
  3045                MOVE SPI-Prior-Token TO SPI-Current-Division
  3046                EXIT PARAGRAPH
  3047            END-IF
  3048            IF SPI-Prior-Token = "PROGRAM-ID"
  3049                MOVE SPACES TO SPI-Prior-Token
  3050                MOVE SPI-Current-Token TO SPI-Current-Program-ID
  3051                IF SPI-CP-13-15 NOT = SPACES
  3052                    MOVE "..." TO SPI-CP-13-15
  3053                END-IF
  3054                EXIT PARAGRAPH
  3055            END-IF
  3056            .
  3057       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3058        330-ENVIRONMENT-DIVISION.
  3059            IF Token-Is-Key-Word AND SPI-Current-Token = "DIVISION"
  3060                MOVE SPI-Prior-Token TO SPI-Current-Division
  3061                EXIT PARAGRAPH
  3062            END-IF
  3063            IF Token-Is-Key-Word AND SPI-Current-Token = "SECTION"
  3064                MOVE SPI-Prior-Token TO SPI-Current-Section
  3065                EXIT PARAGRAPH
  3066            END-IF
  3067            IF Token-Is-Identifier
  3068                PERFORM 361-Release-Ref
  3069            END-IF
  3070            .
  3071       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3072        340-DATA-DIVISION.
  3073            IF Token-Is-Key-Word AND SPI-Current-Token = "DIVISION"
  3074                MOVE SPI-Prior-Token TO SPI-Current-Division
  3075                EXIT PARAGRAPH
  3076            END-IF
  3077            IF Token-Is-Key-Word AND SPI-Current-Token = "SECTION"
  3078                MOVE SPI-Prior-Token TO SPI-Current-Section
  3079                EXIT PARAGRAPH
  3080            END-IF
  3081            IF  (SPI-Current-Token = "PIC" OR "PICTURE")
  3082            AND (Token-Is-Key-Word)
  3083                MOVE "Y" TO F-Processing-PICTURE
  3084                EXIT PARAGRAPH
  3085            END-IF
  3086 GC0710     IF Token-Is-Reserved-Word
  3087 GC0710     AND SPI-Prior-Token = "LEVEL #"
  3088 GC0710         MOVE SPACES TO SPI-Prior-Token
  3089 GC0710         EXIT PARAGRAPH
  3090 GC0710     END-IF
  3091            IF Token-Is-Identifier
  3092                EVALUATE SPI-Prior-Token

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  3093                WHEN "FD"
  3094                    PERFORM 360-Release-Def
  3095                    MOVE SPACES TO SPI-Prior-Token
  3096                WHEN "SD"
  3097                    PERFORM 360-Release-Def
  3098                    MOVE SPACES TO SPI-Prior-Token
  3099                WHEN "LEVEL #"
  3100                    PERFORM 360-Release-Def
  3101                    MOVE SPACES TO SPI-Prior-Token
  3102                WHEN "INDEXED"
  3103                    PERFORM 360-Release-Def
  3104                    MOVE SPACES TO SPI-Prior-Token
  3105                WHEN "USING"
  3106                    PERFORM 362-Release-Upd
  3107                    MOVE SPACES TO SPI-Prior-Token
  3108                WHEN "INTO"
  3109                    PERFORM 362-Release-Upd
  3110                    MOVE SPACES TO SPI-Prior-Token
  3111                WHEN OTHER
  3112                    PERFORM 361-Release-Ref
  3113                END-EVALUATE
  3114                EXIT PARAGRAPH
  3115            END-IF
  3116            .
  3117       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3118        350-PROCEDURE-DIVISION.
  3119            IF SPI-Current-Section NOT = "PROCEDURE"
  3120                MOVE "PROCEDURE" TO SPI-Current-Section
  3121            END-IF
  3122 GC0710     IF SPI-Current-Token-UC = "PROGRAM"
  3123 GC0710     AND SPI-Prior-Token = "END"
  3124 GC0710         MOVE "?" TO SPI-Current-Division
  3125 GC0710         EXIT PARAGRAPH
  3126 GC0710     END-IF
  3127            IF Token-Is-Key-Word AND SPI-Current-Token = "DIVISION"
  3128                MOVE SPI-Prior-Token TO SPI-Current-Division
  3129                EXIT PARAGRAPH
  3130            END-IF
  3131            IF SPI-Current-Verb = SPACES
  3132 GC0710     AND F-Verb-Has-Been-Found = "Y"
  3133                IF Token-Is-Identifier
  3134                    PERFORM 360-Release-Def
  3135                    MOVE SPACES TO SPI-Prior-Token
  3136                END-IF
  3137                EXIT PARAGRAPH
  3138            END-IF
  3139            IF NOT Token-Is-Identifier
  3140                EXIT PARAGRAPH
  3141            END-IF
  3142            EVALUATE SPI-Current-Verb
  3143            WHEN "ACCEPT"
  3144                PERFORM 351-ACCEPT
  3145            WHEN "ADD"
  3146                PERFORM 351-ADD
  3147            WHEN "ALLOCATE"
  3148                PERFORM 351-ALLOCATE

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  3149            WHEN "CALL"
  3150                PERFORM 351-CALL
  3151            WHEN "COMPUTE"
  3152                PERFORM 351-COMPUTE
  3153            WHEN "DIVIDE"
  3154                PERFORM 351-DIVIDE
  3155            WHEN "FREE"
  3156                PERFORM 351-FREE
  3157            WHEN "INITIALIZE"
  3158                PERFORM 351-INITIALIZE
  3159            WHEN "INSPECT"
  3160                PERFORM 351-INSPECT
  3161            WHEN "MOVE"
  3162                PERFORM 351-MOVE
  3163            WHEN "MULTIPLY"
  3164                PERFORM 351-MULTIPLY
  3165            WHEN "PERFORM"
  3166                PERFORM 351-PERFORM
  3167            WHEN "SET"
  3168                PERFORM 351-SET
  3169            WHEN "STRING"
  3170                PERFORM 351-STRING
  3171            WHEN "SUBTRACT"
  3172                PERFORM 351-SUBTRACT
  3173            WHEN "TRANSFORM"
  3174                PERFORM 351-TRANSFORM
  3175            WHEN "UNSTRING"
  3176                PERFORM 351-UNSTRING
  3177            WHEN OTHER
  3178                PERFORM 361-Release-Ref
  3179            END-EVALUATE
  3180            .
  3181       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3182        351-ACCEPT.
  3183            EVALUATE SPI-Prior-Token
  3184            WHEN "ACCEPT"
  3185                PERFORM 362-Release-Upd
  3186                MOVE SPACES TO SPI-Prior-Token
  3187            WHEN OTHER
  3188                PERFORM 361-Release-Ref
  3189            END-EVALUATE
  3190            .
  3191       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3192        351-ADD.
  3193            EVALUATE SPI-Prior-Token
  3194            WHEN "GIVING"
  3195                PERFORM 362-Release-Upd
  3196            WHEN "TO"
  3197                PERFORM 362-Release-Upd
  3198            WHEN OTHER
  3199                PERFORM 361-Release-Ref
  3200            END-EVALUATE
  3201            .
  3202       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3203        351-ALLOCATE.
  3204            EVALUATE SPI-Prior-Token

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  3205            WHEN "ALLOCATE"
  3206                PERFORM 362-Release-Upd
  3207                MOVE SPACES TO SPI-Prior-Token
  3208            WHEN "RETURNING"
  3209                PERFORM 362-Release-Upd
  3210            WHEN OTHER
  3211                PERFORM 361-Release-Ref
  3212            END-EVALUATE
  3213            .
  3214       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3215        351-CALL.
  3216            EVALUATE SPI-Prior-Token
  3217            WHEN "RETURNING"
  3218                PERFORM 362-Release-Upd
  3219            WHEN "GIVING"
  3220                PERFORM 362-Release-Upd
  3221            WHEN OTHER
  3222                PERFORM 361-Release-Ref
  3223            END-EVALUATE
  3224            .
  3225       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3226        351-COMPUTE.
  3227            EVALUATE SPI-Prior-Token
  3228            WHEN "COMPUTE"
  3229                PERFORM 362-Release-Upd
  3230            WHEN OTHER
  3231                PERFORM 361-Release-Ref
  3232            END-EVALUATE
  3233            .
  3234       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3235        351-DIVIDE.
  3236            EVALUATE SPI-Prior-Token
  3237            WHEN "INTO"
  3238                PERFORM 363-Set-Upd
  3239                MOVE Sort-Rec TO Held-Reference
  3240            WHEN "GIVING"
  3241                IF Held-Reference NOT = SPACES
  3242                    MOVE Held-Reference To Sort-Rec
  3243                    MOVE SPACES         To Held-Reference
  3244                                           SR-Ref-Flag
  3245                    RELEASE Sort-Rec
  3246                END-IF
  3247                PERFORM 362-Release-Upd
  3248            WHEN "REMAINDER"
  3249                PERFORM 362-Release-Upd
  3250            WHEN OTHER
  3251                PERFORM 361-Release-Ref
  3252            END-EVALUATE
  3253            .
  3254       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3255        351-FREE.
  3256            PERFORM 362-Release-Upd
  3257            .
  3258       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3259        351-INITIALIZE.
  3260            EVALUATE SPI-Prior-Token

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  3261            WHEN "INITIALIZE"
  3262                PERFORM 362-Release-Upd
  3263            WHEN "REPLACING"
  3264                PERFORM 361-Release-Ref
  3265            END-EVALUATE
  3266            .
  3267       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3268        351-INSPECT.
  3269            EVALUATE SPI-Prior-Token
  3270            WHEN "INSPECT"
  3271                PERFORM 364-Set-Ref
  3272                MOVE SPACES TO Held-Reference
  3273                MOVE SPACES TO SPI-Prior-Token
  3274            WHEN "TALLYING"
  3275                PERFORM 362-Release-Upd
  3276                MOVE SPACES TO SPI-Prior-Token
  3277            WHEN "REPLACING"
  3278                IF Held-Reference NOT = SPACES
  3279                    MOVE Held-Reference TO Sort-Rec
  3280                    MOVE SPACES         TO Held-Reference
  3281                    MOVE "*"            TO SR-Ref-Flag
  3282                    RELEASE Sort-Rec
  3283                END-IF
  3284                MOVE SPACES TO SPI-Prior-Token
  3285            WHEN "CONVERTING"
  3286                IF Held-Reference NOT = SPACES
  3287                    MOVE Held-Reference TO Sort-Rec
  3288                    MOVE SPACES         TO Held-Reference
  3289                    MOVE "*"            TO SR-Ref-Flag
  3290                    RELEASE Sort-Rec
  3291                END-IF
  3292                MOVE SPACES TO SPI-Prior-Token
  3293            WHEN OTHER
  3294                PERFORM 361-Release-Ref
  3295            END-EVALUATE
  3296           .
  3297       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3298        351-MOVE.
  3299            EVALUATE SPI-Prior-Token
  3300            WHEN "TO"
  3301                PERFORM 362-Release-Upd
  3302            WHEN OTHER
  3303                PERFORM 361-Release-Ref
  3304            END-EVALUATE
  3305            .
  3306       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3307        351-MULTIPLY.
  3308            EVALUATE SPI-Prior-Token
  3309            WHEN "BY"
  3310                PERFORM 363-Set-Upd
  3311                MOVE Sort-Rec TO Held-Reference
  3312            WHEN "GIVING"
  3313                MOVE Held-Reference TO Sort-Rec
  3314                MOVE SPACES         TO Held-Reference
  3315                                       SR-Ref-Flag
  3316                RELEASE Sort-Rec

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  3317                PERFORM 362-Release-Upd
  3318            WHEN OTHER
  3319                PERFORM 361-Release-Ref
  3320            END-EVALUATE
  3321            .
  3322       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3323        351-PERFORM.
  3324            EVALUATE SPI-Prior-Token
  3325            WHEN "VARYING"
  3326                PERFORM 362-Release-Upd
  3327                MOVE SPACES TO SPI-Prior-Token
  3328            WHEN "AFTER"
  3329                PERFORM 362-Release-Upd
  3330                MOVE SPACES TO SPI-Prior-Token
  3331            WHEN OTHER
  3332                PERFORM 361-Release-Ref
  3333            END-EVALUATE
  3334            .
  3335       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3336        351-SET.
  3337            EVALUATE SPI-Prior-Token
  3338            WHEN "SET"
  3339                PERFORM 362-Release-Upd
  3340            WHEN OTHER
  3341                PERFORM 361-Release-Ref
  3342            END-EVALUATE
  3343            .
  3344       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3345        351-STRING.
  3346            EVALUATE SPI-Prior-Token
  3347            WHEN "INTO"
  3348                PERFORM 362-Release-Upd
  3349            WHEN "POINTER"
  3350                PERFORM 362-Release-Upd
  3351            WHEN OTHER
  3352                PERFORM 361-Release-Ref
  3353            END-EVALUATE
  3354            .
  3355       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3356        351-SUBTRACT.
  3357            EVALUATE SPI-Prior-Token
  3358            WHEN "GIVING"
  3359                PERFORM 362-Release-Upd
  3360            WHEN "FROM"
  3361                PERFORM 362-Release-Upd
  3362            WHEN OTHER
  3363                PERFORM 361-Release-Ref
  3364            END-EVALUATE
  3365            .
  3366       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3367        351-TRANSFORM.
  3368            EVALUATE SPI-Prior-Token
  3369            WHEN "TRANSFORM"
  3370                PERFORM 362-Release-Upd
  3371                MOVE SPACES TO SPI-Prior-Token
  3372            WHEN OTHER

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  3373                PERFORM 361-Release-Ref
  3374            END-EVALUATE
  3375            .
  3376       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3377        351-UNSTRING.
  3378            EVALUATE SPI-Prior-Token
  3379            WHEN "INTO"
  3380                PERFORM 362-Release-Upd
  3381            WHEN "DELIMITER"
  3382                PERFORM 362-Release-Upd
  3383            WHEN "COUNT"
  3384                PERFORM 362-Release-Upd
  3385            WHEN "POINTER"
  3386                PERFORM 362-Release-Upd
  3387            WHEN "TALLYING"
  3388                PERFORM 362-Release-Upd
  3389            WHEN OTHER
  3390                PERFORM 361-Release-Ref
  3391            END-EVALUATE
  3392            .
  3393       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3394        360-Release-Def.
  3395            MOVE SPACES TO Sort-Rec
  3396            MOVE SPI-Current-Program-ID TO SR-Prog-ID
  3397            MOVE SPI-Current-Token-UC   TO SR-Token-UC
  3398            MOVE SPI-Current-Token      TO SR-Token
  3399            MOVE SPI-Current-Section    TO SR-Section
  3400            MOVE SPI-Current-Line-No    TO SR-Line-No-Def
  3401            MOVE 0                      TO SR-Line-No-Ref
  3402            RELEASE Sort-Rec
  3403            .
  3404       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3405        361-Release-Ref.
  3406            PERFORM 364-Set-Ref
  3407            RELEASE Sort-Rec
  3408            .
  3409       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3410        362-Release-Upd.
  3411            PERFORM 363-Set-Upd
  3412            RELEASE Sort-Rec
  3413            .
  3414       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3415        363-Set-Upd.
  3416            MOVE SPACES TO Sort-Rec
  3417            MOVE SPI-Current-Program-ID TO SR-Prog-ID
  3418            MOVE SPI-Current-Token-UC   TO SR-Token-UC
  3419            MOVE SPI-Current-Token      TO SR-Token
  3420            MOVE SPI-Current-Section    TO SR-Section
  3421            MOVE SPI-Current-Line-No    TO SR-Line-No-Ref
  3422            MOVE "*"                    TO SR-Ref-Flag
  3423            .
  3424       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3425        364-Set-Ref.
  3426            MOVE SPACES TO Sort-Rec
  3427            MOVE SPI-Current-Program-ID TO SR-Prog-ID
  3428            MOVE SPI-Current-Token-UC   TO SR-Token-UC

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  3429            MOVE SPI-Current-Token      TO SR-Token
  3430            MOVE SPI-Current-Section    TO SR-Section
  3431            MOVE SPI-Current-Line-No    TO SR-Line-No-Ref
  3432            .

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  3433       /
  3434        400-Produce-Xref-Listing SECTION.
  3435        401-Init.
  3436            MOVE SPACES       TO Detail-Line-X
  3437                                 Group-Indicators
  3438            MOVE 0            TO I
  3439                                 Lines-Left
  3440 GC0710     MOVE 'N'          TO F-Duplicate
  3441            .
  3442
  3443        402-Process-Sorted-Recs.
  3444            PERFORM FOREVER
  3445                RETURN Sort-File AT END
  3446                    EXIT PERFORM
  3447                END-RETURN
  3448                IF SR-Prog-ID  NOT = GI-Prog-ID
  3449                OR SR-Token-UC NOT = GI-Token
  3450 GC0710             MOVE 'N' TO F-Duplicate
  3451                    IF Detail-Line-X NOT = SPACES
  3452                        PERFORM 410-Generate-Report-Line
  3453                    END-IF
  3454                    IF SR-Prog-ID NOT = GI-Prog-ID
  3455                        MOVE 0 TO Lines-Left
  3456                    END-IF
  3457                    MOVE SR-Prog-ID  TO GI-Prog-ID
  3458                    MOVE SR-Token-UC TO GI-Token
  3459                END-IF
  3460 GC0710         IF SR-Token-UC = GI-Token
  3461 GC0710         AND SR-Line-No-Def NOT = SPACES
  3462 GC0710         AND Detail-Line-X NOT = SPACES
  3463 GC0710             MOVE 'Y' TO F-Duplicate
  3464 GC0710             PERFORM 410-Generate-Report-Line
  3465 GC0710             MOVE 0                          TO I
  3466 GC0710             MOVE SR-Prog-ID                 TO DLX-Prog-ID
  3467 GC0710             MOVE '  (Duplicate Definition)' TO DLX-Token
  3468 GC0710             MOVE SR-Section                 TO DLX-Section
  3469 GC0710             MOVE SR-Line-No-Def             TO DLX-Line-No-Def
  3470 GC0710             EXIT PERFORM CYCLE
  3471 GC0710         END-IF
  3472 GC0710         IF SR-Token-UC = GI-Token
  3473 GC0710         AND SR-Line-No-Def = SPACES
  3474 GC0710         AND F-Duplicate = 'Y'
  3475 GC0710             MOVE 'N' TO F-Duplicate
  3476 GC0710             PERFORM 410-Generate-Report-Line
  3477 GC0710             MOVE 0                          TO I
  3478 GC0710             MOVE SR-Prog-ID                 TO DLX-Prog-ID
  3479 GC0710             MOVE '  (Duplicate References)' TO DLX-Token
  3480 GC0710         END-IF
  3481                IF Detail-Line-X = SPACES
  3482                    MOVE SR-Prog-ID         TO DLX-Prog-ID
  3483                    MOVE SR-Token           TO DLX-Token
  3484                    MOVE SR-Section         TO DLX-Section
  3485                    IF SR-Line-No-Def NOT = SPACES
  3486                        MOVE SR-Line-No-Def TO DLX-Line-No-Def
  3487                    END-IF
  3488                END-IF

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  3489                IF SR-Reference > '000000'
  3490                    ADD 1 TO I
  3491                    IF I > Line-Nos-Per-Rec
  3492                        PERFORM 410-Generate-Report-Line
  3493                        MOVE 1 TO I
  3494                    END-IF
  3495                    MOVE SR-Line-No-Ref TO DLX-Line-No-Ref (I)
  3496                    MOVE SR-Ref-Flag    TO DLX-Ref-Flag    (I)
  3497                END-IF
  3498            END-PERFORM
  3499            IF Detail-Line-X NOT = SPACES
  3500                PERFORM 410-Generate-Report-Line
  3501            END-IF
  3502            EXIT SECTION
  3503            .
  3504       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3505        410-Generate-Report-Line.
  3506            IF Lines-Left < 1
  3507                IF F-First-Record = "Y"
  3508                    MOVE "N" TO F-First-Record
  3509                    WRITE Report-Rec FROM Heading-1X BEFORE 1
  3510                ELSE
  3511                    MOVE SPACES TO Report-Rec
  3512                    WRITE Report-Rec                 BEFORE PAGE
  3513                    MOVE SPACES TO Report-Rec
  3514                    WRITE Report-Rec                 BEFORE 1
  3515                    WRITE Report-Rec FROM Heading-1X BEFORE 1
  3516                END-IF
  3517                WRITE Report-Rec FROM Heading-2  BEFORE 1
  3518                WRITE Report-Rec FROM Heading-4X BEFORE 1
  3519                WRITE Report-Rec FROM Heading-5X BEFORE 1
  3520                COMPUTE
  3521                    Lines-Left = Lines-Per-Page - 4
  3522                END-COMPUTE
  3523            END-IF
  3524            WRITE Report-Rec FROM Detail-Line-X BEFORE 1
  3525            MOVE SPACES TO Detail-Line-X
  3526            MOVE 0 TO I
  3527            SUBTRACT 1 FROM Lines-Left
  3528            .

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  3529       /
  3530        500-Produce-Source-Listing SECTION.
  3531        501-Generate-Source-Listing.
  3532            OPEN INPUT Source-Code
  3533                       Expand-Code
  3534            MOVE 0 TO Source-Line-No
  3535            PERFORM FOREVER
  3536                READ Expand-Code AT END
  3537                    EXIT PERFORM
  3538                END-READ
  3539                IF ECR-1 = "#"
  3540                    PERFORM 510-Control-Record
  3541                ELSE
  3542                    PERFORM 520-Expand-Code-Record
  3543                END-IF
  3544            END-PERFORM
  3545            CLOSE Source-Code
  3546                  Expand-Code
  3547            EXIT SECTION
  3548            .
  3549       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3550        510-Control-Record.
  3551            UNSTRING ECR-2-256
  3552                DELIMITED BY '"'
  3553                INTO PIC-X10, PIC-X256, Dummy
  3554            END-UNSTRING
  3555 GC1010     IF UPPER-CASE(TRIM(PIC-X256,Trailing)) =
  3556 GC1010        TRIM(Main-Module-Name) *> Main Pgm
  3557                SET In-Main-Module TO TRUE
  3558                IF Source-Line-No > 0
  3559                    READ Expand-Code END-READ
  3560                END-IF
  3561            ELSE *> COPY
  3562                SET In-Copybook TO TRUE
  3563            END-IF
  3564            .
  3565       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3566        520-Expand-Code-Record.
  3567            IF In-Main-Module
  3568                ADD 1 To SPI-Current-Line-No
  3569                READ Source-Code AT END NEXT SENTENCE END-READ
  3570                ADD 1 TO Source-Line-No
  3571                MOVE SPACES         TO Detail-Line-S
  3572                MOVE Source-Line-No TO DLS-Line-No
  3573                MOVE SCR-1-128      TO DLS-Statement
  3574 GC0410         IF SCR-7 = "/"
  3575 GC0410             MOVE 0 TO Lines-Left
  3576 GC0410         END-IF
  3577                PERFORM 530-Generate-Source-Line
  3578                IF SCR-129-256 NOT = SPACES
  3579                    MOVE SPACES      TO Detail-Line-S
  3580                    MOVE SCR-129-256 TO DLS-Statement
  3581                    PERFORM 530-Generate-Source-Line
  3582                END-IF
  3583            ELSE
  3584                IF Expand-Code-Rec NOT = SPACES

OpenCOBOL 1.1 06FEB2009 Source Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                                   2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
Line   Statement
====== ================================================================================================================================
  3585                    MOVE SPACES         TO Detail-Line-S
  3586                    MOVE ECR-1-128      TO DLS-Statement
  3587                    PERFORM 530-Generate-Source-Line
  3588                    IF ECR-129-256 NOT = SPACES
  3589                        MOVE SPACES      TO Detail-Line-S
  3590                        MOVE ECR-129-256 TO DLS-Statement
  3591                        PERFORM 530-Generate-Source-Line
  3592                    END-IF
  3593                END-IF
  3594            END-IF
  3595            .
  3596       *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  3597        530-Generate-Source-Line.
  3598            IF Lines-Left < 1
  3599                IF F-First-Record = "Y"
  3600                    MOVE "N" TO F-First-Record
  3601                    WRITE Report-Rec FROM Heading-1S BEFORE 1
  3602                ELSE
  3603                    MOVE SPACES TO Report-Rec
  3604                    WRITE Report-Rec                 BEFORE PAGE
  3605                    MOVE SPACES TO Report-Rec
  3606                    WRITE Report-Rec                 BEFORE 1
  3607                    WRITE Report-Rec FROM Heading-1S BEFORE 1
  3608                END-IF
  3609                WRITE Report-Rec FROM Heading-2  BEFORE 1
  3610                WRITE Report-Rec FROM Heading-4S BEFORE 1
  3611                WRITE Report-Rec FROM Heading-5S BEFORE 1
  3612                COMPUTE
  3613                    Lines-Left = Lines-Per-Page - 4
  3614                END-COMPUTE
  3615            END-IF
  3616            WRITE Report-Rec FROM Detail-Line-S BEFORE 1
  3617            MOVE SPACES TO Detail-Line-S
  3618            SUBTRACT 1 FROM Lines-Left
  3619            .
  3620
  3621        END PROGRAM LISTING.

OpenCOBOL 1.1 06FEB2009 Cross-Reference Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                          2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
PROGRAM-ID      Identifier/Register/Function     Defn   Where Defined   References (* = Updated)
=============== ================================ ====== =============== ===============================================================
CHECKSOURCE     000-Main                                PROCEDURE         1744
CHECKSOURCE     010-Initialize                          PROCEDURE         1746
CHECKSOURCE     020-Compress-Multiple-SPACES       1753 PROCEDURE
CHECKSOURCE     030-Scan-Compressed-Src            1773 PROCEDURE
CHECKSOURCE     099-Never-Found-Either-One         1796 PROCEDURE
CHECKSOURCE     88-A2-IDENTIFICATION-DIVISION      1741 LINKAGE           1789*
CHECKSOURCE     88-A2-LINKAGE-SECTION              1740 LINKAGE           1783*
CHECKSOURCE     88-A2-Nothing-Special              1742 LINKAGE           1747*
CHECKSOURCE     88-Not-Skipping-SPACE              1730 WORKING-STORAGE   1754*   1760    1766*
CHECKSOURCE     88-Skipping-SPACE                  1729 WORKING-STORAGE   1763*
CHECKSOURCE     A1-Char                            1737 LINKAGE           1748    1759    1762    1768
CHECKSOURCE     Argument-1                         1736 LINKAGE           1743
CHECKSOURCE     Argument-2                         1739 LINKAGE           1743
CHECKSOURCE     Compressed-Src                     1724 WORKING-STORAGE   1756*   1778    1782    1787
CHECKSOURCE     CS-Char                            1725 WORKING-STORAGE   1762*   1768*   1777    1781    1786
CHECKSOURCE     F-Found-SPACE                      1728 WORKING-STORAGE
CHECKSOURCE     Flags                              1727 WORKING-STORAGE
CHECKSOURCE     I                                  1732 WORKING-STORAGE   1757*   1758    1759    1762    1768    1774*   1775    1777
                                                                          1778    1781    1781    1782    1786    1786    1787
CHECKSOURCE     J                                  1734 WORKING-STORAGE   1755*   1761*   1762    1767*   1768
CHECKSOURCE     UPPER-CASE                              PROCEDURE         1762

OpenCOBOL 1.1 06FEB2009 Cross-Reference Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                          2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
PROGRAM-ID      Identifier/Register/Function     Defn   Where Defined   References (* = Updated)
=============== ================================ ====== =============== ===============================================================
GETOSTYPE       000-Main                                PROCEDURE         1670
GETOSTYPE       010-Get-TEMP-Var                        PROCEDURE         1671
GETOSTYPE       Env-Path                           1667 WORKING-STORAGE   1672*   1673*   1679
GETOSTYPE       RETURN-CODE                             PROCEDURE         1676*   1680*   1690*   1692*   1695*
GETOSTYPE       Tally                              1668 WORKING-STORAGE   1682*   1684*   1685    1686*   1688*   1689

OpenCOBOL 1.1 06FEB2009 Cross-Reference Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                          2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
PROGRAM-ID      Identifier/Register/Function     Defn   Where Defined   References (* = Updated)
=============== ================================ ====== =============== ===============================================================
LISTING         000-Main                                PROCEDURE         2645
LISTING         001-Init                                PROCEDURE         2646
LISTING         100-Initialization                 2664 PROCEDURE         2647
LISTING         101-Establish-Working-Env          2668 PROCEDURE
LISTING         209-Exit                           2754 PROCEDURE
LISTING         300-Tokenize-Source                2758 PROCEDURE         2657
LISTING         301-Driver                         2759 PROCEDURE
LISTING         310-Get-Token                      2811 PROCEDURE         2768
LISTING         311-Control-Record                 2972 PROCEDURE         2828
LISTING         312-Expand-Code-Record             3012 PROCEDURE         2830
LISTING         313-Check-For-Numeric-Token        3019 PROCEDURE         2958
LISTING         320-IDENTIFICATION-DIVISION        3042 PROCEDURE         2789
LISTING         330-ENVIRONMENT-DIVISION           3058 PROCEDURE         2791
LISTING         340-DATA-DIVISION                  3072 PROCEDURE         2793
LISTING         350-PROCEDURE-DIVISION             3118 PROCEDURE         2795
LISTING         351-ACCEPT                         3182 PROCEDURE         3144
LISTING         351-ADD                            3192 PROCEDURE         3146
LISTING         351-ALLOCATE                       3203 PROCEDURE         3148
LISTING         351-CALL                           3215 PROCEDURE         3150
LISTING         351-COMPUTE                        3226 PROCEDURE         3152
LISTING         351-DIVIDE                         3235 PROCEDURE         3154
LISTING         351-FREE                           3255 PROCEDURE         3156
LISTING         351-INITIALIZE                     3259 PROCEDURE         3158
LISTING         351-INSPECT                        3268 PROCEDURE         3160
LISTING         351-MOVE                           3298 PROCEDURE         3162
LISTING         351-MULTIPLY                       3307 PROCEDURE         3164
LISTING         351-PERFORM                        3323 PROCEDURE         3166
LISTING         351-SET                            3336 PROCEDURE         3168
LISTING         351-STRING                         3345 PROCEDURE         3170
LISTING         351-SUBTRACT                       3356 PROCEDURE         3172
LISTING         351-TRANSFORM                      3367 PROCEDURE         3174
LISTING         351-UNSTRING                       3377 PROCEDURE         3176
LISTING         360-Release-Def                    3394 PROCEDURE         3094    3097    3100    3103    3134
LISTING         361-Release-Ref                    3405 PROCEDURE         3068    3112    3178    3188    3199    3211    3222    3231
                                                                          3251    3264    3294    3303    3319    3332    3341    3352
                                                                          3363    3373    3390
LISTING         362-Release-Upd                    3410 PROCEDURE         3106    3109    3185    3195    3197    3206    3209    3218
                                                                          3220    3229    3247    3249    3256    3262    3275    3301
                                                                          3317    3326    3329    3339    3348    3350    3359    3361
                                                                          3370    3380    3382    3384    3386    3388
LISTING         363-Set-Upd                        3415 PROCEDURE         3238    3310    3411
LISTING         364-Set-Ref                        3425 PROCEDURE         3271    3406
LISTING         400-Produce-Xref-Listing           3434 PROCEDURE         2658
LISTING         401-Init                           3435 PROCEDURE
LISTING         402-Process-Sorted-Recs            3443 PROCEDURE
LISTING         410-Generate-Report-Line           3505 PROCEDURE         3452    3464    3476    3492    3500
LISTING         500-Produce-Source-Listing         3530 PROCEDURE         2650
LISTING         501-Generate-Source-Listing        3531 PROCEDURE
LISTING         510-Control-Record                 3550 PROCEDURE         3540
LISTING         520-Expand-Code-Record             3566 PROCEDURE         3542
LISTING         530-Generate-Source-Line           3597 PROCEDURE         3577    3581    3587    3591
LISTING         Cmd                                1887 WORKING-STORAGE
LISTING         Current-Char-Is-Punct              2597 WORKING-STORAGE   2846    2854    2859
LISTING         Current-Char-Is-Quote              2600 WORKING-STORAGE   2865
LISTING         Current-Char-Is-X                  2601 WORKING-STORAGE   2879
LISTING         Current-Char-Is-Z                  2602 WORKING-STORAGE   2893

OpenCOBOL 1.1 06FEB2009 Cross-Reference Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                          2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
PROGRAM-ID      Identifier/Register/Function     Defn   Where Defined   References (* = Updated)
=============== ================================ ====== =============== ===============================================================
LISTING         Delim                              1889 WORKING-STORAGE   2911*   2914    2932*   2935    2938
LISTING         Detail-Line-S                      1891 WORKING-STORAGE   3571*   3579*   3585*   3589*   3616    3617*
LISTING         Detail-Line-X                      1896 WORKING-STORAGE   3436*   3451    3462    3481    3499    3524    3525*
LISTING         DLS-Line-No                        1892 WORKING-STORAGE   3572*
LISTING         DLS-Statement                      1894 WORKING-STORAGE   3573*   3580*   3586*   3590*
LISTING         DLX-Line-No-Def                    1901 WORKING-STORAGE   3469*   3486*
LISTING         DLX-Line-No-Ref                    1906 WORKING-STORAGE   3495*
LISTING         DLX-Prog-ID                        1897 WORKING-STORAGE   3466*   3478*   3482*
LISTING         DLX-Ref-Flag                       1907 WORKING-STORAGE   3496*
LISTING         DLX-Reference                      1905 WORKING-STORAGE
LISTING         DLX-Section                        1903 WORKING-STORAGE   3468*   3484*
LISTING         DLX-Token                          1899 WORKING-STORAGE   3467*   3479*   3483*
LISTING         Dummy                              1910 WORKING-STORAGE   2708*   2975*   2999*   3553*
LISTING         ECR-1                              1856 FILE              2827    3539
LISTING         ECR-1-128                          1859 FILE              3586
LISTING         ECR-129-256                        1860 FILE              3588    3590
LISTING         ECR-2-256                          1857 FILE              2973    3551
LISTING         Expand-Code                        1854 FILE              1845    2760    2807    2817    3533    3536    3546    3559
LISTING         Expand-Code-Rec                    1855 FILE              2761*   2815    2837    2838    2867    2872    2881    2886
                                                                          2895    2900    2908    2927    3008*   3584
LISTING         Expand-Code-Rec-Alt                1858 FILE
LISTING         Expanded-Src-Filename              1912 WORKING-STORAGE   1845    2714*   2717
LISTING         F-Duplicate                        1917 WORKING-STORAGE   3440*   3450*   3463*   3474    3475*
LISTING         F-First-Record                     1918 WORKING-STORAGE   2751*   3507    3508*   3599    3600*
LISTING         F-In-Which-Pgm                     1919 WORKING-STORAGE
LISTING         F-Last-Token-Ended-Sent            1922 WORKING-STORAGE   2813*   2960
LISTING         F-Processing-PICTURE               1923 WORKING-STORAGE   2907    2922*   3083*
LISTING         F-Token-Ended-Sentence             1924 WORKING-STORAGE   2800    2813    2814*   2843*   2873*   2887*   2901*   2915*
                                                                          2936*
LISTING         F-Verb-Has-Been-Found              1925 WORKING-STORAGE   2766*   2952*   3043*   3132
LISTING         Filename                           1914 WORKING-STORAGE   2708*   2711    2733    2999*   3002
LISTING         Flags                              1916 WORKING-STORAGE
LISTING         GI-Prog-ID                         1928 WORKING-STORAGE   3448    3454    3457*
LISTING         GI-Token                           1929 WORKING-STORAGE   3449    3458*   3460    3472
LISTING         Group-Indicators                   1927 WORKING-STORAGE   3437*
LISTING         H1S-Date                           1935 WORKING-STORAGE   2747*
LISTING         H1X-Date                           1941 WORKING-STORAGE   2746*
LISTING         Heading-1S                         1931 WORKING-STORAGE   3601    3607
LISTING         Heading-1X                         1937 WORKING-STORAGE   3509    3515
LISTING         Heading-2                          1943 WORKING-STORAGE   2696*   2698    3517    3609
LISTING         Heading-4S                         1945 WORKING-STORAGE   3610
LISTING         Heading-4X                         1948 WORKING-STORAGE   3518
LISTING         Heading-5S                         1952 WORKING-STORAGE   3611
LISTING         Heading-5X                         1957 WORKING-STORAGE   3519
LISTING         Held-Reference                     1962 WORKING-STORAGE   2750*   2781    2782    2783*   2818    2819    2820*   3239*
                                                                          3241    3242    3243*   3272*   3278    3279    3280*   3286
                                                                          3287    3288*   3311*   3313    3314*
LISTING         I                                  1964 WORKING-STORAGE   2675*   2677    2678    2680    2683*   2684    2700*   2702
                                                                          2703    2704    2707    2732    2978*   2981    2991*   2993
                                                                          2994    2995    2998    3438*   3465*   3477*   3490*   3491
                                                                          3493*   3495    3496    3526*
LISTING         In-Copybook                        1921 WORKING-STORAGE   2987*   3562*
LISTING         In-DATA-DIVISION                   2606 WORKING-STORAGE   2792
LISTING         In-ENVIRONMENT-DIVISION            2605 WORKING-STORAGE   2790
LISTING         In-IDENTIFICATION-DIVISION         2604 WORKING-STORAGE   2788
LISTING         In-Main-Module                     1920 WORKING-STORAGE   2982*   3014    3557*   3567

OpenCOBOL 1.1 06FEB2009 Cross-Reference Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                          2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
PROGRAM-ID      Identifier/Register/Function     Defn   Where Defined   References (* = Updated)
=============== ================================ ====== =============== ===============================================================
LISTING         In-PROCEDURE-DIVISION              2607 WORKING-STORAGE   2794
LISTING         J                                  1966 WORKING-STORAGE   2701*   2705*   2707    2992*   2996*   2998
LISTING         LENGTH                                  PROCEDURE         2675    2700    2991
LISTING         Line-Nos-Per-Rec                   1885 WORKING-STORAGE   1905    3491
LISTING         Lines-Left                         1968 WORKING-STORAGE   3439*   3455*   3506    3521*   3527    3575*   3598    3613*
                                                                          3618
LISTING         Lines-Per-Page                     1970 WORKING-STORAGE   2739*   2741*   3521    3613
LISTING         Lines-Per-Page-ENV                 1972 WORKING-STORAGE   2691*   2738    2739
LISTING         Main-Module-Name                   1974 WORKING-STORAGE   2681*   2684*   2980    3556
LISTING         Next-Char-Is-Quote                 2622 WORKING-STORAGE   2879    2893
LISTING         Num-UserNames                      1976 WORKING-STORAGE   2763*
LISTING         NUMVAL                                  PROCEDURE         2739    2978
LISTING         PIC-X10                            1978 WORKING-STORAGE   2975*   2978    3553*
LISTING         PIC-X256                           1982 WORKING-STORAGE   2718    2975*   2979    2991    2993    2998    3553*   3555
LISTING         PIC-X32                            1980 WORKING-STORAGE   3020*   3023    3027    3028*   3036
LISTING         Produce-Source-Listing             2638 LINKAGE           2642    2649
LISTING         Produce-Xref-Listing               2639 LINKAGE           2643    2652
LISTING         Program-Path                       1984 WORKING-STORAGE   2695*   2696    2732
LISTING         Report-File                        1862 FILE              1847    2648    2660
LISTING         Report-Filename                    1986 WORKING-STORAGE   1847    2736*
LISTING         Report-Rec                         1863 FILE              3509    3511*   3512    3513*   3514    3515    3517    3518
                                                                          3519    3524    3601    3603*   3604    3605*   3606    3607
                                                                          3609    3610    3611    3616
LISTING         Reserved-Word                      2581 WORKING-STORAGE   2948
LISTING         Reserved-Word-Table                2580 WORKING-STORAGE
LISTING         Reserved-Words                     1988 WORKING-STORAGE   2580
LISTING         RETURN-CODE                             PROCEDURE         2720
LISTING         RW-Idx                             2583 WORKING-STORAGE   2949    2950
LISTING         RW-Type                            2584 WORKING-STORAGE   2950
LISTING         RW-Word                            2585 WORKING-STORAGE   2582    2949
LISTING         Saved-Section                      2587 WORKING-STORAGE   2983    2984    2988    2989*
LISTING         SCR-1-128                          1878 FILE              3573
LISTING         SCR-129-256                        1882 FILE              3578    3580
LISTING         SCR-7                              1880 FILE              3574
LISTING         Search-Token                       2589 WORKING-STORAGE   2942*   2943    2949
LISTING         Sort-File                          1865 FILE              1849    2653    3445
LISTING         Sort-Rec                           1866 FILE              2782*   2784    2819*   2821    3239    3242*   3245    3279*
                                                                          3282    3287*   3290    3311    3313*   3316    3395*   3402
                                                                          3407    3412    3416*   3426*
LISTING         Source-Code                        1876 FILE              1850    3532    3545    3569
LISTING         Source-Code-Rec                    1877 FILE
LISTING         Source-Line-No                     2591 WORKING-STORAGE   3534*   3558    3570*   3572
LISTING         SPI-CP-13-15                       2611 WORKING-STORAGE   3051    3052*
LISTING         SPI-CS-1                           2613 WORKING-STORAGE   3001*
LISTING         SPI-CS-11-14                       2616 WORKING-STORAGE   3003    3004*
LISTING         SPI-CS-15                          2617 WORKING-STORAGE   3006*
LISTING         SPI-CS-2-14                        2614 WORKING-STORAGE   3002*
LISTING         SPI-Current-Char                   2596 WORKING-STORAGE   2837*   2839    2841    2847    2855    2861    2868
LISTING         SPI-Current-Division               2603 WORKING-STORAGE   2765*   2801    2848    2856    2961    3045*   3060*   3074*
                                                                          3124*   3128*
LISTING         SPI-Current-Line-No                2608 WORKING-STORAGE   2764*   2824*   2981*   3015*   3400    3421    3431    3568*
LISTING         SPI-Current-Program-ID             2609 WORKING-STORAGE   2748*   3050*   3396    3417    3427
LISTING         SPI-Current-Section                2612 WORKING-STORAGE   2984*   2989    3064*   3078*   3119    3120*   3399    3420
                                                                          3430
LISTING         SPI-Current-Token                  2618 WORKING-STORAGE   2772    2776*   2841*   2850*   2861*   2869*   2883*   2897*
                                                                          2910*   2918    2931*   2942    2944*   2962*   3020    3044

OpenCOBOL 1.1 06FEB2009 Cross-Reference Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                          2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
PROGRAM-ID      Identifier/Register/Function     Defn   Where Defined   References (* = Updated)
=============== ================================ ====== =============== ===============================================================
                                                                          3050    3059    3063    3073    3077    3081    3127    3398
                                                                          3419    3429
LISTING         SPI-Current-Token-UC               2619 WORKING-STORAGE   2773*   2776    2779    2798    3122    3397    3418    3428
LISTING         SPI-Current-Verb                   2620 WORKING-STORAGE   2749*   2779*   2803*   3131    3142
LISTING         SPI-Next-Char                      2621 WORKING-STORAGE   2838*   2882    2896
LISTING         SPI-Prior-Token                    2623 WORKING-STORAGE   2780*   2798*   2802*   2857*   3045    3048    3049*   3060
                                                                          3064    3074    3078    3087    3088*   3092    3095*   3098*
                                                                          3101*   3104*   3107*   3110*   3123    3128    3135*   3183
                                                                          3186*   3193    3204    3207*   3216    3227    3236    3260
                                                                          3269    3273*   3276*   3284*   3292*   3299    3308    3324
                                                                          3327*   3330*   3337    3346    3357    3368    3371*   3378
LISTING         SPI-Token-Type                     2624 WORKING-STORAGE   2842*   2851*   2862*   2919*   2923*   2945*   2950*   2963*
LISTING         SR-Line-No-Def                     1871 FILE              3400*   3461    3469    3473    3485    3486
LISTING         SR-Line-No-Ref                     1873 FILE              2656    3401*   3421*   3431*   3495
LISTING         SR-Prog-ID                         1867 FILE              2654    3396*   3417*   3427*   3448    3454    3457    3466
                                                                          3478    3482
LISTING         SR-Ref-Flag                        1874 FILE              3244*   3281*   3289*   3315*   3422*   3496
LISTING         SR-Reference                       1872 FILE              3489
LISTING         SR-Section                         1870 FILE              3399*   3420*   3430*   3468    3484
LISTING         SR-Token                           1869 FILE              3398*   3419*   3429*   3483
LISTING         SR-Token-UC                        1868 FILE              2655    3397*   3418*   3428*   3449    3458    3460    3472
LISTING         Src-Filename                       2640 LINKAGE           1850    2644    2669    2669*   2675    2677    2681    2684
                                                                          2695    2700    2702    2707
LISTING         Src-Ptr                            2593 WORKING-STORAGE   2762*   2815    2816    2833*   2837    2838    2840*   2849*
                                                                          2860*   2866*   2870*   2872    2874*   2880*   2884*   2886
                                                                          2888*   2894*   2898*   2900    2902*   2912*   2916*   2933*
                                                                          2939    3009*   3013*
LISTING         Syntax-Parsing-Items               2595 WORKING-STORAGE
LISTING         Tally                              2633 WORKING-STORAGE   3030*   3032*   3033
LISTING         Todays-Date                        2635 WORKING-STORAGE   2743*   2746
LISTING         Token-Is-EOF                       2625 WORKING-STORAGE   2769    2823*
LISTING         Token-Is-Identifier                2626 WORKING-STORAGE   2957*   3067    3091    3133    3139
LISTING         Token-Is-Key-Word                  2627 WORKING-STORAGE   2774    2797    3044    3059    3063    3073    3077    3082
                                                                          3127
LISTING         Token-Is-Literal-Alpha             2628 WORKING-STORAGE   2876*   2904*
LISTING         Token-Is-Literal-Number            2629 WORKING-STORAGE   2890*   2959    3024*   3037*
LISTING         Token-Is-Reserved-Word             2631 WORKING-STORAGE   2775    3086
LISTING         Token-Is-Verb                      2630 WORKING-STORAGE   2778    2951
LISTING         TRIM                                    PROCEDURE         2669    2700    2711    2733    2979    2980    2991    3555
                                                                          3556
LISTING         UPPER-CASE                              PROCEDURE         2681    2684    2772    2918    2942    2979    3555

OpenCOBOL 1.1 06FEB2009 Cross-Reference Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                          2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
PROGRAM-ID      Identifier/Register/Function     Defn   Where Defined   References (* = Updated)
=============== ================================ ====== =============== ===============================================================
OCic            000-File-Error                          PROCEDURE          554
OCic            000-Handle-Error                    556 PROCEDURE
OCic            000-Main                            578 PROCEDURE
OCic            009-Done                            596 PROCEDURE
OCic            010-Parse-Args                      601 PROCEDURE         1053
OCic            011-Init                            687 PROCEDURE
OCic            012-Extract-Kwd-And-Value           691 PROCEDURE
OCic            019-Done                            709 PROCEDURE
OCic            021-Build-And-Issue-Command         719 PROCEDURE
OCic            029-Done                            725 PROCEDURE
OCic            030-Process-Keyword                 728 PROCEDURE          704
OCic            031-Init                            733 PROCEDURE
OCic            032-Process                         738 PROCEDURE
OCic            039-Done                            848 PROCEDURE
OCic            040-Process-Yes-No-Value            851 PROCEDURE          783     791     799     807     886     907
OCic            042-Process                         856 PROCEDURE
OCic            049-Done                            874 PROCEDURE
OCic            050-Process-Yes-No-All              877 PROCEDURE          815     823     831
OCic            052-Process                         882 PROCEDURE
OCic            059-Done                            890 PROCEDURE
OCic            060-Process-Yes-No-Auto             893 PROCEDURE
OCic            061-Init                            898 PROCEDURE
OCic            070-Find-LINKAGE-SECTION            911 PROCEDURE          900    1057
OCic            071-Init                            916 PROCEDURE
OCic            072-Process-Source                  934 PROCEDURE
OCic            079-Done                            952 PROCEDURE
OCic            100-Initialization                  955 PROCEDURE          580
OCic            101-Determine-OS-Type               961 PROCEDURE
OCic            102-Set-Environment-Vars           1009 PROCEDURE
OCic            104-Generate-Banner-Line-Info      1014 PROCEDURE
OCic            105-Establish-Switch-Settings      1021 PROCEDURE
OCic            106-Determine-Folder-Path          1068 PROCEDURE
OCic            107-Other                          1108 PROCEDURE
OCic            109-Done                           1117 PROCEDURE
OCic            200-Let-User-Set-Switches          1120 PROCEDURE          583
OCic            201-Init                           1126 PROCEDURE
OCic            202-Show-And-Change-Switches       1130 PROCEDURE
OCic            209-Done                           1228 PROCEDURE
OCic            210-Run-Compiler                   1231 PROCEDURE          584
OCic            211-Init                           1236 PROCEDURE
OCic            212-Build-Compile-Command          1262 PROCEDURE
OCic            213-Run-Compiler                   1333 PROCEDURE
OCic            213-Run-OCXref                     1457 PROCEDURE
OCic            219-Done                           1434 PROCEDURE
OCic            220-Make-Listing                   1440 PROCEDURE          587
OCic            221-Init                           1445 PROCEDURE
OCic            230-Run-Program                    1519 PROCEDURE          591
OCic            232-Build-Command                  1524 PROCEDURE
OCic            233-Run-Program                    1606 PROCEDURE
OCic            239-Done                           1617 PROCEDURE
OCic            88-1st-Prog-Complete                149 WORKING-STORAGE    920     929*
OCic            88-Compile-As-Mainpgm               153 WORKING-STORAGE    918*
OCic            88-Compile-As-Subpgm                152 WORKING-STORAGE    901     948*   1058
OCic            88-Compile-Failed                   144 WORKING-STORAGE   1351*   1375*   1392*   1435
OCic            88-Compile-OK                       142 WORKING-STORAGE    585    1349*   1353    1364
OCic            88-Compile-OK-Warn                  143 WORKING-STORAGE    585    1359*   1380

OpenCOBOL 1.1 06FEB2009 Cross-Reference Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                          2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
PROGRAM-ID      Identifier/Register/Function     Defn   Where Defined   References (* = Updated)
=============== ================================ ====== =============== ===============================================================
OCic            88-Complete                         146 WORKING-STORAGE    582    1373*   1376*   1393*
OCic            88-More-To-1st-Prog                 150 WORKING-STORAGE    919*
OCic            88-No-Switch-Changes                155 WORKING-STORAGE   1131    1223*
OCic            88-Not-Complete                     147 WORKING-STORAGE    581*
OCic            88-Output-File-Avail                159 WORKING-STORAGE    590    1338*
OCic            88-Output-File-Busy                 158 WORKING-STORAGE
OCic            88-Source-Rec-Ident                 162 WORKING-STORAGE    928     937
OCic            88-Source-Rec-IgnoCOB-COLOR-RED     163 WORKING-STORAGE    935*
OCic            88-Source-Rec-Linkage               161 WORKING-STORAGE    936     947
OCic            88-Switch-Changes                   156 WORKING-STORAGE   1127*
OCic            88-Switch-Is-Bad                    165 WORKING-STORAGE    844*    870*
OCic            88-Switch-Is-Good                   166 WORKING-STORAGE    735*    784     792     800     808     816     824     832
OCic            900-Terminate                      1620 PROCEDURE          597    1051    1196    1436    1614
OCic            901-Display-Message                1625 PROCEDURE
OCic            909-Done                           1639 PROCEDURE
OCic            Bat-File                             96 FILE                85
OCic            Bat-File-Name                       108 WORKING-STORAGE     85
OCic            Bat-File-Rec                         97 FILE
OCic            Blank-Screen                        328 SCREEN            1378    1422    1608    1635
OCic            CK-S-F1                             119 WORKING-STORAGE    969*    979*    989*    999*   1197
OCic            CK-S-F2                             120 WORKING-STORAGE    970*    980*    990*   1000*   1200
OCic            CK-S-F3                             121 WORKING-STORAGE    971*    981*    991*   1001*   1203
OCic            CK-S-F4                             122 WORKING-STORAGE    972*    982*    992*   1002*   1206
OCic            CK-S-F5                             123 WORKING-STORAGE    973*    983*    993*   1003*   1209
OCic            CK-S-F6                             124 WORKING-STORAGE    974*    984*    994*   1004*   1212
OCic            CK-S-F7                             125 WORKING-STORAGE    975*    985*    995*   1005*   1215
OCic            Cmd                                 110 WORKING-STORAGE   1040*   1043    1237*   1339*   1343*   1346    1472*   1477*
                                                                          1480    1485*   1488*   1491    1494    1497    1500    1503
                                                                          1525*   1530*   1537*   1541*   1548*   1553*   1560*   1565*
                                                                          1571*   1577*   1583*   1589*   1595*   1600*   1612
OCic            COB-COLOR-BLACK                     106 [screenio     ]    330     335     428     440     452     460     474     488
                                                                           502     514     526     538
OCic            COB-COLOR-BLUE                      106 [screenio     ]    336     418
OCic            COB-COLOR-CYAN                      106 [screenio     ]    429     441     489     527
OCic            COB-COLOR-GREEN                     106 [screenio     ]
OCic            COB-COLOR-MAGENTA                   106 [screenio     ]
OCic            COB-COLOR-RED                       106 [screenio     ]    475     515
OCic            COB-COLOR-WHITE                     106 [screenio     ]    331     419     453     461     503     539
OCic            COB-COLOR-YELLOW                    106 [screenio     ]
OCic            COB-CRT-STATUS                          PROCEDURE         1135    1136
OCic            COB-SCR-ESC                         106 [screenio     ]   1195
OCic            COB-SCR-F1                          106 [screenio     ]   1137
OCic            COB-SCR-F10                         106 [screenio     ]
OCic            COB-SCR-F11                         106 [screenio     ]    969     989     999
OCic            COB-SCR-F12                         106 [screenio     ]    970     990    1000
OCic            COB-SCR-F13                         106 [screenio     ]    971     979     991    1001
OCic            COB-SCR-F14                         106 [screenio     ]    972     980     992    1002
OCic            COB-SCR-F15                         106 [screenio     ]    973     981     993    1003
OCic            COB-SCR-F16                         106 [screenio     ]    974     982     994    1004
OCic            COB-SCR-F17                         106 [screenio     ]    975     983     995    1005
OCic            COB-SCR-F18                         106 [screenio     ]    984
OCic            COB-SCR-F19                         106 [screenio     ]    985
OCic            COB-SCR-F2                          106 [screenio     ]   1143
OCic            COB-SCR-F20                         106 [screenio     ]
OCic            COB-SCR-F21                         106 [screenio     ]
OCic            COB-SCR-F22                         106 [screenio     ]

OpenCOBOL 1.1 06FEB2009 Cross-Reference Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                          2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
PROGRAM-ID      Identifier/Register/Function     Defn   Where Defined   References (* = Updated)
=============== ================================ ====== =============== ===============================================================
OCic            COB-SCR-F23                         106 [screenio     ]
OCic            COB-SCR-F24                         106 [screenio     ]
OCic            COB-SCR-F25                         106 [screenio     ]
OCic            COB-SCR-F26                         106 [screenio     ]
OCic            COB-SCR-F27                         106 [screenio     ]
OCic            COB-SCR-F28                         106 [screenio     ]
OCic            COB-SCR-F29                         106 [screenio     ]
OCic            COB-SCR-F3                          106 [screenio     ]   1149
OCic            COB-SCR-F30                         106 [screenio     ]
OCic            COB-SCR-F31                         106 [screenio     ]
OCic            COB-SCR-F32                         106 [screenio     ]
OCic            COB-SCR-F33                         106 [screenio     ]
OCic            COB-SCR-F34                         106 [screenio     ]
OCic            COB-SCR-F35                         106 [screenio     ]
OCic            COB-SCR-F36                         106 [screenio     ]
OCic            COB-SCR-F37                         106 [screenio     ]
OCic            COB-SCR-F38                         106 [screenio     ]
OCic            COB-SCR-F39                         106 [screenio     ]
OCic            COB-SCR-F4                          106 [screenio     ]   1156
OCic            COB-SCR-F40                         106 [screenio     ]
OCic            COB-SCR-F41                         106 [screenio     ]
OCic            COB-SCR-F42                         106 [screenio     ]
OCic            COB-SCR-F43                         106 [screenio     ]
OCic            COB-SCR-F44                         106 [screenio     ]
OCic            COB-SCR-F45                         106 [screenio     ]
OCic            COB-SCR-F46                         106 [screenio     ]
OCic            COB-SCR-F47                         106 [screenio     ]
OCic            COB-SCR-F48                         106 [screenio     ]
OCic            COB-SCR-F49                         106 [screenio     ]
OCic            COB-SCR-F5                          106 [screenio     ]   1163
OCic            COB-SCR-F50                         106 [screenio     ]
OCic            COB-SCR-F51                         106 [screenio     ]
OCic            COB-SCR-F52                         106 [screenio     ]
OCic            COB-SCR-F53                         106 [screenio     ]
OCic            COB-SCR-F54                         106 [screenio     ]
OCic            COB-SCR-F55                         106 [screenio     ]
OCic            COB-SCR-F56                         106 [screenio     ]
OCic            COB-SCR-F57                         106 [screenio     ]
OCic            COB-SCR-F58                         106 [screenio     ]
OCic            COB-SCR-F59                         106 [screenio     ]
OCic            COB-SCR-F6                          106 [screenio     ]   1169
OCic            COB-SCR-F60                         106 [screenio     ]
OCic            COB-SCR-F61                         106 [screenio     ]
OCic            COB-SCR-F62                         106 [screenio     ]
OCic            COB-SCR-F63                         106 [screenio     ]
OCic            COB-SCR-F64                         106 [screenio     ]
OCic            COB-SCR-F7                          106 [screenio     ]   1176
OCic            COB-SCR-F8                          106 [screenio     ]   1183
OCic            COB-SCR-F9                          106 [screenio     ]   1189
OCic            COB-SCR-FATAL                       106 [screenio     ]
OCic            COB-SCR-KEY-DOWN                    106 [screenio     ]
OCic            COB-SCR-KEY-UP                      106 [screenio     ]
OCic            COB-SCR-NO-FIELD                    106 [screenio     ]
OCic            COB-SCR-OK                          106 [screenio     ]
OCic            COB-SCR-PAGE_DOWN                   106 [screenio     ]
OCic            COB-SCR-PAGE_UP                     106 [screenio     ]

OpenCOBOL 1.1 06FEB2009 Cross-Reference Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                          2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
PROGRAM-ID      Identifier/Register/Function     Defn   Where Defined   References (* = Updated)
=============== ================================ ====== =============== ===============================================================
OCic            COB-SCR-PRINT                       106 [screenio     ]
OCic            Cobc-Cmd                            112 WORKING-STORAGE   1238*   1263*   1267*   1272*   1277*   1283*   1289*   1295*
                                                                          1301*   1309*   1318*   1323*   1340
OCic            Cobc-Output                          99 FILE                88    1354    1355    1361    1398    1400    1408
OCic            Cobc-Output-Rec                     100 FILE              1403
OCic            Command-Line-Args                   114 WORKING-STORAGE    692     694     742     746    1022*   1025    1026*   1030
                                                                          1031*   1033    1038    1042*   1044*
OCic            CONCATENATE                             PROCEDURE         1110    1452    1484    1487    1491    1494    1497    1500
                                                                          1503
OCic            Config-File                         116 WORKING-STORAGE   1246*   1248*   1250*   1252*   1254*   1256*   1258*   1265
OCic            Config-Keys                         118 WORKING-STORAGE
OCic            Dir-Char                            127 WORKING-STORAGE    967*    977*    987*    997*   1071*   1073    1085    1104*
                                                                          1564
OCic            Dummy                               129 WORKING-STORAGE    743*   1034*   1040*   1418*
OCic            F-Compilation-Succeeded             141 WORKING-STORAGE
OCic            F-Complete                          145 WORKING-STORAGE
OCic            F-IDENT-DIVISION                    148 WORKING-STORAGE
OCic            F-LINKAGE-SECTION                   151 WORKING-STORAGE
OCic            F-No-Switch-Changes                 154 WORKING-STORAGE
OCic            F-Output-File-Busy                  157 WORKING-STORAGE
OCic            F-Source-Record-Type                160 WORKING-STORAGE    926     943
OCic            F-Switch-Error                      164 WORKING-STORAGE
OCic            File-Name                           131 WORKING-STORAGE     91     564     570    1030*   1034*   1047    1070    1078
                                                                          1081    1103    1462
OCic            File-Status-Message                 134 WORKING-STORAGE
OCic            Flags                               140 WORKING-STORAGE
OCic            FN-Char                             132 WORKING-STORAGE   1073    1080*   1085*
OCic            FSM-Msg                             138 WORKING-STORAGE    559*    559*    559*    559*    559*    559*    559*    559*
                                                                           559*    559*    559*    559*    559*    559*    559*    559*
                                                                           559*    559*    559*    559*    559*    559*    559*    559*
                                                                           559*    559*    559*    559*    559*    559*
OCic            FSM-Status                          136 WORKING-STORAGE     93     559     561
OCic            Horizontal-Line                     168 WORKING-STORAGE    338     351     355     357     389     391     395     402
                                                                           406     413    1109*
OCic            I                                   170 WORKING-STORAGE    688*    692     693     697*    741*    744*    746*   1069*
                                                                          1073    1073    1074    1076    1080    1085    1243*   1268*
                                                                          1273*   1278*   1284*   1290*   1296*   1302*   1310*   1319*
                                                                          1324*   1526*   1531*   1538*   1542*   1549*   1554*   1561*
                                                                          1566*   1572*   1578*   1584*   1590*   1596*   1601*
OCic            J                                   172 WORKING-STORAGE    693*    741    1544*   1545    1546    1552
OCic            LD-Horiz-Line                       314 SCREEN            1109
OCic            LD-LL-Corner                        309 SCREEN             350     388     401     412
OCic            LD-Lower-T                          313 SCREEN             390
OCic            LD-LR-Corner                        311 SCREEN             352     392     403     414
OCic            LD-UL-Corner                        308 SCREEN             337     354     394     405
OCic            LD-Upper-T                          312 SCREEN             356
OCic            LD-UR-Corner                        310 SCREEN             339     358     396     407
OCic            LD-Vert-Line                        315 SCREEN             341     342     344     345     347     348     360     361
                                                                           362     364     365     366     368     369     370     372
                                                                           373     374     376     377     378     380     381     382
                                                                           384     385     386     398     399     409     410
OCic            LENGTH                                  PROCEDURE          692     746    1545
OCic            LOWER-CASE                              PROCEDURE         1540
OCic            ML                                  176 WORKING-STORAGE
OCic            MS                                  174 WORKING-STORAGE
OCic            OC-Compiled                         178 WORKING-STORAGE    421    1015*

OpenCOBOL 1.1 06FEB2009 Cross-Reference Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                          2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
PROGRAM-ID      Identifier/Register/Function     Defn   Where Defined   References (* = Updated)
=============== ================================ ====== =============== ===============================================================
OCic            OS-Cygwin                           183 WORKING-STORAGE    986    1070    1103    1471    1535    1569
OCic            OS-Type                             180 WORKING-STORAGE    964*
OCic            OS-Type-Literal                     186 WORKING-STORAGE    968*    978*    988*    998*   1111
OCic            OS-UNIX                             184 WORKING-STORAGE    996    1569
OCic            OS-Unknown                          181 WORKING-STORAGE    966    1593
OCic            OS-Windows                          182 WORKING-STORAGE    976    1471    1483    1593
OCic            Output-Message                      188 WORKING-STORAGE    424     560*    721     777*    836*    842*    863*    868*
                                                                          1114*   1220*   1239*   1334*   1363*   1365*   1372*   1447*
                                                                          1458*   1465*   1470*   1506    1508*   1626
OCic            Path-Delimiter                      190 WORKING-STORAGE
OCic            Prog-Extension                      194 WORKING-STORAGE   1088*
OCic            Prog-File-Name                      196 WORKING-STORAGE    456    1078*   1083*   1087    1322
OCic            Prog-Folder                         192 WORKING-STORAGE    455    1077*   1082*   1094    1095*   1100    1534    1535
                                                                          1540    1545    1546    1552    1559
OCic            Prog-Name                           198 WORKING-STORAGE    454    1088*   1452    1475    1484    1487    1576
OCic            RETURN-CODE                             PROCEDURE          964    1348    1454*   1466*   1468
OCic            S-ARGS                              230 WORKING-STORAGE    541*   1587    1588
OCic            S-Cfg-BS2000                        232 WORKING-STORAGE    516     754*   1199*   1245
OCic            S-Cfg-COBOL2002                     234 WORKING-STORAGE    518     760*   1205*   1249
OCic            S-Cfg-COBOL85                       233 WORKING-STORAGE    517     757*   1202*   1247
OCic            S-Cfg-DEFAULT                       235 WORKING-STORAGE    519     763*   1208*
OCic            S-Cfg-IBM                           236 WORKING-STORAGE    520     766*   1211*   1251
OCic            S-Cfg-MF                            237 WORKING-STORAGE    521     769*   1214*   1253
OCic            S-Cfg-MVS                           238 WORKING-STORAGE    522     772*   1217*   1255
OCic            S-CfgS                              231 WORKING-STORAGE    753*    756*    759*    762*    765*    768*    771*   1198*
                                                                          1201*   1204*   1207*   1210*   1213*   1216*
OCic            S-DEBUG                             241 WORKING-STORAGE    476     785*   1138    1139*   1141*   1281
OCic            S-DLL                               242 WORKING-STORAGE    477     793*   1144    1145*   1147*   1528    1581
OCic            S-EXECUTE                           245 WORKING-STORAGE    479     589     801*   1152*   1157    1159*   1161*
OCic            S-EXTRA                             239 WORKING-STORAGE    540*    743*   1314    1316
OCic            S-NOTRUNC                           246 WORKING-STORAGE    480     809*   1164    1165*   1167*   1287
OCic            S-SOURCE                            244 WORKING-STORAGE    483     586     817*   1184    1185*   1187*   1306    1460
OCic            S-SUBROUTINE                        247 WORKING-STORAGE    478    1054    1059*   1061*   1150    1151*   1154*   1158
                                                                          1270    1527    1580
OCic            S-TRACE                             248 WORKING-STORAGE    481     825*   1170    1171*   1174*   1179*   1299
OCic            S-TRACEALL                          249 WORKING-STORAGE    482    1172*   1177    1178*   1181*   1293
OCic            S-XREF                              243 WORKING-STORAGE    484     586     833*   1190    1191*   1193*   1307    1461
OCic            S-Yes-No-Switches                   240 WORKING-STORAGE
OCic            SD-Description                      205 WORKING-STORAGE
OCic            SD-Switch-And-Value                 203 WORKING-STORAGE
OCic            Selection-Char                      200 WORKING-STORAGE    235     754     757     760     763     766     769     772
                                                                          1139    1145    1151    1159    1165    1171    1178    1185
                                                                          1191    1199    1202    1205    1208    1211    1214    1217
OCic            Source-Code                         102 FILE                91     555     917     921     922     938     939     946
OCic            Source-Code-Record                  103 FILE               925     942
OCic            SV-1                                221 WORKING-STORAGE    785     793     801     809     817     825     833     857
                                                                           883     899
OCic            Switch-Display                      202 WORKING-STORAGE
OCic            Switch-Is-CONFIG                    208 WORKING-STORAGE    747
OCic            Switch-Is-DEBUG                     209 WORKING-STORAGE    779
OCic            Switch-Is-DLL                       210 WORKING-STORAGE    787
OCic            Switch-Is-EXECUTE                   211 WORKING-STORAGE    795
OCic            Switch-Is-EXTRA                     212 WORKING-STORAGE    740
OCic            Switch-Is-NOTRUNC                   213 WORKING-STORAGE    803
OCic            Switch-Is-SOURCE                    215 WORKING-STORAGE    811
OCic            Switch-Is-TRACE                     214 WORKING-STORAGE    819

OpenCOBOL 1.1 06FEB2009 Cross-Reference Listing - OCic Copyright (C) 2009-2010, Gary L. Cutler, GPL                          2010/11/10
                                                                                                          E:/OpenCOBOL/samples/OCic.cbl
PROGRAM-ID      Identifier/Register/Function     Defn   Where Defined   References (* = Updated)
=============== ================================ ====== =============== ===============================================================
OCic            Switch-Is-XREF                      216 WORKING-STORAGE    827
OCic            Switch-Keyword                      207 WORKING-STORAGE    702*    734     734*    748*    780*    788*    796*    804*
                                                                           812*    820*    828*    838     866    1055*
OCic            Switch-Keyword-And-Value            218 WORKING-STORAGE    696*    699     700
OCic            Switch-Value                        220 WORKING-STORAGE    223     702*    749     750*    751     781     782*    789
                                                                           790*    797     798*    805     806*    813     814*    821
                                                                           822*    829     830*    859*    861*    864     884*    902*
                                                                           904*   1056*
OCic            Switch-Value-Alt                    223 WORKING-STORAGE
OCic            Switches                            229 WORKING-STORAGE
OCic            Switches-Screen                     330 SCREEN            1133*   1241    1336    1367    1449    1512    1628
OCic            Tally                               251 WORKING-STORAGE   1027*   1028*   1029
OCic            TRIM                                    PROCEDURE          564     570     838     864     866    1025    1100    1111
                                                                          1265    1316    1322    1340    1346    1403    1452    1475
                                                                          1480    1484    1487    1491    1494    1497    1500    1503
                                                                          1545    1559    1576    1588    1612
OCic            UPPER-CASE                              PROCEDURE          734     749     781     789     797     805     813     821
                                                                           829
OCic            Valid-Config-Filename               225 WORKING-STORAGE
OCic            WHEN-COMPILED                           PROCEDURE         1015
